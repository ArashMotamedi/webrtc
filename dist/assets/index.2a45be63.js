const ff=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}};ff();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gi=function(e,t){return Gi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i])},Gi(e,t)};function N(e,t){Gi(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var xn=function(){return xn=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},xn.apply(this,arguments)};function m(e,t,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function u(h){try{c(r.next(h))}catch(f){s(f)}}function a(h){try{c(r.throw(h))}catch(f){s(f)}}function c(h){h.done?o(h.value):i(h.value).then(u,a)}c((r=r.apply(e,t||[])).next())})}function g(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(c){return function(h){return a([c,h])}}function a(c){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,i=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){n.label=c[1];break}if(c[0]===6&&n.label<o[1]){n.label=o[1],o=c;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(c);break}o[2]&&n.ops.pop(),n.trys.pop();continue}c=t.call(e,n)}catch(h){c=[6,h],i=0}finally{r=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function lf(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ca(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,o=[],s;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(u){s={error:u}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function pf(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ca(arguments[t]));return e}function at(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(e){return Pn(void 0,e)}function Pn(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)!t.hasOwnProperty(r)||!vf(r)||(e[r]=Pn(e[r],t[r]));return e}function vf(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yf=function(){function e(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(n,r){t.resolve=n,t.reject=r})}return e.prototype.wrapCallback=function(t){var n=this;return function(r,i){r?n.reject(r):n.resolve(i),typeof t=="function"&&(n.promise.catch(function(){}),t.length===1?t(r):t(r,i))}},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function gf(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Se())}function mf(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wf(){return typeof self=="object"&&self.self===self}function bf(){var e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function Ef(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function _f(){return Se().indexOf("Electron/")>=0}function If(){var e=Se();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Tf(){return Se().indexOf("MSAppHost/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nf="FirebaseError",Af=function(e){N(t,e);function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name=Nf,Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,wo.prototype.create),o}return t}(Error),wo=function(){function e(t,n,r){this.service=t,this.serviceName=n,this.errors=r}return e.prototype.create=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=n[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?Sf(s,i):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new Af(o,a,i);return c},e}();function Sf(e,t){return e.replace(Df,function(n,r){var i=t[r];return i!=null?String(i):"<"+r+"?>"})}var Df=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Of(e,t){var n=new xf(e,t);return n.subscribe.bind(n)}var xf=function(){function e(t,n){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(i){r.error(i)})}return e.prototype.next=function(t){this.forEachObserver(function(n){n.next(t)})},e.prototype.error=function(t){this.forEachObserver(function(n){n.error(t)}),this.close(t)},e.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},e.prototype.subscribe=function(t,n,r){var i=this,o;if(t===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Pf(t,["next","error","complete"])?o=t:o={next:t,error:n,complete:r},o.next===void 0&&(o.next=Oi),o.error===void 0&&(o.error=Oi),o.complete===void 0&&(o.complete=Oi);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?o.error(i.finalError):o.complete()}catch{}}),this.observers.push(o),s},e.prototype.unsubscribeOne=function(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},e.prototype.forEachObserver=function(t){if(!this.finalized)for(var n=0;n<this.observers.length;n++)this.sendOne(n,t)},e.prototype.sendOne=function(t,n){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[t]!==void 0)try{n(r.observers[t])}catch(i){typeof console!="undefined"&&console.error&&console.error(i)}})},e.prototype.close=function(t){var n=this;this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(function(){n.observers=void 0,n.onNoObservers=void 0}))},e}();function Pf(e,t){if(typeof e!="object"||e===null)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&typeof e[i]=="function")return!0}return!1}function Oi(){}var ei=function(){function e(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return e.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},e.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},e.prototype.setServiceProps=function(t){return this.serviceProps=t,this},e}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kf=function(){function e(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(t){t===void 0&&(t=we);var n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){var r=new yf;this.instancesDeferred.set(n,r);try{var i=this.getOrInitializeService(n);i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise},e.prototype.getImmediate=function(t){var n=xn({identifier:we,optional:!1},t),r=n.identifier,i=n.optional,o=this.normalizeInstanceIdentifier(r);try{var s=this.getOrInitializeService(o);if(!s){if(i)return null;throw Error("Service "+this.name+" is not available")}return s}catch(u){if(i)return null;throw u}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(t){var n,r;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,Rf(t))try{this.getOrInitializeService(we)}catch{}try{for(var i=lf(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=ca(o.value,2),u=s[0],a=s[1],c=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService(c);a.resolve(h)}catch{}}}catch(f){n={error:f}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.clearInstance=function(t){t===void 0&&(t=we),this.instancesDeferred.delete(t),this.instances.delete(t)},e.prototype.delete=function(){return m(this,void 0,void 0,function(){var t;return g(this,function(n){switch(n.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(pf(t.filter(function(r){return"INTERNAL"in r}).map(function(r){return r.INTERNAL.delete()}),t.filter(function(r){return"_delete"in r}).map(function(r){return r._delete()})))];case 1:return n.sent(),[2]}})})},e.prototype.isComponentSet=function(){return this.component!=null},e.prototype.isInitialized=function(t){return t===void 0&&(t=we),this.instances.has(t)},e.prototype.getOrInitializeService=function(t){var n=this.instances.get(t);return!n&&this.component&&(n=this.component.instanceFactory(this.container,Cf(t)),this.instances.set(t,n)),n||null},e.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:we:t},e}();function Cf(e){return e===we?void 0:e}function Rf(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lf=function(){function e(t){this.name=t,this.providers=new Map}return e.prototype.addComponent=function(t){var n=this.getProvider(t.name);if(n.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);n.setComponent(t)},e.prototype.addOrOverwriteComponent=function(t){var n=this.getProvider(t.name);n.isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},e.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var n=new kf(t,this);return this.providers.set(t,n),n},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Rt(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var me,bo=[],j;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(j||(j={}));var ha={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},Vf=j.INFO,Mf=(me={},me[j.DEBUG]="log",me[j.VERBOSE]="log",me[j.INFO]="info",me[j.WARN]="warn",me[j.ERROR]="error",me),Ff=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=new Date().toISOString(),o=Mf[t];if(o)console[o].apply(console,Rt(["["+i+"]  "+e.name+":"],n));else throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}},fa=function(){function e(t){this.name=t,this._logLevel=Vf,this._logHandler=Ff,this._userLogHandler=null,bo.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in j))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(t){this._logLevel=typeof t=="string"?ha[t]:t},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Rt([this,j.DEBUG],t)),this._logHandler.apply(this,Rt([this,j.DEBUG],t))},e.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Rt([this,j.VERBOSE],t)),this._logHandler.apply(this,Rt([this,j.VERBOSE],t))},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Rt([this,j.INFO],t)),this._logHandler.apply(this,Rt([this,j.INFO],t))},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Rt([this,j.WARN],t)),this._logHandler.apply(this,Rt([this,j.WARN],t))},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Rt([this,j.ERROR],t)),this._logHandler.apply(this,Rt([this,j.ERROR],t))},e}();function Uf(e){bo.forEach(function(t){t.setLogLevel(e)})}function jf(e,t){for(var n=function(s){var u=null;t&&t.level&&(u=ha[t.level]),e===null?s.userLogHandler=null:s.userLogHandler=function(a,c){for(var h=[],f=2;f<arguments.length;f++)h[f-2]=arguments[f];var l=h.map(function(p){if(p==null)return null;if(typeof p=="string")return p;if(typeof p=="number"||typeof p=="boolean")return p.toString();if(p instanceof Error)return p.message;try{return JSON.stringify(p)}catch{return null}}).filter(function(p){return p}).join(" ");c>=(u!=null?u:a.logLevel)&&e({level:j[c].toLowerCase(),message:l,args:h,type:a.name})}},r=0,i=bo;r<i.length;r++){var o=i[r];n(o)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt,qf=(Xt={},Xt["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Xt["bad-app-name"]="Illegal App name: '{$appName}",Xt["duplicate-app"]="Firebase App named '{$appName}' already exists",Xt["app-deleted"]="Firebase App named '{$appName}' already deleted",Xt["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Xt["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Xt),ze=new wo("app","Firebase",qf),la="@firebase/app",zf="0.6.15",Bf="@firebase/analytics",Gf="@firebase/auth",Hf="@firebase/database",$f="@firebase/functions",Yf="@firebase/installations",Kf="@firebase/messaging",Qf="@firebase/performance",Xf="@firebase/remote-config",Wf="@firebase/storage",Jf="@firebase/firestore",Zf="firebase-wrapper";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pt,Dr="[DEFAULT]",tl=(pt={},pt[la]="fire-core",pt[Bf]="fire-analytics",pt[Gf]="fire-auth",pt[Hf]="fire-rtdb",pt[$f]="fire-fn",pt[Yf]="fire-iid",pt[Kf]="fire-fcm",pt[Qf]="fire-perf",pt[Xf]="fire-rc",pt[Wf]="fire-gcs",pt[Jf]="fire-fst",pt["fire-js"]="fire-js",pt[Zf]="fire-js-all",pt);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe=new fa("@firebase/app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _r=function(){function e(t,n,r){var i=this;this.firebase_=r,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=df(t),this.container=new Lf(n.name),this._addComponent(new ei("app",function(){return i},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(o){return i._addComponent(o)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var t=this;return new Promise(function(n){t.checkDestroyed_(),n()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(n){return n.delete()}))}).then(function(){t.isDeleted_=!0})},e.prototype._getService=function(t,n){return n===void 0&&(n=Dr),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:n})},e.prototype._removeServiceInstance=function(t,n){n===void 0&&(n=Dr),this.container.getProvider(t).clearInstance(n)},e.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(n){Qe.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,n)}},e.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw ze.create("app-deleted",{appName:this.name_})},e}();_r.prototype.name&&_r.prototype.options||_r.prototype.delete||console.log("dc");var el="8.2.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nl(e){var t={},n=new Map,r={__esModule:!0,initializeApp:s,app:o,registerVersion:c,setLogLevel:Uf,onLog:h,apps:null,SDK_VERSION:el,INTERNAL:{registerComponent:a,removeApp:i,components:n,useAsService:f}};r.default=r,Object.defineProperty(r,"apps",{get:u});function i(l){delete t[l]}function o(l){if(l=l||Dr,!Us(t,l))throw ze.create("no-app",{appName:l});return t[l]}o.App=e;function s(l,p){if(p===void 0&&(p={}),typeof p!="object"||p===null){var d=p;p={name:d}}var v=p;v.name===void 0&&(v.name=Dr);var w=v.name;if(typeof w!="string"||!w)throw ze.create("bad-app-name",{appName:String(w)});if(Us(t,w))throw ze.create("duplicate-app",{appName:w});var _=new e(l,v,r);return t[w]=_,_}function u(){return Object.keys(t).map(function(l){return t[l]})}function a(l){var p=l.name;if(n.has(p))return Qe.debug("There were multiple attempts to register component "+p+"."),l.type==="PUBLIC"?r[p]:null;if(n.set(p,l),l.type==="PUBLIC"){var d=function(S){if(S===void 0&&(S=o()),typeof S[p]!="function")throw ze.create("invalid-app-argument",{appName:p});return S[p]()};l.serviceProps!==void 0&&Pn(d,l.serviceProps),r[p]=d,e.prototype[p]=function(){for(var S=[],A=0;A<arguments.length;A++)S[A]=arguments[A];var C=this._getService.bind(this,p);return C.apply(this,l.multipleInstances?S:[])}}for(var v=0,w=Object.keys(t);v<w.length;v++){var _=w[v];t[_]._addComponent(l)}return l.type==="PUBLIC"?r[p]:null}function c(l,p,d){var v,w=(v=tl[l])!==null&&v!==void 0?v:l;d&&(w+="-"+d);var _=w.match(/\s|\//),S=p.match(/\s|\//);if(_||S){var A=['Unable to register library "'+w+'" with version "'+p+'":'];_&&A.push('library name "'+w+'" contains illegal characters (whitespace or "/")'),_&&S&&A.push("and"),S&&A.push('version name "'+p+'" contains illegal characters (whitespace or "/")'),Qe.warn(A.join(" "));return}a(new ei(w+"-version",function(){return{library:w,version:p}},"VERSION"))}function h(l,p){if(l!==null&&typeof l!="function")throw ze.create("invalid-log-argument");jf(l,p)}function f(l,p){if(p==="serverAuth")return null;var d=p;return d}return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pa(){var e=nl(_r);e.INTERNAL=xn(xn({},e.INTERNAL),{createFirebaseNamespace:pa,extendNamespace:t,createSubscribe:Of,ErrorFactory:wo,deepExtend:Pn});function t(n){Pn(e,n)}return e}var Eo=pa();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rl=function(){function e(t){this.container=t}return e.prototype.getPlatformInfoString=function(){var t=this.container.getProviders();return t.map(function(n){if(il(n)){var r=n.getImmediate();return r.library+"/"+r.version}else return null}).filter(function(n){return n}).join(" ")},e}();function il(e){var t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ol(e,t){e.INTERNAL.registerComponent(new ei("platform-logger",function(n){return new rl(n)},"PRIVATE")),e.registerVersion(la,zf,t),e.registerVersion("fire-js","")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(wf()&&self.firebase!==void 0){Qe.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);var js=self.firebase.SDK_VERSION;js&&js.indexOf("LITE")>=0&&Qe.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var sl=Eo.initializeApp;Eo.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return mf()&&Qe.warn(`
      Warning: This is a browser-targeted Firebase bundle but it appears it is being
      run in a Node environment.  If running in a Node environment, make sure you
      are using the bundle specified by the "main" field in package.json.
      
      If you are using Webpack, you can specify "main" as the first item in
      "resolve.mainFields":
      https://webpack.js.org/configuration/resolve/#resolvemainfields
      
      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"
      as the first item in "mainFields", e.g. ['main', 'module'].
      https://github.com/rollup/@rollup/plugin-node-resolve
      `),sl.apply(void 0,e)};var Xe=Eo;ol(Xe);var ul="firebase",al="8.2.10";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xe.registerVersion(ul,al,"app");/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Hi=function(e,t){return Hi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Hi(e,t)};function cl(e,t){Hi(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function da(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var hl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},O,_o=_o||{},k=hl||self;function Or(){}function $i(e){var t=typeof e;return t=t!="object"?t:e?Array.isArray(e)?"array":t:"null",t=="array"||t=="object"&&typeof e.length=="number"}function Qn(e){var t=typeof e;return t=="object"&&e!=null||t=="function"}function fl(e){return Object.prototype.hasOwnProperty.call(e,xi)&&e[xi]||(e[xi]=++ll)}var xi="closure_uid_"+(1e9*Math.random()>>>0),ll=0;function pl(e,t,n){return e.call.apply(e.bind,arguments)}function dl(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function ht(e,t,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ht=pl:ht=dl,ht.apply(null,arguments)}function pr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function zt(){return Date.now()}function wt(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Kb=function(r,i,o){for(var s=Array(arguments.length-2),u=2;u<arguments.length;u++)s[u-2]=arguments[u];return t.prototype[i].apply(r,s)}}function pe(){this.j=this.j,this.i=this.i}var vl=0;pe.prototype.j=!1;pe.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),vl!=0)&&fl(this)};pe.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var va=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(typeof e=="string")return typeof t!="string"||t.length!=1?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},ya=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=typeof e=="string"?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function yl(e){t:{for(var t=op,n=e.length,r=typeof e=="string"?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break t}t=-1}return 0>t?null:typeof e=="string"?e.charAt(t):e[t]}function qs(e){return Array.prototype.concat.apply([],arguments)}function Io(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function xr(e){return/^[\s\xa0]*$/.test(e)}var zs=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function vt(e,t){return e.indexOf(t)!=-1}function Pi(e,t){return e<t?-1:e>t?1:0}var yt;t:{var Bs=k.navigator;if(Bs){var Gs=Bs.userAgent;if(Gs){yt=Gs;break t}}yt=""}function To(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ga(e){var t={};for(var n in e)t[n]=e[n];return t}var Hs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ma(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var o=0;o<Hs.length;o++)n=Hs[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function No(e){return No[" "](e),e}No[" "]=Or;function gl(e,t){var n=bl;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}var ml=vt(yt,"Opera"),ue=vt(yt,"Trident")||vt(yt,"MSIE"),wa=vt(yt,"Edge"),Yi=wa||ue,ba=vt(yt,"Gecko")&&!(vt(yt.toLowerCase(),"webkit")&&!vt(yt,"Edge"))&&!(vt(yt,"Trident")||vt(yt,"MSIE"))&&!vt(yt,"Edge"),wl=vt(yt.toLowerCase(),"webkit")&&!vt(yt,"Edge");function Ea(){var e=k.document;return e?e.documentMode:void 0}var Pr;t:{var ki="",Ci=function(){var e=yt;if(ba)return/rv:([^\);]+)(\)|;)/.exec(e);if(wa)return/Edge\/([\d\.]+)/.exec(e);if(ue)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(wl)return/WebKit\/(\S+)/.exec(e);if(ml)return/(?:Version)[ \/]?(\S+)/.exec(e)}();if(Ci&&(ki=Ci?Ci[1]:""),ue){var Ri=Ea();if(Ri!=null&&Ri>parseFloat(ki)){Pr=String(Ri);break t}}Pr=ki}var bl={};function _a(e){return gl(e,function(){for(var t=0,n=zs(String(Pr)).split("."),r=zs(String(e)).split("."),i=Math.max(n.length,r.length),o=0;t==0&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],s[0].length==0&&u[0].length==0)break;t=Pi(s[1].length==0?0:parseInt(s[1],10),u[1].length==0?0:parseInt(u[1],10))||Pi(s[2].length==0,u[2].length==0)||Pi(s[2],u[2]),s=s[3],u=u[3]}while(t==0)}return 0<=t})}var Ki;if(k.document&&ue){var $s=Ea();Ki=$s||parseInt(Pr,10)||void 0}else Ki=void 0;var Ia=Ki,Ao=!ue||9<=Number(Ia),El=ue&&!_a("9"),_l=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{k.addEventListener("test",Or,t),k.removeEventListener("test",Or,t)}catch{}return e}();function ft(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}ft.prototype.b=function(){this.defaultPrevented=!0};function kn(e,t){if(ft.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(ba){t:{try{No(t.nodeName);var i=!0;break t}catch{}i=!1}i||(t=null)}}else n=="mouseover"?t=e.fromElement:n=="mouseout"&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:Il[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}wt(kn,ft);var Il={2:"touch",3:"pen",4:"mouse"};kn.prototype.b=function(){kn.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,El)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch{}};var Xn="closure_listenable_"+(1e6*Math.random()|0),Tl=0;function Nl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tl,this.Y=this.Z=!1}function ni(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function ri(e){this.src=e,this.a={},this.b=0}ri.prototype.add=function(e,t,n,r,i){var o=e.toString();e=this.a[o],e||(e=this.a[o]=[],this.b++);var s=Xi(e,t,r,i);return-1<s?(t=e[s],n||(t.Z=!1)):(t=new Nl(t,this.src,o,!!r,i),t.Z=n,e.push(t)),t};function Qi(e,t){var n=t.type;if(n in e.a){var r=e.a[n],i=va(r,t),o;(o=0<=i)&&Array.prototype.splice.call(r,i,1),o&&(ni(t),e.a[n].length==0&&(delete e.a[n],e.b--))}}function Xi(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.ca==r)return i}return-1}var So="closure_lm_"+(1e6*Math.random()|0),Li={};function Do(e,t,n,r,i){if(r&&r.once)return Na(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)Do(e,t[o],n,r,i);return null}return n=Po(n),e&&e[Xn]?e.va(t,n,Qn(r)?!!r.capture:!!r,i):Ta(e,t,n,!1,r,i)}function Ta(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=Qn(i)?!!i.capture:!!i;if(s&&!Ao)return null;var u=xo(e);if(u||(e[So]=u=new ri(e)),n=u.add(t,n,r,s,o),n.proxy)return n;if(r=Al(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)_l||(i=s),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Sa(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Al(){var e=Sl,t=Ao?function(n){return e.call(t.src,t.listener,n)}:function(n){if(n=e.call(t.src,t.listener,n),!n)return n};return t}function Na(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)Na(e,t[o],n,r,i);return null}return n=Po(n),e&&e[Xn]?e.wa(t,n,Qn(r)?!!r.capture:!!r,i):Ta(e,t,n,!0,r,i)}function Aa(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)Aa(e,t[o],n,r,i);else r=Qn(r)?!!r.capture:!!r,n=Po(n),e&&e[Xn]?(e=e.c,t=String(t).toString(),t in e.a&&(o=e.a[t],n=Xi(o,n,r,i),-1<n&&(ni(o[n]),Array.prototype.splice.call(o,n,1),o.length==0&&(delete e.a[t],e.b--)))):e&&(e=xo(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Xi(t,n,r,i)),(n=-1<e?t[e]:null)&&Oo(n))}function Oo(e){if(typeof e!="number"&&e&&!e.Y){var t=e.src;if(t&&t[Xn])Qi(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Sa(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=xo(t))?(Qi(n,e),n.b==0&&(n.src=null,t[So]=null)):ni(e)}}}function Sa(e){return e in Li?Li[e]:Li[e]="on"+e}function Ys(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&Oo(e),n.call(r,t)}function Sl(e,t){if(e.Y)return!0;if(!Ao){if(!t)t:{t=["window","event"];for(var n=k,r=0;r<t.length;r++)if(n=n[t[r]],n==null){t=null;break t}t=n}return t=new kn(t,this),Ys(e,t)}return Ys(e,new kn(t,this))}function xo(e){return e=e[So],e instanceof ri?e:null}var Vi="__closure_events_fn_"+(1e9*Math.random()>>>0);function Po(e){return typeof e=="function"?e:(e[Vi]||(e[Vi]=function(t){return e.handleEvent(t)}),e[Vi])}function Pt(){pe.call(this),this.c=new ri(this),this.J=this,this.C=null}wt(Pt,pe);Pt.prototype[Xn]=!0;O=Pt.prototype;O.addEventListener=function(e,t,n,r){Do(this,e,t,n,r)};O.removeEventListener=function(e,t,n,r){Aa(this,e,t,n,r)};function ot(e,t){var n,r=e.C;if(r)for(n=[];r;r=r.C)n.push(r);if(e=e.J,r=t.type||t,typeof t=="string")t=new ft(t,e);else if(t instanceof ft)t.target=t.target||e;else{var i=t;t=new ft(r,e),ma(t,i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.a=n[o];i=dr(s,r,!0,t)&&i}if(s=t.a=e,i=dr(s,r,!0,t)&&i,i=dr(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.a=n[o],i=dr(s,r,!1,t)&&i}O.G=function(){if(Pt.X.G.call(this),this.c){var e=this.c,t;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ni(n[r]);delete e.a[t],e.b--}}this.C=null};O.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)};O.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};function dr(e,t,n,r){if(t=e.c.a[String(t)],!t)return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Qi(e.c,s),i=u.call(a,r)!==!1&&i}}return i&&!r.defaultPrevented}var ko=k.JSON.stringify;function Da(){this.b=this.a=null}var Oa=new(function(){function e(t,n){this.c=t,this.f=n,this.b=0,this.a=null}return e.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},e}())(function(){return new Co},function(e){e.reset()});Da.prototype.add=function(e,t){var n=Oa.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n};function Dl(){var e=Pa,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function Co(){this.next=this.b=this.a=null}Co.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null};Co.prototype.reset=function(){this.next=this.b=this.a=null};function Ol(e){k.setTimeout(function(){throw e},0)}function xa(e,t){Wi||xl(),Ji||(Wi(),Ji=!0),Pa.add(e,t)}var Wi;function xl(){var e=k.Promise.resolve(void 0);Wi=function(){e.then(Pl)}}var Ji=!1,Pa=new Da;function Pl(){for(var e;e=Dl();){try{e.a.call(e.b)}catch(n){Ol(n)}var t=Oa;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Ji=!1}function ii(e,t){Pt.call(this),this.b=e||1,this.a=t||k,this.f=ht(this.Za,this),this.g=zt()}wt(ii,Pt);O=ii.prototype;O.aa=!1;O.M=null;O.Za=function(){if(this.aa){var e=zt()-this.g;0<e&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),ot(this,"tick"),this.aa&&(Ro(this),this.start()))}};O.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=zt())};function Ro(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}O.G=function(){ii.X.G.call(this),Ro(this),delete this.a};function Lo(e,t,n){if(typeof e=="function")n&&(e=ht(e,n));else if(e&&typeof e.handleEvent=="function")e=ht(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:k.setTimeout(e,t||0)}function ka(e){e.a=Lo(function(){e.a=null,e.c&&(e.c=!1,ka(e))},e.h);var t=e.b;e.b=null,e.g.apply(null,t)}var kl=function(e){cl(t,e);function t(n,r){var i=e.call(this)||this;return i.g=n,i.h=r,i.b=null,i.c=!1,i.a=null,i}return t.prototype.f=function(n){this.b=arguments,this.a?this.c=!0:ka(this)},t.prototype.G=function(){e.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},t}(pe);function Cn(e){pe.call(this),this.b=e,this.a={}}wt(Cn,pe);var Ks=[];function Ca(e,t,n,r){Array.isArray(n)||(n&&(Ks[0]=n.toString()),n=Ks);for(var i=0;i<n.length;i++){var o=Do(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function Ra(e){To(e.a,function(t,n){this.a.hasOwnProperty(n)&&Oo(t)},e),e.a={}}Cn.prototype.G=function(){Cn.X.G.call(this),Ra(this)};Cn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Vo(){this.a=!0}function Cl(e,t,n,r,i,o){e.info(function(){if(e.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&f[1]=="type"?s+(h+"="+c+"&"):s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+`
`+n+`
`+s})}function Rl(e,t,n,r,i,o,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+`
`+n+`
`+o+" "+s})}function He(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+Vl(e,n)+(r?" "+r:"")})}function Ll(e,t){e.info(function(){return"TIMEOUT: "+t})}Vo.prototype.info=function(){};function Vl(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if(o!="noop"&&o!="stop"&&o!="close")for(var s=1;s<i.length;s++)i[s]=""}}}}return ko(n)}catch{return t}}var Ce={},Qs=null;function oi(){return Qs=Qs||new Pt}Ce.Fa="serverreachability";function La(e){ft.call(this,Ce.Fa,e)}wt(La,ft);function Rn(e){var t=oi();ot(t,new La(t,e))}Ce.STAT_EVENT="statevent";function Va(e,t){ft.call(this,Ce.STAT_EVENT,e),this.stat=t}wt(Va,ft);function gt(e){var t=oi();ot(t,new Va(t,e))}Ce.Ga="timingevent";function Ma(e){ft.call(this,Ce.Ga,e)}wt(Ma,ft);function Wn(e,t){if(typeof e!="function")throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){e()},t)}var si={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},Fa={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ua(){}Ua.prototype.a=null;function Xs(e){var t;return(t=e.a)||(t=e.a={}),t}function ja(){}var Jn={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Mo(){ft.call(this,"d")}wt(Mo,ft);function Fo(){ft.call(this,"c")}wt(Fo,ft);var qa;function za(){}wt(za,Ua);qa=new za;function Zn(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new Cn(this),this.P=Ml,e=Yi?125:void 0,this.R=new ii(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}var Ml=45e3,Ba={},Zi={};O=Zn.prototype;O.setTimeout=function(e){this.P=e};function to(e,t,n){e.H=1,e.i=ai(Kt(t)),e.j=n,e.I=!0,Ga(e,null)}function Ga(e,t){e.u=zt(),tr(e),e.l=Kt(e.i);var n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),Xa(n.b,"t",r),e.D=0,e.a=dc(e.g,e.g.C?t:null),0<e.O&&(e.F=new kl(ht(e.Ca,e,e.a),e.O)),Ca(e.J,e.a,"readystatechange",e.Xa),t=e.B?ga(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),Rn(1),Cl(e.c,e.m,e.l,e.f,e.S,e.j)}O.Xa=function(e){e=e.target;var t=this.F;t&&ie(e)==3?t.f():this.Ca(e)};O.Ca=function(e){try{if(e==this.a)t:{var t=ie(this.a),n=this.a.ua(),r=this.a.W();if(!(3>t||t==3&&!Yi&&!this.a.$())){this.A||t!=4||n==7||(n==8||0>=r?Rn(3):Rn(2)),ui(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=i==200,Rl(this.c,this.m,this.l,this.f,this.S,t,i),this.b){if(this.U&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xr(s)){var a=s;break e}}a=null}if(a)He(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,eo(this,a);else{this.b=!1,this.h=3,gt(12),Ye(this),kr(this);break t}}this.I?(Ha(this,t,o),Yi&&this.b&&t==3&&(Ca(this.J,this.R,"tick",this.Wa),this.R.start())):(He(this.c,this.f,o,null),eo(this,o)),t==4&&Ye(this),this.b&&!this.A&&(t==4?hc(this.g,this):(this.b=!1,tr(this)))}else i==400&&0<o.indexOf("Unknown SID")?(this.h=3,gt(12)):(this.h=0,gt(13)),Ye(this),kr(this)}}}catch{}finally{}};function Ha(e,t,n){for(var r=!0;!e.A&&e.D<n.length;){var i=Fl(e,n);if(i==Zi){t==4&&(e.h=4,gt(14),r=!1),He(e.c,e.f,null,"[Incomplete Response]");break}else if(i==Ba){e.h=4,gt(15),He(e.c,e.f,n,"[Invalid Chunk]"),r=!1;break}else He(e.c,e.f,i,null),eo(e,i)}t==4&&n.length==0&&(e.h=1,gt(16),r=!1),e.b=e.b&&r,r?0<n.length&&!e.V&&(e.V=!0,t=e.g,t.a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$o(t),t.F=!0,gt(11))):(He(e.c,e.f,n,"[Invalid Chunked Response]"),Ye(e),kr(e))}O.Wa=function(){if(this.a){var e=ie(this.a),t=this.a.$();this.D<t.length&&(ui(this),Ha(this,e,t),this.b&&e!=4&&tr(this))}};function Fl(e,t){var n=e.D,r=t.indexOf(`
`,n);return r==-1?Zi:(n=Number(t.substring(n,r)),isNaN(n)?Ba:(r+=1,r+n>t.length?Zi:(t=t.substr(r,n),e.D=r+n,t)))}O.cancel=function(){this.A=!0,Ye(this)};function tr(e){e.T=zt()+e.P,$a(e,e.P)}function $a(e,t){if(e.o!=null)throw Error("WatchDog timer not null");e.o=Wn(ht(e.Va,e),t)}function ui(e){e.o&&(k.clearTimeout(e.o),e.o=null)}O.Va=function(){this.o=null;var e=zt();0<=e-this.T?(Ll(this.c,this.l),this.H!=2&&(Rn(3),gt(17)),Ye(this),this.h=2,kr(this)):$a(this,this.T-e)};function kr(e){e.g.v==0||e.A||hc(e.g,e)}function Ye(e){ui(e);var t=e.F;t&&typeof t.ja=="function"&&t.ja(),e.F=null,Ro(e.R),Ra(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function eo(e,t){try{var n=e.g;if(n.v!=0&&(n.a==e||no(n.b,e))){if(n.I=e.N,!e.C&&no(n.b,e)&&n.v==3){try{var r=n.ka.a.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){t:if(!n.j){if(n.a)if(n.a.u+3e3<e.u)Vr(n),hi(n);else break t;Ho(n),gt(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&n.o==0&&!n.m&&(n.m=Wn(ht(n.Sa,n),6e3));if(1>=Za(n.b)&&n.ea){try{n.ea()}catch{}n.ea=void 0}}else Ee(n,11)}else if((e.C||n.a==e)&&Vr(n),!xr(t))for(t=r=n.ka.a.parse(t),r=0;r<t.length;r++)if(i=t[r],n.P=i[0],i=i[1],n.v==2)if(i[0]=="c"){n.J=i[1],n.ga=i[2];var o=i[3];o!=null&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];s!=null&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(u!=null&&typeof u=="number"&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=e.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(vt(h,"spdy")||vt(h,"quic")||vt(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(qo(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,$(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=zt()-e.u,n.c.info("Handshake RTT: "+n.N+"ms")),a=n;var p=e;if(a.la=pc(a,a.C?a.ga:null,a.fa),p.C){tc(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(ui(d),tr(d)),a.a=p}else ac(a);0<n.g.length&&fi(n)}else i[0]!="stop"&&i[0]!="close"||Ee(n,7);else n.v==3&&(i[0]=="stop"||i[0]=="close"?i[0]=="stop"?Ee(n,7):Go(n):i[0]!="noop"&&n.f&&n.f.sa(i),n.o=0)}Rn(4)}catch{}}function Ul(e){if(e.K&&typeof e.K=="function")return e.K();if(typeof e=="string")return e.split("");if($i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}t=[],n=0;for(r in e)t[n++]=e[r];return e=t}function Uo(e,t){if(e.forEach&&typeof e.forEach=="function")e.forEach(t,void 0);else if($i(e)||typeof e=="string")ya(e,t,void 0);else{if(e.L&&typeof e.L=="function")var n=e.L();else if(e.K&&typeof e.K=="function")n=void 0;else if($i(e)||typeof e=="string"){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=Ul(e),i=r.length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function dn(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof dn)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}O=dn.prototype;O.K=function(){jo(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e};O.L=function(){return jo(this),this.a.concat()};function jo(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];De(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)r=e.a[t],De(i,r)||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}O.get=function(e,t){return De(this.b,e)?this.b[e]:t};O.set=function(e,t){De(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t};O.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};function De(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ya=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function jl(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Oe(e,t){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof Oe){this.a=t!==void 0?t:e.a,Cr(this,e.f),this.j=e.j,Rr(this,e.c),Lr(this,e.h),this.g=e.g,t=e.b;var n=new Ln;n.c=t.c,t.a&&(n.a=new dn(t.a),n.b=t.b),Ws(this,n),this.i=e.i}else e&&(n=String(e).match(Ya))?(this.a=!!t,Cr(this,n[1]||"",!0),this.j=Sn(n[2]||""),Rr(this,n[3]||"",!0),Lr(this,n[4]),this.g=Sn(n[5]||"",!0),Ws(this,n[6]||"",!0),this.i=Sn(n[7]||"")):(this.a=!!t,this.b=new Ln(null,this.a))}Oe.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Nn(t,Js,!0),":");var n=this.c;return(n||t=="file")&&(e.push("//"),(t=this.j)&&e.push(Nn(t,Js,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.h,n!=null&&e.push(":",String(n))),(n=this.g)&&(this.c&&n.charAt(0)!="/"&&e.push("/"),e.push(Nn(n,n.charAt(0)=="/"?Hl:Gl,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",Nn(n,Yl)),e.join("")};function Kt(e){return new Oe(e)}function Cr(e,t,n){e.f=n?Sn(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Rr(e,t,n){e.c=n?Sn(t,!0):t}function Lr(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.h=t}else e.h=null}function Ws(e,t,n){t instanceof Ln?(e.b=t,Kl(e.b,e.a)):(n||(t=Nn(t,$l)),e.b=new Ln(t,e.a))}function $(e,t,n){e.b.set(t,n)}function ai(e){return $(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^zt()).toString(36)),e}function ql(e){return e instanceof Oe?Kt(e):new Oe(e,void 0)}function zl(e,t,n,r){var i=new Oe(null,void 0);return e&&Cr(i,e),t&&Rr(i,t),n&&Lr(i,n),r&&(i.g=r),i}function Sn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nn(e,t,n){return typeof e=="string"?(e=encodeURI(e).replace(t,Bl),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Bl(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)}var Js=/[#\/\?@]/g,Gl=/[#\?:]/g,Hl=/[#\?]/g,$l=/[#\?@]/g,Yl=/#/g;function Ln(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function de(e){e.a||(e.a=new dn,e.b=0,e.c&&jl(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}O=Ln.prototype;O.add=function(e,t){de(this),this.c=null,e=vn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this};function Ka(e,t){de(e),t=vn(e,t),De(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,e=e.a,De(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&jo(e)))}function Qa(e,t){return de(e),t=vn(e,t),De(e.a.b,t)}O.forEach=function(e,t){de(this),this.a.forEach(function(n,r){ya(n,function(i){e.call(t,i,r,this)},this)},this)};O.L=function(){de(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n};O.K=function(e){de(this);var t=[];if(typeof e=="string")Qa(this,e)&&(t=qs(t,this.a.get(vn(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=qs(t,e[n])}return t};O.set=function(e,t){return de(this),this.c=null,e=vn(this,e),Qa(this,e)&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this};O.get=function(e,t){return e?(e=this.K(e),0<e.length?String(e[0]):t):t};function Xa(e,t,n){Ka(e,t),0<n.length&&(e.c=null,e.a.set(vn(e,t),Io(n)),e.b+=n.length)}O.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;r[o]!==""&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.c=e.join("&")};function vn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function Kl(e,t){t&&!e.f&&(de(e),e.c=null,e.a.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(Ka(this,r),Xa(this,i,n))},e)),e.f=t}var Ql=function(){function e(t,n){this.b=t,this.a=n}return e}();function Wa(e){this.g=e||Xl,k.PerformanceNavigationTiming?(e=k.performance.getEntriesByType("navigation"),e=0<e.length&&(e[0].nextHopProtocol=="hq"||e[0].nextHopProtocol=="h2")):e=!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().Lb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var Xl=10;function Ja(e){return e.b?!0:e.a?e.a.size>=e.f:!1}function Za(e){return e.b?1:e.a?e.a.size:0}function no(e,t){return e.b?e.b==t:e.a?e.a.has(t):!1}function qo(e,t){e.a?e.a.add(t):e.b=t}function tc(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}Wa.prototype.cancel=function(){var e,t;if(this.c=ec(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&this.a.size!==0){try{for(var n=da(this.a.values()),r=n.next();!r.done;r=n.next()){var i=r.value;i.cancel()}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}};function ec(e){var t,n;if(e.b!=null)return e.c.concat(e.b.s);if(e.a!=null&&e.a.size!==0){var r=e.c;try{for(var i=da(e.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}return Io(e.c)}function zo(){}zo.prototype.stringify=function(e){return k.JSON.stringify(e,void 0)};zo.prototype.parse=function(e){return k.JSON.parse(e,void 0)};function Wl(){this.a=new zo}function Jl(e,t,n){var r=n||"";try{Uo(e,function(i,o){var s=i;Qn(i)&&(s=ko(i)),t.push(r+o+"="+encodeURIComponent(s))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Zl(e,t){var n=new Vo;if(k.Image){var r=new Image;r.onload=pr(vr,n,r,"TestLoadImage: loaded",!0,t),r.onerror=pr(vr,n,r,"TestLoadImage: error",!1,t),r.onabort=pr(vr,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=pr(vr,n,r,"TestLoadImage: timeout",!1,t),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function vr(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch{}}var tp=k.JSON.parse;function et(e){Pt.call(this),this.headers=new dn,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=ep,this.D=this.F=!1}wt(et,Pt);var ep="",np=/^https?$/i,rp=["POST","PUT"];O=et.prototype;O.ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Xs(this.H):Xs(qa),this.a.onreadystatechange=ht(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(o){Zs(this,o);return}e=n||"";var i=new dn(this.headers);r&&Uo(r,function(o,s){i.set(s,o)}),r=yl(i.L()),n=k.FormData&&e instanceof k.FormData,!(0<=va(rp,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(o,s){this.a.setRequestHeader(s,o)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{ic(this),0<this.o&&((this.D=ip(this.a))?(this.a.timeout=this.o,this.a.ontimeout=ht(this.xa,this)):this.m=Lo(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(o){Zs(this,o)}};function ip(e){return ue&&_a(9)&&typeof e.timeout=="number"&&e.ontimeout!==void 0}function op(e){return e.toLowerCase()=="content-type"}O.xa=function(){typeof _o!="undefined"&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,ot(this,"timeout"),this.abort(8))};function Zs(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,nc(e),ci(e)}function nc(e){e.u||(e.u=!0,ot(e,"complete"),ot(e,"error"))}O.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,ot(this,"complete"),ot(this,"abort"),ci(this))};O.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ci(this,!0)),et.X.G.call(this)};O.za=function(){this.j||(this.A||this.l||this.g?rc(this):this.Ua())};O.Ua=function(){rc(this)};function rc(e){if(e.b&&typeof _o!="undefined"&&(!e.s[1]||ie(e)!=4||e.W()!=2)){if(e.l&&ie(e)==4)Lo(e.za,0,e);else if(ot(e,"readystatechange"),ie(e)==4){e.b=!1;try{{var t=e.W();t:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=t===0){var o=String(e.B).match(Ya)[1]||null;if(!o&&k.self&&k.self.location){var s=k.self.location.protocol;o=s.substr(0,s.length-1)}i=!np.test(o?o.toLowerCase():"")}r=i}var u=r}if(u)ot(e,"complete"),ot(e,"success");else{e.h=6;try{var a=2<ie(e)?e.a.statusText:""}catch{a=""}e.f=a+" ["+e.W()+"]",nc(e)}}finally{ci(e)}}}}function ci(e,t){if(e.a){ic(e);var n=e.a,r=e.s[0]?Or:null;e.a=null,e.s=null,t||ot(e,"ready");try{n.onreadystatechange=r}catch{}}}function ic(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(k.clearTimeout(e.m),e.m=null)}function ie(e){return e.a?e.a.readyState:0}O.W=function(){try{return 2<ie(this)?this.a.status:-1}catch{return-1}};O.$=function(){try{return this.a?this.a.responseText:""}catch{return""}};O.Pa=function(e){if(this.a){var t=this.a.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),tp(t)}};O.ua=function(){return this.h};O.Qa=function(){return typeof this.f=="string"?this.f:String(this.f)};function sp(e){var t="";return To(e,function(n,r){t+=r,t+=":",t+=n,t+=`\r
`}),t}function Bo(e,t,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=sp(n),typeof e=="string"?n!=null&&encodeURIComponent(String(n)):$(e,t,n))}function In(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function oc(e){this.pa=0,this.g=[],this.c=new Vo,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=In("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=In("baseRetryDelayMs",5e3,e),this.Ra=In("retryDelaySeedMs",1e4,e),this.Ma=In("forwardChannelMaxRetries",2,e),this.ma=In("forwardChannelRequestTimeoutMs",2e4,e),this.Na=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new Wa(e&&e.concurrentRequestLimit),this.ka=new Wl,this.da=e&&e.fastHandshake||!1,this.Ia=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&e&&e.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}O=oc.prototype;O.ha=8;O.v=1;function Go(e){if(sc(e),e.v==3){var t=e.R++,n=Kt(e.B);$(n,"SID",e.J),$(n,"RID",t),$(n,"TYPE","terminate"),er(e,n),t=new Zn(e,e.c,t,void 0),t.H=2,t.i=ai(Kt(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(t.i.toString(),"")),!n&&k.Image&&(new Image().src=t.i,n=!0),n||(t.a=dc(t.g,null),t.a.ba(t.i)),t.u=zt(),tr(t)}lc(e)}function hi(e){e.a&&($o(e),e.a.cancel(),e.a=null)}function sc(e){hi(e),e.j&&(k.clearTimeout(e.j),e.j=null),Vr(e),e.b.cancel(),e.h&&(typeof e.h=="number"&&k.clearTimeout(e.h),e.h=null)}function Mi(e,t){e.g.push(new Ql(e.Oa++,t)),e.v==3&&fi(e)}function fi(e){Ja(e.b)||e.h||(e.h=!0,xa(e.Ba,e),e.u=0)}function up(e,t){return Za(e.b)>=e.b.f-(e.h?1:0)?!1:e.h?(e.g=t.s.concat(e.g),!0):e.v==1||e.v==2||e.u>=(e.La?0:e.Ma)?!1:(e.h=Wn(ht(e.Ba,e,t),fc(e,e.u)),e.u++,!0)}O.Ba=function(e){if(this.h)if(this.h=null,this.v==1){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t=new Zn(this,this.c,e,void 0),n=this.l;this.O&&(n?(n=ga(n),ma(n,this.O)):n=this.O),this.i===null&&(t.B=n);var r;if(this.da)t:{for(var i=r=0;i<this.g.length;i++){e:{var o=this.g[i];if("__data__"in o.a&&(o=o.a.__data__,typeof o=="string")){o=o.length;break e}o=void 0}if(o===void 0)break;if(r+=o,4096<r){r=i;break t}if(r===4096||i===this.g.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=uc(this,t,r),i=Kt(this.B),$(i,"RID",e),$(i,"CVER",22),this.A&&$(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&n&&Bo(i,this.i,n),qo(this.b,t),this.Ia&&$(i,"TYPE","init"),this.da?($(i,"$req",r),$(i,"SID","null"),t.U=!0,to(t,i,null)):to(t,i,r),this.v=2}}else this.v==3&&(e?tu(this,e):this.g.length==0||Ja(this.b)||tu(this))};function tu(e,t){var n;t?n=t.f:n=e.R++;var r=Kt(e.B);$(r,"SID",e.J),$(r,"RID",n),$(r,"AID",e.P),er(e,r),e.i&&e.l&&Bo(r,e.i,e.l),n=new Zn(e,e.c,n,e.u+1),e.i===null&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=uc(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),qo(e.b,n),to(n,r,t)}function er(e,t){e.f&&Uo({},function(n,r){$(t,r,n)})}function uc(e,t,n){n=Math.min(e.g.length,n);var r=e.f?ht(e.f.Ja,e.f,e):null;t:for(var i=e.g,o=-1;;){var s=["count="+n];o==-1?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(c-=o,0>c)o=Math.max(0,i[a].b-100),u=!1;else try{Jl(h,s,"req"+c+"_")}catch{r&&r(h)}}if(u){r=s.join("&");break t}}return e=e.g.splice(0,n),t.s=e,r}function ac(e){e.a||e.j||(e.T=1,xa(e.Aa,e),e.o=0)}function Ho(e){return e.a||e.j||3<=e.o?!1:(e.T++,e.j=Wn(ht(e.Aa,e),fc(e,e.o)),e.o++,!0)}O.Aa=function(){if(this.j=null,cc(this),this.U&&!(this.F||this.a==null||0>=this.N)){var e=2*this.N;this.c.info("BP detection timer enabled: "+e),this.s=Wn(ht(this.Ta,this),e)}};O.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,gt(10),hi(this),cc(this))};function $o(e){e.s!=null&&(k.clearTimeout(e.s),e.s=null)}function cc(e){e.a=new Zn(e,e.c,"rpc",e.T),e.i===null&&(e.a.B=e.l),e.a.O=0;var t=Kt(e.la);$(t,"RID","rpc"),$(t,"SID",e.J),$(t,"CI",e.H?"0":"1"),$(t,"AID",e.P),er(e,t),$(t,"TYPE","xmlhttp"),e.i&&e.l&&Bo(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=ai(Kt(t)),n.j=null,n.I=!0,Ga(n,e)}O.Sa=function(){this.m!=null&&(this.m=null,hi(this),Ho(this),gt(19))};function Vr(e){e.m!=null&&(k.clearTimeout(e.m),e.m=null)}function hc(e,t){var n=null;if(e.a==t){Vr(e),$o(e),e.a=null;var r=2}else if(no(e.b,t))n=t.s,tc(e.b,t),r=1;else return;if(e.I=t.N,e.v!=0){if(t.b)if(r==1){n=t.j?t.j.length:0,t=zt()-t.u;var i=e.u;r=oi(),ot(r,new Ma(r,n,t,i)),fi(e)}else ac(e);else if(i=t.h,i==3||i==0&&0<e.I||!(r==1&&up(e,t)||r==2&&Ho(e)))switch(n&&0<n.length&&(t=e.b,t.c=t.c.concat(n)),i){case 1:Ee(e,5);break;case 4:Ee(e,10);break;case 3:Ee(e,6);break;default:Ee(e,2)}}}function fc(e,t){var n=e.Ha+Math.floor(Math.random()*e.Ra);return e.f||(n*=2),n*t}function Ee(e,t){if(e.c.info("Error code "+t),t==2){var n=null;e.f&&(n=null);var r=ht(e.Ya,e);n||(n=new Oe("//www.google.com/images/cleardot.gif"),k.location&&k.location.protocol=="http"||Cr(n,"https"),ai(n)),Zl(n.toString(),r)}else gt(2);e.v=0,e.f&&e.f.ra(t),lc(e),sc(e)}O.Ya=function(e){e?(this.c.info("Successfully pinged google.com"),gt(2)):(this.c.info("Failed to ping google.com"),gt(1))};function lc(e){e.v=0,e.I=-1,e.f&&((ec(e.b).length!=0||e.g.length!=0)&&(e.b.c.length=0,Io(e.g),e.g.length=0),e.f.qa())}function pc(e,t,n){var r=ql(n);if(r.c!="")t&&Rr(r,t+"."+r.c),Lr(r,r.h);else{var i=k.location;r=zl(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&To(e.V,function(o,s){$(r,s,o)}),t=e.A,n=e.na,t&&n&&$(r,t,n),$(r,"VER",e.ha),er(e,r),r}function dc(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return t=new et(e.Na),t.F=e.C,t}function vc(){}O=vc.prototype;O.ta=function(){};O.sa=function(){};O.ra=function(){};O.qa=function(){};O.Ja=function(){};function Mr(){if(ue&&!(10<=Number(Ia)))throw Error("Environmental error: no available transport.")}Mr.prototype.a=function(e,t){return new kt(e,t)};function kt(e,t){Pt.call(this),this.a=new oc(t),this.o=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!xr(e)&&(this.a.i=e),this.m=t&&t.supportsCrossDomainXhr||!1,this.l=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!xr(t)&&(this.a.A=t,e=this.b,e!==null&&t in e&&(e=this.b,t in e&&delete e[t])),this.f=new yn(this)}wt(kt,Pt);kt.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var e=this.a,t=this.o,n=this.b||void 0;gt(0),e.fa=t,e.V=n||{},e.H=e.S,e.B=pc(e,null,e.fa),fi(e)};kt.prototype.close=function(){Go(this.a)};kt.prototype.h=function(e){if(typeof e=="string"){var t={};t.__data__=e,Mi(this.a,t)}else this.l?(t={},t.__data__=ko(e),Mi(this.a,t)):Mi(this.a,e)};kt.prototype.G=function(){this.a.f=null,delete this.f,Go(this.a),delete this.a,kt.X.G.call(this)};function yc(e){Mo.call(this);var t=e.__sm__;if(t){t:{for(var n in t){e=n;break t}e=void 0}(this.c=e)?(e=this.c,this.data=t!==null&&e in t?t[e]:void 0):this.data=t}else this.data=e}wt(yc,Mo);function gc(){Fo.call(this),this.status=1}wt(gc,Fo);function yn(e){this.a=e}wt(yn,vc);yn.prototype.ta=function(){ot(this.a,"a")};yn.prototype.sa=function(e){ot(this.a,new yc(e))};yn.prototype.ra=function(e){ot(this.a,new gc(e))};yn.prototype.qa=function(){ot(this.a,"b")};Mr.prototype.createWebChannel=Mr.prototype.a;kt.prototype.send=kt.prototype.h;kt.prototype.open=kt.prototype.g;kt.prototype.close=kt.prototype.close;si.NO_ERROR=0;si.TIMEOUT=8;si.HTTP_ERROR=6;Fa.COMPLETE="complete";ja.EventType=Jn;Jn.OPEN="a";Jn.CLOSE="b";Jn.ERROR="c";Jn.MESSAGE="d";Pt.prototype.listen=Pt.prototype.va;et.prototype.listenOnce=et.prototype.wa;et.prototype.getLastError=et.prototype.Qa;et.prototype.getLastErrorCode=et.prototype.ua;et.prototype.getStatus=et.prototype.W;et.prototype.getResponseJson=et.prototype.Pa;et.prototype.getResponseText=et.prototype.$;et.prototype.send=et.prototype.ba;var ap=function(){return new Mr},cp=function(){return oi()},Fi=si,hp=Fa,fp=Ce,eu={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},yr=ja,lp=et;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pp=function(e,t,n,r,i,o){this.t=e,this.persistenceKey=t,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Fr=function(){function e(t,n){this.projectId=t,this.database=n||"(default)"}return Object.defineProperty(e.prototype,"o",{get:function(){return this.database==="(default)"},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),Lt=new fa("@firebase/firestore");function ro(){return Lt.logLevel}function I(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=j.DEBUG){var r=t.map(Yo);Lt.debug.apply(Lt,at(["Firestore (8.2.9): "+e],r))}}function W(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=j.ERROR){var r=t.map(Yo);Lt.error.apply(Lt,at(["Firestore (8.2.9): "+e],r))}}function io(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Lt.logLevel<=j.WARN){var r=t.map(Yo);Lt.warn.apply(Lt,at(["Firestore (8.2.9): "+e],r))}}function Yo(e){if(typeof e=="string")return e;try{return t=e,JSON.stringify(t)}catch{return e}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D(e){e===void 0&&(e="Unexpected state");var t="FIRESTORE (8.2.9) INTERNAL ASSERTION FAILED: "+e;throw W(t),new Error(t)}function P(e,t){e||D()}function T(e,t){return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(e){var t=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mc=function(){function e(){}return e.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/t.length)*t.length,r="";r.length<20;)for(var i=dp(40),o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=t.charAt(i[o]%t.length));return r},e}();function L(e,t){return e<t?-1:e>t?1:0}function We(e,t,n){return e.length===t.length&&e.every(function(r,i){return n(r,t[i])})}function wc(e){return e+"\0"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t=function(){function e(t){this.h=t}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(n){for(var r="",i=0;i<n.length;++i)r+=String.fromCharCode(n[i]);return r}(t))},e.prototype.toBase64=function(){return t=this.h,btoa(t);var t},e.prototype.toUint8Array=function(){return function(t){for(var n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(this.h)},e.prototype.l=function(){return 2*this.h.length},e.prototype._=function(t){return L(this.h,t.h)},e.prototype.isEqual=function(t){return this.h===t.h},e}();_t.T=new _t("");var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},b=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).code=n,i.message=r,i.name="FirebaseError",i.toString=function(){return i.name+": [code="+i.code+"]: "+i.message},i}return N(t,e),t}(Error),xe=function(){function e(t){this.I=t}return e.fromBase64String=function(t){try{return new e(_t.fromBase64String(t))}catch(n){throw new b(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},e.fromUint8Array=function(t){return new e(_t.fromUint8Array(t))},e.prototype.toBase64=function(){return this.I.toBase64()},e.prototype.toUint8Array=function(){return this.I.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(t){return this.I.isEqual(t.I)},e}(),Nt=function(){function e(t){this.uid=t}return e.prototype.m=function(){return this.uid!=null},e.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(t){return t.uid===this.uid},e}();Nt.UNAUTHENTICATED=new Nt(null),Nt.R=new Nt("google-credentials-uid"),Nt.P=new Nt("first-party-uid");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vp=function(e,t){this.user=t,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+e},nu=function(){function e(){this.V=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.p=function(){},e.prototype.v=function(t){this.V=t,t(Nt.UNAUTHENTICATED)},e.prototype.S=function(){this.V=null},e}(),yp=function(){function e(t){var n=this;this.D=null,this.currentUser=Nt.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){n.N++,n.currentUser=n.$(),n.C=!0,n.V&&n.V(n.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(r){n.auth=r,n.D&&n.auth.addAuthTokenListener(n.D)},function(){}))}return e.prototype.getToken=function(){var t=this,n=this.N,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(function(i){return t.N!==n?(I("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):i?(P(typeof i.accessToken=="string"),new vp(i.accessToken,t.currentUser)):null}):Promise.resolve(null)},e.prototype.p=function(){this.forceRefresh=!0},e.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},e.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},e.prototype.$=function(){var t=this.auth&&this.auth.getUid();return P(t===null||typeof t=="string"),new Nt(t)},e}(),gp=function(){function e(t,n){this.F=t,this.O=n,this.type="FirstParty",this.user=Nt.P}return Object.defineProperty(e.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},n=this.F.auth.getAuthHeaderValueForFirstParty([]);return n&&(t.Authorization=n),t},enumerable:!1,configurable:!0}),e}(),mp=function(){function e(t,n){this.F=t,this.O=n}return e.prototype.getToken=function(){return Promise.resolve(new gp(this.F,this.O))},e.prototype.v=function(t){t(Nt.P)},e.prototype.S=function(){},e.prototype.p=function(){},e}(),Dt=function(){function e(t,n){var r=this;this.previousValue=t,n&&(n.k=function(i){return r.M(i)},this.L=function(i){return n.B(i)})}return e.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},e.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},e}();Dt.q=-1;var Et=function(){function e(t,n){if(this.seconds=t,this.nanoseconds=n,n<0)throw new b(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new b(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new b(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new b(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,1e6*(t-1e3*n))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype.U=function(t){return this.seconds===t.seconds?L(this.nanoseconds,t.nanoseconds):L(this.seconds,t.seconds)},e.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),R=function(){function e(t){this.timestamp=t}return e.K=function(t){return new e(t)},e.min=function(){return new e(new Et(0,0))},e.prototype._=function(t){return this.timestamp.U(t.timestamp)},e.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},e.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.j=function(){return this.timestamp},e}(),bc=function(){function e(t,n,r){n===void 0?n=0:n>t.length&&D(),r===void 0?r=t.length-n:r>t.length-n&&D(),this.segments=t,this.offset=n,this.G=r}return Object.defineProperty(e.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return e.H(this,t)===0},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(r){n.push(r)}):n.push(t),this.J(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.Y=function(t){return t=t===void 0?1:t,this.J(this.segments,this.offset+t,this.length-t)},e.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},e.prototype.Z=function(){return this.segments[this.offset]},e.prototype.tt=function(){return this.get(this.length-1)},e.prototype.get=function(t){return this.segments[this.offset+t]},e.prototype.et=function(){return this.length===0},e.prototype.nt=function(t){if(t.length<this.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==t.get(n))return!1;return!0},e.prototype.forEach=function(t){for(var n=this.offset,r=this.limit();n<r;n++)t(this.segments[n])},e.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},e.H=function(t,n){for(var r=Math.min(t.length,n.length),i=0;i<r;i++){var o=t.get(i),s=n.get(i);if(o<s)return-1;if(o>s)return 1}return t.length<n.length?-1:t.length>n.length?1:0},e}(),q=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.J=function(n,r,i){return new t(n,r,i)},t.prototype.rt=function(){return this.it().join("/")},t.prototype.toString=function(){return this.rt()},t.ot=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];if(u.indexOf("//")>=0)throw new b(y.INVALID_ARGUMENT,"Invalid segment ("+u+"). Paths must not contain // in them.");i.push.apply(i,u.split("/").filter(function(a){return a.length>0}))}return new t(i)},t.ct=function(){return new t([])},t}(bc),wp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Mt=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.J=function(n,r,i){return new t(n,r,i)},t.at=function(n){return wp.test(n)},t.prototype.rt=function(){return this.it().map(function(n){return n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.at(n)||(n="`"+n+"`"),n}).join(".")},t.prototype.toString=function(){return this.rt()},t.prototype.ut=function(){return this.length===1&&this.get(0)==="__name__"},t.ht=function(){return new t(["__name__"])},t.lt=function(n){for(var r=[],i="",o=0,s=function(){if(i.length===0)throw new b(y.INVALID_ARGUMENT,"Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");r.push(i),i=""},u=!1;o<n.length;){var a=n[o];if(a==="\\"){if(o+1===n.length)throw new b(y.INVALID_ARGUMENT,"Path has trailing escape character: "+n);var c=n[o+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new b(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);i+=c,o+=2}else a==="`"?(u=!u,o++):a!=="."||u?(i+=a,o++):(s(),o++)}if(s(),u)throw new b(y.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new t(r)},t.ct=function(){return new t([])},t}(bc),x=function(){function e(t){this.path=t}return e._t=function(t){return new e(q.ot(t))},e.ft=function(t){return new e(q.ot(t).Y(5))},e.prototype.dt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},e.prototype.isEqual=function(t){return t!==null&&q.H(this.path,t.path)===0},e.prototype.toString=function(){return this.path.toString()},e.H=function(t,n){return q.H(t.path,n.path)},e.wt=function(t){return t.length%2==0},e.Et=function(t){return new e(new q(t.slice()))},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function nr(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ec(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je=function(){function e(t){this.fields=t,t.sort(Mt.H)}return e.prototype.Tt=function(t){for(var n=0,r=this.fields;n<r.length;n++)if(r[n].nt(t))return!0;return!1},e.prototype.isEqual=function(t){return We(this.fields,t.fields,function(n,r){return n.isEqual(r)})},e}(),bp=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(e){if(P(!!e),typeof e=="string"){var t=0,n=bp.exec(e);if(P(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:X(e.seconds),nanos:X(e.nanos)}}function X(e){return typeof e=="number"?e:typeof e=="string"?Number(e):0}function Ze(e){return typeof e=="string"?_t.fromBase64String(e):_t.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(e){var t,n;return((n=(((t=e==null?void 0:e.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function _c(e){var t=e.mapValue.fields.__previous_value__;return Ko(t)?_c(t):t}function Vn(e){var t=ae(e.mapValue.fields.__local_write_time__.timestampValue);return new Et(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(e){return e==null}function Ur(e){return e===0&&1/e==-1/0}function Ic(e){return typeof e=="number"&&Number.isInteger(e)&&!Ur(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ko(e)?4:10:D()}function jt(e,t){var n=ce(e);if(n!==ce(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Vn(e).isEqual(Vn(t));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;var o=ae(r.timestampValue),s=ae(i.timestampValue);return o.seconds===s.seconds&&o.nanos===s.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(r,i){return Ze(r.bytesValue).isEqual(Ze(i.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(r,i){return X(r.geoPointValue.latitude)===X(i.geoPointValue.latitude)&&X(r.geoPointValue.longitude)===X(i.geoPointValue.longitude)}(e,t);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return X(r.integerValue)===X(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){var o=X(r.doubleValue),s=X(i.doubleValue);return o===s?Ur(o)===Ur(s):isNaN(o)&&isNaN(s)}return!1}(e,t);case 9:return We(e.arrayValue.values||[],t.arrayValue.values||[],jt);case 10:return function(r,i){var o=r.mapValue.fields||{},s=i.mapValue.fields||{};if(ru(o)!==ru(s))return!1;for(var u in o)if(o.hasOwnProperty(u)&&(s[u]===void 0||!jt(o[u],s[u])))return!1;return!0}(e,t);default:return D()}}function Mn(e,t){return(e.values||[]).find(function(n){return jt(n,t)})!==void 0}function tn(e,t){var n=ce(e),r=ce(t);if(n!==r)return L(n,r);switch(n){case 0:return 0;case 1:return L(e.booleanValue,t.booleanValue);case 2:return function(i,o){var s=X(i.integerValue||i.doubleValue),u=X(o.integerValue||o.doubleValue);return s<u?-1:s>u?1:s===u?0:isNaN(s)?isNaN(u)?0:-1:1}(e,t);case 3:return iu(e.timestampValue,t.timestampValue);case 4:return iu(Vn(e),Vn(t));case 5:return L(e.stringValue,t.stringValue);case 6:return function(i,o){var s=Ze(i),u=Ze(o);return s._(u)}(e.bytesValue,t.bytesValue);case 7:return function(i,o){for(var s=i.split("/"),u=o.split("/"),a=0;a<s.length&&a<u.length;a++){var c=L(s[a],u[a]);if(c!==0)return c}return L(s.length,u.length)}(e.referenceValue,t.referenceValue);case 8:return function(i,o){var s=L(X(i.latitude),X(o.latitude));return s!==0?s:L(X(i.longitude),X(o.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(i,o){for(var s=i.values||[],u=o.values||[],a=0;a<s.length&&a<u.length;++a){var c=tn(s[a],u[a]);if(c)return c}return L(s.length,u.length)}(e.arrayValue,t.arrayValue);case 10:return function(i,o){var s=i.fields||{},u=Object.keys(s),a=o.fields||{},c=Object.keys(a);u.sort(),c.sort();for(var h=0;h<u.length&&h<c.length;++h){var f=L(u[h],c[h]);if(f!==0)return f;var l=tn(s[u[h]],a[c[h]]);if(l!==0)return l}return L(u.length,c.length)}(e.mapValue,t.mapValue);default:throw D()}}function iu(e,t){if(typeof e=="string"&&typeof t=="string"&&e.length===t.length)return L(e,t);var n=ae(e),r=ae(t),i=L(n.seconds,r.seconds);return i!==0?i:L(n.nanos,r.nanos)}function Qo(e){return oo(e)}function oo(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(r){var i=ae(r);return"time("+i.seconds+","+i.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ze(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,x.ft(n).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(r){for(var i="[",o=!0,s=0,u=r.values||[];s<u.length;s++)o?o=!1:i+=",",i+=oo(u[s]);return i+"]"}(e.arrayValue):"mapValue"in e?function(r){for(var i="{",o=!0,s=0,u=Object.keys(r.fields||{}).sort();s<u.length;s++){var a=u[s];o?o=!1:i+=",",i+=a+":"+oo(r.fields[a])}return i+"}"}(e.mapValue):D();var t,n}function jr(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.rt()}}function so(e){return!!e&&"integerValue"in e}function Xo(e){return!!e&&"arrayValue"in e}function ou(e){return!!e&&"nullValue"in e}function su(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Wo(e){return!!e&&"mapValue"in e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var he=function(){function e(t){this.proto=t}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(t){if(t.et())return this.proto;for(var n=this.proto,r=0;r<t.length-1;++r)if(!n.mapValue.fields||!Wo(n=n.mapValue.fields[t.get(r)]))return null;return(n=(n.mapValue.fields||{})[t.tt()])||null},e.prototype.isEqual=function(t){return jt(this.proto,t.proto)},e}(),rr=function(){function e(t){t===void 0&&(t=he.empty()),this.It=t,this.At=new Map}return e.prototype.set=function(t,n){return this.Rt(t,n),this},e.prototype.delete=function(t){return this.Rt(t,null),this},e.prototype.Rt=function(t,n){for(var r=this.At,i=0;i<t.length-1;++i){var o=t.get(i),s=r.get(o);s instanceof Map?r=s:s&&ce(s)===10?(s=new Map(Object.entries(s.mapValue.fields||{})),r.set(o,s),r=s):(s=new Map,r.set(o,s),r=s)}r.set(t.tt(),n)},e.prototype.Pt=function(){var t=this.yt(Mt.ct(),this.At);return t!=null?new he(t):this.It},e.prototype.yt=function(t,n){var r=this,i=!1,o=this.It.field(t),s=Wo(o)?Object.assign({},o.mapValue.fields):{};return n.forEach(function(u,a){if(u instanceof Map){var c=r.yt(t.child(a),u);c!=null&&(s[a]=c,i=!0)}else u!==null?(s[a]=u,i=!0):s.hasOwnProperty(a)&&(delete s[a],i=!0)}),i?{mapValue:{fields:s}}:null},e}();function Tc(e){var t=[];return nr(e.fields||{},function(n,r){var i=new Mt([n]);if(Wo(r)){var o=Tc(r.mapValue).fields;if(o.length===0)t.push(i);else for(var s=0,u=o;s<u.length;s++){var a=u[s];t.push(i.child(a))}}else t.push(i)}),new Je(t)}var Jo=function(e,t){this.key=e,this.version=t},B=function(e){function t(n,r,i,o){var s=this;return(s=e.call(this,n,r)||this).gt=i,s.Vt=!!o.Vt,s.hasCommittedMutations=!!o.hasCommittedMutations,s}return N(t,e),t.prototype.field=function(n){return this.gt.field(n)},t.prototype.data=function(){return this.gt},t.prototype.bt=function(){return this.gt.proto},t.prototype.isEqual=function(n){return n instanceof t&&this.key.isEqual(n.key)&&this.version.isEqual(n.version)&&this.Vt===n.Vt&&this.hasCommittedMutations===n.hasCommittedMutations&&this.gt.isEqual(n.gt)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t}(Jo),rt=function(e){function t(n,r,i){var o=this;return(o=e.call(this,n,r)||this).hasCommittedMutations=!(!i||!i.hasCommittedMutations),o}return N(t,e),t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(n){return n instanceof t&&n.hasCommittedMutations===this.hasCommittedMutations&&n.version.isEqual(this.version)&&n.key.isEqual(this.key)},t}(Jo),Zo=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(n){return n instanceof t&&n.version.isEqual(this.version)&&n.key.isEqual(this.key)},t}(Jo),Ep=function(e,t,n,r,i,o,s){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function uu(e,t,n,r,i,o,s){return t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o=null),s===void 0&&(s=null),new Ep(e,t,n,r,i,o,s)}function ir(e){var t=T(e);if(t.vt===null){var n=t.path.rt();t.collectionGroup!==null&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(r){return function(i){return i.field.rt()+i.op.toString()+Qo(i.value)}(r)}).join(","),n+="|ob:",n+=t.orderBy.map(function(r){return function(i){return i.field.rt()+i.dir}(r)}).join(","),Re(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=zr(t.startAt)),t.endAt&&(n+="|ub:",n+=zr(t.endAt)),t.vt=n}return t.vt}function li(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Op(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],o=t.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!jt(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cu(e.startAt,t.startAt)&&cu(e.endAt,t.endAt)}function qr(e){return x.wt(e.path)&&e.collectionGroup===null&&e.filters.length===0}var Ot=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).field=n,o.op=r,o.value=i,o}return N(t,e),t.create=function(n,r,i){return n.ut()?r==="in"||r==="not-in"?this.St(n,r,i):new _p(n,r,i):r==="array-contains"?new Np(n,i):r==="in"?new Ap(n,i):r==="not-in"?new Sp(n,i):r==="array-contains-any"?new Dp(n,i):new t(n,r,i)},t.St=function(n,r,i){return r==="in"?new Ip(n,i):new Tp(n,i)},t.prototype.matches=function(n){var r=n.field(this.field);return this.op==="!="?r!==null&&this.Dt(tn(r,this.value)):r!==null&&ce(this.value)===ce(r)&&this.Dt(tn(r,this.value))},t.prototype.Dt=function(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return n===0;case"!=":return n!==0;case">":return n>0;case">=":return n>=0;default:return D()}},t.prototype.Ct=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}(function(){}),_p=function(e){function t(n,r,i){var o=this;return(o=e.call(this,n,r,i)||this).key=x.ft(i.referenceValue),o}return N(t,e),t.prototype.matches=function(n){var r=x.H(n.key,this.key);return this.Dt(r)},t}(Ot),Ip=function(e){function t(n,r){var i=this;return(i=e.call(this,n,"in",r)||this).keys=Nc("in",r),i}return N(t,e),t.prototype.matches=function(n){return this.keys.some(function(r){return r.isEqual(n.key)})},t}(Ot),Tp=function(e){function t(n,r){var i=this;return(i=e.call(this,n,"not-in",r)||this).keys=Nc("not-in",r),i}return N(t,e),t.prototype.matches=function(n){return!this.keys.some(function(r){return r.isEqual(n.key)})},t}(Ot);function Nc(e,t){var n;return(((n=t.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(function(r){return x.ft(r.referenceValue)})}var Np=function(e){function t(n,r){return e.call(this,n,"array-contains",r)||this}return N(t,e),t.prototype.matches=function(n){var r=n.field(this.field);return Xo(r)&&Mn(r.arrayValue,this.value)},t}(Ot),Ap=function(e){function t(n,r){return e.call(this,n,"in",r)||this}return N(t,e),t.prototype.matches=function(n){var r=n.field(this.field);return r!==null&&Mn(this.value.arrayValue,r)},t}(Ot),Sp=function(e){function t(n,r){return e.call(this,n,"not-in",r)||this}return N(t,e),t.prototype.matches=function(n){if(Mn(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var r=n.field(this.field);return r!==null&&!Mn(this.value.arrayValue,r)},t}(Ot),Dp=function(e){function t(n,r){return e.call(this,n,"array-contains-any",r)||this}return N(t,e),t.prototype.matches=function(n){var r=this,i=n.field(this.field);return!(!Xo(i)||!i.arrayValue.values)&&i.arrayValue.values.some(function(o){return Mn(r.value.arrayValue,o)})},t}(Ot),Fn=function(e,t){this.position=e,this.before=t};function zr(e){return(e.before?"b":"a")+":"+e.position.map(function(t){return Qo(t)}).join(",")}var Ke=function(e,t){t===void 0&&(t="asc"),this.field=e,this.dir=t};function Op(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function au(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],s=e.position[i];if(r=o.field.ut()?x.H(x.ft(s.referenceValue),n.key):tn(s,n.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return e.before?r<=0:r<0}function cu(e,t){if(e===null)return t===null;if(t===null||e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!jt(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt=function(e,t,n,r,i,o,s,u){t===void 0&&(t=null),n===void 0&&(n=[]),r===void 0&&(r=[]),i===void 0&&(i=null),o===void 0&&(o="F"),s===void 0&&(s=null),u===void 0&&(u=null),this.path=e,this.collectionGroup=t,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Ac(e,t,n,r,i,o,s,u){return new Qt(e,t,n,r,i,o,s,u)}function or(e){return new Qt(e)}function Ir(e){return!Re(e.limit)&&e.limitType==="F"}function Br(e){return!Re(e.limit)&&e.limitType==="L"}function ts(e){return e.xt.length>0?e.xt[0].field:null}function es(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.Ct())return r.field}return null}function ns(e){return e.collectionGroup!==null}function en(e){var t=T(e);if(t.Nt===null){t.Nt=[];var n=es(t),r=ts(t);if(n!==null&&r===null)n.ut()||t.Nt.push(new Ke(n)),t.Nt.push(new Ke(Mt.ht(),"asc"));else{for(var i=!1,o=0,s=t.xt;o<s.length;o++){var u=s[o];t.Nt.push(u),u.field.ut()&&(i=!0)}if(!i){var a=t.xt.length>0?t.xt[t.xt.length-1].dir:"asc";t.Nt.push(new Ke(Mt.ht(),a))}}}return t.Nt}function qt(e){var t=T(e);if(!t.$t)if(t.limitType==="F")t.$t=uu(t.path,t.collectionGroup,en(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=en(t);r<i.length;r++){var o=i[r],s=o.dir==="desc"?"asc":"desc";n.push(new Ke(o.field,s))}var u=t.endAt?new Fn(t.endAt.position,!t.endAt.before):null,a=t.startAt?new Fn(t.startAt.position,!t.startAt.before):null;t.$t=uu(t.path,t.collectionGroup,n,t.filters,t.limit,u,a)}return t.$t}function Sc(e,t,n){return new Qt(e.path,e.collectionGroup,e.xt.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function sr(e,t){return li(qt(e),qt(t))&&e.limitType===t.limitType}function Dc(e){return ir(qt(e))+"|lt:"+e.limitType}function uo(e){return"Query(target="+function(t){var n=t.path.rt();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: ["+t.filters.map(function(r){return(i=r).field.rt()+" "+i.op+" "+Qo(i.value);var i}).join(", ")+"]"),Re(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: ["+t.orderBy.map(function(r){return function(i){return i.field.rt()+" ("+i.dir+")"}(r)}).join(", ")+"]"),t.startAt&&(n+=", startAt: "+zr(t.startAt)),t.endAt&&(n+=", endAt: "+zr(t.endAt)),"Target("+n+")"}(qt(e))+"; limitType="+e.limitType+")"}function ur(e,t){return function(n,r){var i=r.key.path;return n.collectionGroup!==null?r.key.dt(n.collectionGroup)&&n.path.nt(i):x.wt(n.path)?n.path.isEqual(i):n.path.st(i)}(e,t)&&function(n,r){for(var i=0,o=n.xt;i<o.length;i++){var s=o[i];if(!s.field.ut()&&r.field(s.field)===null)return!1}return!0}(e,t)&&function(n,r){for(var i=0,o=n.filters;i<o.length;i++)if(!o[i].matches(r))return!1;return!0}(e,t)&&function(n,r){return!(n.startAt&&!au(n.startAt,en(n),r))&&(!n.endAt||!au(n.endAt,en(n),r))}(e,t)}function Oc(e){return function(t,n){for(var r=!1,i=0,o=en(e);i<o.length;i++){var s=o[i],u=xp(s,t,n);if(u!==0)return u;r=r||s.field.ut()}return 0}}function xp(e,t,n){var r=e.field.ut()?x.H(t.key,n.key):function(i,o,s){var u=o.field(i),a=s.field(i);return u!==null&&a!==null?tn(u,a):D()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return D()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pi=function(){function e(t,n,r,i,o,s,u){o===void 0&&(o=R.min()),s===void 0&&(s=R.min()),u===void 0&&(u=_t.T),this.target=t,this.targetId=n,this.Ft=r,this.sequenceNumber=i,this.Ot=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=u}return e.prototype.kt=function(t){return new e(this.target,this.targetId,this.Ft,t,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.Mt=function(t,n){return new e(this.target,this.targetId,this.Ft,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.Lt=function(t){return new e(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,t,this.resumeToken)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xc(e,t){if(e.Bt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ur(t)?"-0":t}}function Pc(e){return{integerValue:""+e}}function kc(e,t){return Ic(t)?Pc(t):xc(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var di=function(){this.qt=void 0};function Pp(e,t,n){return e instanceof nn?function(r,i){var o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,t):e instanceof Pe?Rc(e,t):e instanceof ke?Lc(e,t):function(r,i){var o=Cc(r,i),s=hu(o)+hu(r.Ut);return so(o)&&so(r.Ut)?Pc(s):xc(r.Qt,s)}(e,t)}function kp(e,t,n){return e instanceof Pe?Rc(e,t):e instanceof ke?Lc(e,t):n}function Cc(e,t){return e instanceof rn?so(n=t)||function(r){return!!r&&"doubleValue"in r}(n)?t:{integerValue:0}:null;var n}var nn=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t}(di),Pe=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return N(t,e),t}(di);function Rc(e,t){for(var n=Vc(t),r=function(s){n.some(function(u){return jt(u,s)})||n.push(s)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ke=function(e){function t(n){var r=this;return(r=e.call(this)||this).elements=n,r}return N(t,e),t}(di);function Lc(e,t){for(var n=Vc(t),r=function(s){n=n.filter(function(u){return!jt(u,s)})},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rn=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).Qt=n,i.Ut=r,i}return N(t,e),t}(di);function hu(e){return X(e.integerValue||e.doubleValue)}function Vc(e){return Xo(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ar=function(e,t){this.field=e,this.transform=t},Cp=function(e,t){this.version=e,this.transformResults=t},ct=function(){function e(t,n){this.updateTime=t,this.exists=n}return e.Kt=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"Wt",{get:function(){return this.updateTime===void 0&&this.exists===void 0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},e}();function Tr(e,t){return e.updateTime!==void 0?t instanceof B&&t.version.isEqual(e.updateTime):e.exists===void 0||e.exists===t instanceof B}var vi=function(){};function Rp(e,t,n){return e instanceof cr?function(r,i,o){var s=r.value;if(o.transformResults){var u=pu(r.fieldTransforms,i,o.transformResults);s=rs(r.fieldTransforms,s,u)}return new B(r.key,o.version,s,{hasCommittedMutations:!0})}(e,t,n):e instanceof ve?function(r,i,o){if(!Tr(r.jt,i))return new Zo(r.key,o.version);var s=Mc(r,i,o.transformResults?pu(r.fieldTransforms,i,o.transformResults):[]);return new B(r.key,o.version,s,{hasCommittedMutations:!0})}(e,t,n):function(r,i,o){return new rt(r.key,o.version,{hasCommittedMutations:!0})}(e,0,n)}function ao(e,t,n){return e instanceof cr?function(r,i,o){if(!Tr(r.jt,i))return i;var s=r.value,u=du(r.fieldTransforms,o,i);s=rs(r.fieldTransforms,s,u);var a=lu(i);return new B(r.key,a,s,{Vt:!0})}(e,t,n):e instanceof ve?function(r,i,o){if(!Tr(r.jt,i))return i;var s=lu(i),u=Mc(r,i,du(r.fieldTransforms,o,i));return new B(r.key,s,u,{Vt:!0})}(e,t,n):function(r,i){return Tr(r.jt,i)?new rt(r.key,R.min()):i}(e,t)}function Lp(e,t){return function(n,r){for(var i=null,o=0,s=n;o<s.length;o++){var u=s[o],a=r instanceof B?r.field(u.field):void 0,c=Cc(u.transform,a||null);c!=null&&(i=i==null?new rr().set(u.field,c):i.set(u.field,c))}return i?i.Pt():null}(e.fieldTransforms,t)}function fu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.jt.isEqual(t.jt)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&We(n,r,function(i,o){return function(s,u){return s.field.isEqual(u.field)&&function(a,c){return a instanceof Pe&&c instanceof Pe||a instanceof ke&&c instanceof ke?We(a.elements,c.elements,jt):a instanceof rn&&c instanceof rn?jt(a.Ut,c.Ut):a instanceof nn&&c instanceof nn}(s.transform,u.transform)}(i,o)})}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.Gt.isEqual(t.Gt))}function lu(e){return e instanceof B?e.version:R.min()}var cr=function(e){function t(n,r,i,o){o===void 0&&(o=[]);var s=this;return(s=e.call(this)||this).key=n,s.value=r,s.jt=i,s.fieldTransforms=o,s.type=0,s}return N(t,e),t}(vi),ve=function(e){function t(n,r,i,o,s){s===void 0&&(s=[]);var u=this;return(u=e.call(this)||this).key=n,u.data=r,u.Gt=i,u.jt=o,u.fieldTransforms=s,u.type=1,u}return N(t,e),t}(vi);function Mc(e,t,n){var r;return r=function(i,o){var s=new rr(o);return i.Gt.fields.forEach(function(u){if(!u.et()){var a=i.data.field(u);a!==null?s.set(u,a):s.delete(u)}}),s.Pt()}(e,r=t instanceof B?t.data():he.empty()),r=rs(e.fieldTransforms,r,n)}function pu(e,t,n){var r=[];P(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],s=o.transform,u=null;t instanceof B&&(u=t.field(o.field)),r.push(kp(s,u,n[i]))}return r}function du(e,t,n){for(var r=[],i=0,o=e;i<o.length;i++){var s=o[i],u=s.transform,a=null;n instanceof B&&(a=n.field(s.field)),r.push(Pp(u,a,t))}return r}function rs(e,t,n){for(var r=new rr(t),i=0;i<e.length;i++){var o=e[i];r.set(o.field,n[i])}return r.Pt()}var Q,F,hr=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).key=n,i.jt=r,i.type=2,i.fieldTransforms=[],i}return N(t,e),t}(vi),is=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).key=n,i.jt=r,i.type=3,i.fieldTransforms=[],i}return N(t,e),t}(vi),Vp=function(e){this.count=e};function Fc(e){switch(e){case y.OK:return D();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0;default:return D()}}function Uc(e){if(e===void 0)return W("GRPC error has no .code"),y.UNKNOWN;switch(e){case Q.OK:return y.OK;case Q.CANCELLED:return y.CANCELLED;case Q.UNKNOWN:return y.UNKNOWN;case Q.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case Q.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case Q.INTERNAL:return y.INTERNAL;case Q.UNAVAILABLE:return y.UNAVAILABLE;case Q.UNAUTHENTICATED:return y.UNAUTHENTICATED;case Q.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case Q.NOT_FOUND:return y.NOT_FOUND;case Q.ALREADY_EXISTS:return y.ALREADY_EXISTS;case Q.PERMISSION_DENIED:return y.PERMISSION_DENIED;case Q.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case Q.ABORTED:return y.ABORTED;case Q.OUT_OF_RANGE:return y.OUT_OF_RANGE;case Q.UNIMPLEMENTED:return y.UNIMPLEMENTED;case Q.DATA_LOSS:return y.DATA_LOSS;default:return D()}}(F=Q||(Q={}))[F.OK=0]="OK",F[F.CANCELLED=1]="CANCELLED",F[F.UNKNOWN=2]="UNKNOWN",F[F.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",F[F.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",F[F.NOT_FOUND=5]="NOT_FOUND",F[F.ALREADY_EXISTS=6]="ALREADY_EXISTS",F[F.PERMISSION_DENIED=7]="PERMISSION_DENIED",F[F.UNAUTHENTICATED=16]="UNAUTHENTICATED",F[F.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",F[F.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",F[F.ABORTED=10]="ABORTED",F[F.OUT_OF_RANGE=11]="OUT_OF_RANGE",F[F.UNIMPLEMENTED=12]="UNIMPLEMENTED",F[F.INTERNAL=13]="INTERNAL",F[F.UNAVAILABLE=14]="UNAVAILABLE",F[F.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt=function(){function e(t,n){this.H=t,this.root=n||te.EMPTY}return e.prototype.zt=function(t,n){return new e(this.H,this.root.zt(t,n,this.H).copy(null,null,te.Ht,null,null))},e.prototype.remove=function(t){return new e(this.H,this.root.remove(t,this.H).copy(null,null,te.Ht,null,null))},e.prototype.get=function(t){for(var n=this.root;!n.et();){var r=this.H(t,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null},e.prototype.indexOf=function(t){for(var n=0,r=this.root;!r.et();){var i=this.H(t,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},e.prototype.et=function(){return this.root.et()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.Jt=function(){return this.root.Jt()},e.prototype.Yt=function(){return this.root.Yt()},e.prototype.Xt=function(t){return this.root.Xt(t)},e.prototype.forEach=function(t){this.Xt(function(n,r){return t(n,r),!1})},e.prototype.toString=function(){var t=[];return this.Xt(function(n,r){return t.push(n+":"+r),!1}),"{"+t.join(", ")+"}"},e.prototype.Zt=function(t){return this.root.Zt(t)},e.prototype.te=function(){return new gr(this.root,null,this.H,!1)},e.prototype.ee=function(t){return new gr(this.root,t,this.H,!1)},e.prototype.ne=function(){return new gr(this.root,null,this.H,!0)},e.prototype.se=function(t){return new gr(this.root,t,this.H,!0)},e}(),gr=function(){function e(t,n,r,i){this.ie=i,this.re=[];for(var o=1;!t.et();)if(o=n?r(t.key,n):1,i&&(o*=-1),o<0)t=this.ie?t.left:t.right;else{if(o===0){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}return e.prototype.oe=function(){var t=this.re.pop(),n={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return n},e.prototype.ce=function(){return this.re.length>0},e.prototype.ae=function(){if(this.re.length===0)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},e}(),te=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=r!=null?r:e.RED,this.left=i!=null?i:e.EMPTY,this.right=o!=null?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(t!=null?t:this.key,n!=null?n:this.value,r!=null?r:this.color,i!=null?i:this.left,o!=null?o:this.right)},e.prototype.et=function(){return!1},e.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},e.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},e.prototype.min=function(){return this.left.et()?this:this.left.min()},e.prototype.Jt=function(){return this.min().key},e.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},e.prototype.zt=function(t,n,r){var i=this,o=r(t,i.key);return(i=o<0?i.copy(null,null,null,i.left.zt(t,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.zt(t,n,r))).ue()},e.prototype.he=function(){if(this.left.et())return e.EMPTY;var t=this;return t.left.le()||t.left.left.le()||(t=t._e()),(t=t.copy(null,null,null,t.left.he(),null)).ue()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.et()||i.left.le()||i.left.left.le()||(i=i._e()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.le()&&(i=i.fe()),i.right.et()||i.right.le()||i.right.left.le()||(i=i.de()),n(t,i.key)===0){if(i.right.et())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.he())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.ue()},e.prototype.le=function(){return this.color},e.prototype.ue=function(){var t=this;return t.right.le()&&!t.left.le()&&(t=t.we()),t.left.le()&&t.left.left.le()&&(t=t.fe()),t.left.le()&&t.right.le()&&(t=t.Ee()),t},e.prototype._e=function(){var t=this.Ee();return t.right.left.le()&&(t=(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee()),t},e.prototype.de=function(){var t=this.Ee();return t.left.left.le()&&(t=(t=t.fe()).Ee()),t},e.prototype.we=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.fe=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)},e.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},e.prototype.Ie=function(){if(this.le()&&this.left.le()||this.right.le())throw D();var t=this.left.Ie();if(t!==this.right.Ie())throw D();return t+(this.le()?0:1)},e}();te.EMPTY=null,te.RED=!0,te.Ht=!1,te.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw D()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw D()},enumerable:!1,configurable:!0}),e.prototype.copy=function(t,n,r,i,o){return this},e.prototype.zt=function(t,n,r){return new te(t,n)},e.prototype.remove=function(t,n){return this},e.prototype.et=function(){return!0},e.prototype.Xt=function(t){return!1},e.prototype.Zt=function(t){return!1},e.prototype.Jt=function(){return null},e.prototype.Yt=function(){return null},e.prototype.le=function(){return!1},e.prototype.Te=function(){return!0},e.prototype.Ie=function(){return 0},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt=function(){function e(t){this.H=t,this.data=new lt(this.H)}return e.prototype.has=function(t){return this.data.get(t)!==null},e.prototype.first=function(){return this.data.Jt()},e.prototype.last=function(){return this.data.Yt()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(t){return this.data.indexOf(t)},e.prototype.forEach=function(t){this.data.Xt(function(n,r){return t(n),!1})},e.prototype.me=function(t,n){for(var r=this.data.ee(t[0]);r.ce();){var i=r.oe();if(this.H(i.key,t[1])>=0)return;n(i.key)}},e.prototype.Ae=function(t,n){var r;for(r=n!==void 0?this.data.ee(n):this.data.te();r.ce();)if(!t(r.oe().key))return},e.prototype.Re=function(t){var n=this.data.ee(t);return n.ce()?n.oe().key:null},e.prototype.te=function(){return new vu(this.data.te())},e.prototype.ee=function(t){return new vu(this.data.ee(t))},e.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},e.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},e.prototype.et=function(){return this.data.et()},e.prototype.Pe=function(t){var n=this;return n.size<t.size&&(n=t,t=this),t.forEach(function(r){n=n.add(r)}),n},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.te(),r=t.data.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(this.H(i,o)!==0)return!1}return!0},e.prototype.it=function(){var t=[];return this.forEach(function(n){t.push(n)}),t},e.prototype.toString=function(){var t=[];return this.forEach(function(n){return t.push(n)}),"SortedSet("+t.toString()+")"},e.prototype.copy=function(t){var n=new e(this.H);return n.data=t,n},e}(),vu=function(){function e(t){this.ye=t}return e.prototype.oe=function(){return this.ye.oe().key},e.prototype.ce=function(){return this.ye.ce()},e}(),Mp=new lt(x.H);function fe(){return Mp}function Gr(){return fe()}var Fp=new lt(x.H);function Un(){return Fp}var Up=new lt(x.H);function jp(){return Up}var qp=new tt(x.H);function G(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=qp,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var zp=new tt(L);function yi(){return zp}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jc=function(){function e(t){this.H=t?function(n,r){return t(n,r)||x.H(n.key,r.key)}:function(n,r){return x.H(n.key,r.key)},this.ge=Un(),this.Ve=new lt(this.H)}return e.pe=function(t){return new e(t.H)},e.prototype.has=function(t){return this.ge.get(t)!=null},e.prototype.get=function(t){return this.ge.get(t)},e.prototype.first=function(){return this.Ve.Jt()},e.prototype.last=function(){return this.Ve.Yt()},e.prototype.et=function(){return this.Ve.et()},e.prototype.indexOf=function(t){var n=this.ge.get(t);return n?this.Ve.indexOf(n):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t){this.Ve.Xt(function(n,r){return t(n),!1})},e.prototype.add=function(t){var n=this.delete(t.key);return n.copy(n.ge.zt(t.key,t),n.Ve.zt(t,null))},e.prototype.delete=function(t){var n=this.get(t);return n?this.copy(this.ge.remove(t),this.Ve.remove(n)):this},e.prototype.isEqual=function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.Ve.te(),r=t.Ve.te();n.ce();){var i=n.oe().key,o=r.oe().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var t=[];return this.forEach(function(n){t.push(n.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`},e.prototype.copy=function(t,n){var r=new e;return r.H=this.H,r.ge=t,r.Ve=n,r},e}(),yu=function(){function e(){this.be=new lt(x.H)}return e.prototype.track=function(t){var n=t.doc.key,r=this.be.get(n);r?t.type!==0&&r.type===3?this.be=this.be.zt(n,t):t.type===3&&r.type!==1?this.be=this.be.zt(n,{type:r.type,doc:t.doc}):t.type===2&&r.type===2?this.be=this.be.zt(n,{type:2,doc:t.doc}):t.type===2&&r.type===0?this.be=this.be.zt(n,{type:0,doc:t.doc}):t.type===1&&r.type===0?this.be=this.be.remove(n):t.type===1&&r.type===2?this.be=this.be.zt(n,{type:1,doc:r.doc}):t.type===0&&r.type===1?this.be=this.be.zt(n,{type:2,doc:t.doc}):D():this.be=this.be.zt(n,t)},e.prototype.ve=function(){var t=[];return this.be.Xt(function(n,r){t.push(r)}),t},e}(),Hr=function(){function e(t,n,r,i,o,s,u,a){this.query=t,this.docs=n,this.Se=r,this.docChanges=i,this.De=o,this.fromCache=s,this.Ce=u,this.xe=a}return e.Ne=function(t,n,r,i){var o=[];return n.forEach(function(s){o.push({type:0,doc:s})}),new e(t,n,jc.pe(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&sr(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var n=this.docChanges,r=t.docChanges;if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0},e}(),os=function(){function e(t,n,r,i,o){this.Ot=t,this.$e=n,this.Fe=r,this.Oe=i,this.ke=o}return e.Me=function(t,n){var r=new Map;return r.set(t,ss.Le(t,n)),new e(R.min(),r,yi(),fe(),G())},e}(),ss=function(){function e(t,n,r,i,o){this.resumeToken=t,this.Be=n,this.qe=r,this.Ue=i,this.Qe=o}return e.Le=function(t,n){return new e(_t.T,n,G(),G(),G())},e}(),Nr=function(e,t,n,r){this.Ke=e,this.removedTargetIds=t,this.key=n,this.We=r},qc=function(e,t){this.targetId=e,this.je=t},zc=function(e,t,n,r){n===void 0&&(n=_t.T),r===void 0&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},gu=function(){function e(){this.Ge=0,this.ze=wu(),this.He=_t.T,this.Je=!1,this.Ye=!0}return Object.defineProperty(e.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Xe",{get:function(){return this.Ge!==0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),e.prototype.tn=function(t){t.l()>0&&(this.Ye=!0,this.He=t)},e.prototype.en=function(){var t=G(),n=G(),r=G();return this.ze.forEach(function(i,o){switch(o){case 0:t=t.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:D()}}),new ss(this.He,this.Je,t,n,r)},e.prototype.nn=function(){this.Ye=!1,this.ze=wu()},e.prototype.sn=function(t,n){this.Ye=!0,this.ze=this.ze.zt(t,n)},e.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},e.prototype.on=function(){this.Ge+=1},e.prototype.cn=function(){this.Ge-=1},e.prototype.an=function(){this.Ye=!0,this.Je=!0},e}(),Bp=function(){function e(t){this.un=t,this.hn=new Map,this.ln=fe(),this._n=mu(),this.fn=new tt(L)}return e.prototype.dn=function(t){for(var n=0,r=t.Ke;n<r.length;n++){var i=r[n];t.We instanceof B?this.wn(i,t.We):t.We instanceof rt&&this.En(i,t.key,t.We)}for(var o=0,s=t.removedTargetIds;o<s.length;o++)i=s[o],this.En(i,t.key,t.We)},e.prototype.Tn=function(t){var n=this;this.In(t,function(r){var i=n.mn(r);switch(t.state){case 0:n.An(r)&&i.tn(t.resumeToken);break;case 1:i.cn(),i.Xe||i.nn(),i.tn(t.resumeToken);break;case 2:i.cn(),i.Xe||n.removeTarget(r);break;case 3:n.An(r)&&(i.an(),i.tn(t.resumeToken));break;case 4:n.An(r)&&(n.Rn(r),i.tn(t.resumeToken));break;default:D()}})},e.prototype.In=function(t,n){var r=this;t.targetIds.length>0?t.targetIds.forEach(n):this.hn.forEach(function(i,o){r.An(o)&&n(o)})},e.prototype.Pn=function(t){var n=t.targetId,r=t.je.count,i=this.yn(n);if(i){var o=i.target;if(qr(o))if(r===0){var s=new x(o.path);this.En(n,s,new rt(s,R.min()))}else P(r===1);else this.gn(n)!==r&&(this.Rn(n),this.fn=this.fn.add(n))}},e.prototype.Vn=function(t){var n=this,r=new Map;this.hn.forEach(function(s,u){var a=n.yn(u);if(a){if(s.Be&&qr(a.target)){var c=new x(a.target.path);n.ln.get(c)!==null||n.pn(u,c)||n.En(u,c,new rt(c,t))}s.Ze&&(r.set(u,s.en()),s.nn())}});var i=G();this._n.forEach(function(s,u){var a=!0;u.Ae(function(c){var h=n.yn(c);return!h||h.Ft===2||(a=!1,!1)}),a&&(i=i.add(s))});var o=new os(t,r,this.fn,this.ln,i);return this.ln=fe(),this._n=mu(),this.fn=new tt(L),o},e.prototype.wn=function(t,n){if(this.An(t)){var r=this.pn(t,n.key)?2:0;this.mn(t).sn(n.key,r),this.ln=this.ln.zt(n.key,n),this._n=this._n.zt(n.key,this.bn(n.key).add(t))}},e.prototype.En=function(t,n,r){if(this.An(t)){var i=this.mn(t);this.pn(t,n)?i.sn(n,1):i.rn(n),this._n=this._n.zt(n,this.bn(n).delete(t)),r&&(this.ln=this.ln.zt(n,r))}},e.prototype.removeTarget=function(t){this.hn.delete(t)},e.prototype.gn=function(t){var n=this.mn(t).en();return this.un.vn(t).size+n.qe.size-n.Qe.size},e.prototype.on=function(t){this.mn(t).on()},e.prototype.mn=function(t){var n=this.hn.get(t);return n||(n=new gu,this.hn.set(t,n)),n},e.prototype.bn=function(t){var n=this._n.get(t);return n||(n=new tt(L),this._n=this._n.zt(t,n)),n},e.prototype.An=function(t){var n=this.yn(t)!==null;return n||I("WatchChangeAggregator","Detected inactive target",t),n},e.prototype.yn=function(t){var n=this.hn.get(t);return n&&n.Xe?null:this.un.Sn(t)},e.prototype.Rn=function(t){var n=this;this.hn.set(t,new gu),this.un.vn(t).forEach(function(r){n.En(t,r,null)})},e.prototype.pn=function(t,n){return this.un.vn(t).has(n)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(){return new lt(x.H)}function wu(){return new lt(x.H)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gp={asc:"ASCENDING",desc:"DESCENDING"},Hp={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$p=function(e,t){this.t=e,this.Bt=t};function jn(e,t){return e.Bt?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function Bc(e,t){return e.Bt?t.toBase64():t.toUint8Array()}function Yp(e,t){return jn(e,t.j())}function mt(e){return P(!!e),R.K(function(t){var n=ae(t);return new Et(n.seconds,n.nanos)}(e))}function us(e,t){return function(n){return new q(["projects",n.projectId,"databases",n.database])}(e).child("documents").child(t).rt()}function Gc(e){var t=q.ot(e);return P(Wc(t)),t}function qn(e,t){return us(e.t,t.path)}function Gt(e,t){var n=Gc(t);if(n.get(1)!==e.t.projectId)throw new b(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.t.projectId);if(n.get(3)!==e.t.database)throw new b(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.t.database);return new x($c(n))}function co(e,t){return us(e.t,t)}function Hc(e){var t=Gc(e);return t.length===4?q.ct():$c(t)}function zn(e){return new q(["projects",e.t.projectId,"databases",e.t.database]).rt()}function $c(e){return P(e.length>4&&e.get(4)==="documents"),e.Y(5)}function bu(e,t,n){return{name:qn(e,t),fields:n.proto.mapValue.fields}}function Kp(e,t,n){var r=Gt(e,t.name),i=mt(t.updateTime),o=new he({mapValue:{fields:t.fields}});return new B(r,i,o,{hasCommittedMutations:!!n})}function $r(e,t){var n;if(t instanceof cr)n={update:bu(e,t.key,t.value)};else if(t instanceof hr)n={delete:qn(e,t.key)};else if(t instanceof ve)n={update:bu(e,t.key,t.data),updateMask:Zp(t.Gt)};else{if(!(t instanceof is))return D();n={verify:qn(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(r){return function(i,o){var s=o.transform;if(s instanceof nn)return{fieldPath:o.field.rt(),setToServerValue:"REQUEST_TIME"};if(s instanceof Pe)return{fieldPath:o.field.rt(),appendMissingElements:{values:s.elements}};if(s instanceof ke)return{fieldPath:o.field.rt(),removeAllFromArray:{values:s.elements}};if(s instanceof rn)return{fieldPath:o.field.rt(),increment:s.Ut};throw D()}(0,r)})),t.jt.Wt||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:Yp(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:D()}(e,t.jt)),n}function Eu(e,t){var n=t.currentDocument?function(c){return c.updateTime!==void 0?ct.updateTime(mt(c.updateTime)):c.exists!==void 0?ct.exists(c.exists):ct.Kt()}(t.currentDocument):ct.Kt(),r=t.updateTransforms?t.updateTransforms.map(function(c){return function(h,f){var l=null;if("setToServerValue"in f)P(f.setToServerValue==="REQUEST_TIME"),l=new nn;else if("appendMissingElements"in f){var p=f.appendMissingElements.values||[];l=new Pe(p)}else if("removeAllFromArray"in f){var d=f.removeAllFromArray.values||[];l=new ke(d)}else"increment"in f?l=new rn(h,f.increment):D();var v=Mt.lt(f.fieldPath);return new ar(v,l)}(e,c)}):[];if(t.update){t.update.name;var i=Gt(e,t.update.name),o=new he({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=function(c){var h=c.fieldPaths||[];return new Je(h.map(function(f){return Mt.lt(f)}))}(t.updateMask);return new ve(i,o,s,n,r)}return new cr(i,o,n,r)}if(t.delete){var u=Gt(e,t.delete);return new hr(u,n)}if(t.verify){var a=Gt(e,t.verify);return new is(a,n)}return D()}function Yc(e,t){return{documents:[co(e,t.path)]}}function Kc(e,t){var n={structuredQuery:{}},r=t.path;t.collectionGroup!==null?(n.parent=co(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=co(e,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]);var i=function(u){if(u.length!==0){var a=u.map(function(c){return function(h){if(h.op==="=="){if(su(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NAN"}};if(ou(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(su(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NOT_NAN"}};if(ou(h.value))return{unaryFilter:{field:je(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:je(h.field),op:Xp(h.op),value:h.value}}}(c)});return a.length===1?a[0]:{compositeFilter:{op:"AND",filters:a}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(u){if(u.length!==0)return u.map(function(a){return function(c){return{field:je(c.field),direction:Qp(c.dir)}}(a)})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(u,a){return u.Bt||Re(a)?a:{value:a}}(e,t.limit);return s!==null&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=_u(t.startAt)),t.endAt&&(n.structuredQuery.endAt=_u(t.endAt)),n}function Qc(e){var t=Hc(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){P(r===1);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var s=[];n.where&&(s=Xc(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(f){return function(l){return new Ke($e(l.field),function(p){switch(p){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(l.direction))}(f)}));var a=null;n.limit&&(a=function(f){var l;return Re(l=typeof f=="object"?f.value:f)?null:l}(n.limit));var c=null;n.startAt&&(c=Iu(n.startAt));var h=null;return n.endAt&&(h=Iu(n.endAt)),Ac(t,i,u,s,a,"F",c,h)}function Xc(e){return e?e.unaryFilter!==void 0?[Jp(e)]:e.fieldFilter!==void 0?[Wp(e)]:e.compositeFilter!==void 0?e.compositeFilter.filters.map(function(t){return Xc(t)}).reduce(function(t,n){return t.concat(n)}):D():[]}function _u(e){return{before:e.before,values:e.position}}function Iu(e){var t=!!e.before,n=e.values||[];return new Fn(n,t)}function Qp(e){return Gp[e]}function Xp(e){return Hp[e]}function je(e){return{fieldPath:e.rt()}}function $e(e){return Mt.lt(e.fieldPath)}function Wp(e){return Ot.create($e(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return D()}}(e.fieldFilter.op),e.fieldFilter.value)}function Jp(e){switch(e.unaryFilter.op){case"IS_NAN":var t=$e(e.unaryFilter.field);return Ot.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=$e(e.unaryFilter.field);return Ot.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=$e(e.unaryFilter.field);return Ot.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=$e(e.unaryFilter.field);return Ot.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return D()}}function Zp(e){var t=[];return e.fields.forEach(function(n){return t.push(n.rt())}),{fieldPaths:t}}function Wc(e){return e.length>=4&&e.get(0)==="projects"&&e.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct=function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},E=function(){function e(t){var n=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(r){n.xn=!0,n.result=r,n.Dn&&n.Dn(r)},function(r){n.xn=!0,n.error=r,n.Cn&&n.Cn(r)})}return e.prototype.catch=function(t){return this.next(void 0,t)},e.prototype.next=function(t,n){var r=this;return this.Nn&&D(),this.Nn=!0,this.xn?this.error?this.$n(n,this.error):this.Fn(t,this.result):new e(function(i,o){r.Dn=function(s){r.Fn(t,s).next(i,o)},r.Cn=function(s){r.$n(n,s).next(i,o)}})},e.prototype.On=function(){var t=this;return new Promise(function(n,r){t.next(n,r)})},e.prototype.kn=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(r){return e.reject(r)}},e.prototype.Fn=function(t,n){return t?this.kn(function(){return t(n)}):e.resolve(n)},e.prototype.$n=function(t,n){return t?this.kn(function(){return t(n)}):e.reject(n)},e.resolve=function(t){return new e(function(n,r){n(t)})},e.reject=function(t){return new e(function(n,r){r(t)})},e.Mn=function(t){return new e(function(n,r){var i=0,o=0,s=!1;t.forEach(function(u){++i,u.next(function(){++o,s&&o===i&&n()},function(a){return r(a)})}),s=!0,o===i&&n()})},e.Ln=function(t){for(var n=e.resolve(!1),r=function(s){n=n.next(function(u){return u?e.resolve(u):s()})},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(t,n){var r=this,i=[];return t.forEach(function(o,s){i.push(n.call(r,o,s))}),this.Mn(i)},e}(),Jc=function(){function e(t,n){var r=this;this.action=t,this.transaction=n,this.aborted=!1,this.Bn=new Ct,this.transaction.oncomplete=function(){r.Bn.resolve()},this.transaction.onabort=function(){n.error?r.Bn.reject(new Dn(t,n.error)):r.Bn.resolve()},this.transaction.onerror=function(i){var o=as(i.target.error);r.Bn.reject(new Dn(t,o))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(o){throw new Dn(n,o)}},Object.defineProperty(e.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(I("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(t){var n=this.transaction.objectStore(t);return new ed(n)},e}(),on=function(){function e(t,n,r){this.name=t,this.version=n,this.Un=r,e.Qn(Se())===12.2&&W("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e.delete=function(t){return I("SimpleDb","Removing database:",t),be(window.indexedDB.deleteDatabase(t)).On()},e.Kn=function(){if(typeof indexedDB=="undefined")return!1;if(e.Wn())return!0;var t=Se(),n=e.Qn(t),r=0<n&&n<10,i=e.jn(t),o=0<i&&i<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||r||o)},e.Wn=function(){var t;return typeof process!="undefined"&&((t=process.env)===null||t===void 0?void 0:t.Gn)==="YES"},e.zn=function(t,n){return t.store(n)},e.Qn=function(t){var n=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)},e.jn=function(t){var n=t.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)},e.prototype.Hn=function(t){return m(this,void 0,void 0,function(){var n,r=this;return g(this,function(i){switch(i.label){case 0:return this.db?[3,2]:(I("SimpleDb","Opening database:",this.name),n=this,[4,new Promise(function(o,s){var u=indexedDB.open(r.name,r.version);u.onsuccess=function(a){var c=a.target.result;o(c)},u.onblocked=function(){s(new Dn(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},u.onerror=function(a){var c=a.target.error;c.name==="VersionError"?s(new b(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s(new Dn(t,c))},u.onupgradeneeded=function(a){I("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',a.oldVersion);var c=a.target.result;r.Un.Jn(c,u.transaction,a.oldVersion,r.version).next(function(){I("SimpleDb","Database upgrade to version "+r.version+" complete")})}})]);case 1:n.db=i.sent(),i.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(o){return r.Yn(o)}),this.db)]}})})},e.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(n){return t(n)})},e.prototype.runTransaction=function(t,n,r,i){return m(this,void 0,void 0,function(){var o,s,u,a,c;return g(this,function(h){switch(h.label){case 0:o=n==="readonly",s=0,u=function(){var f,l,p,d,v;return g(this,function(w){switch(w.label){case 0:++s,w.label=1;case 1:return w.trys.push([1,4,,5]),[4,a.Hn(t)];case 2:return a.db=w.sent(),f=Jc.open(a.db,t,o?"readonly":"readwrite",r),l=i(f).catch(function(_){return f.abort(_),E.reject(_)}).On(),p={},l.catch(function(){}),[4,f.qn];case 3:return[2,(p.value=(w.sent(),l),p)];case 4:return d=w.sent(),v=d.name!=="FirebaseError"&&s<3,I("SimpleDb","Transaction failed with error:",d.message,"Retrying:",v),a.close(),v?[3,5]:[2,{value:Promise.reject(d)}];case 5:return[2]}})},a=this,h.label=1;case 1:return[5,u()];case 2:if(typeof(c=h.sent())=="object")return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}})})},e.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},e}(),td=function(){function e(t){this.Zn=t,this.ts=!1,this.es=null}return Object.defineProperty(e.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.ts=!0},e.prototype.ss=function(t){this.es=t},e.prototype.delete=function(){return be(this.Zn.delete())},e}(),Dn=function(e){function t(n,r){var i=this;return(i=e.call(this,y.UNAVAILABLE,"IndexedDB transaction '"+n+"' failed: "+r)||this).name="IndexedDbTransactionError",i}return N(t,e),t}(b);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(e){return e.name==="IndexedDbTransactionError"}var ed=function(){function e(t){this.store=t}return e.prototype.put=function(t,n){var r;return n!==void 0?(I("SimpleDb","PUT",this.store.name,t,n),r=this.store.put(n,t)):(I("SimpleDb","PUT",this.store.name,"<auto-key>",t),r=this.store.put(t)),be(r)},e.prototype.add=function(t){return I("SimpleDb","ADD",this.store.name,t,t),be(this.store.add(t))},e.prototype.get=function(t){var n=this;return be(this.store.get(t)).next(function(r){return r===void 0&&(r=null),I("SimpleDb","GET",n.store.name,t,r),r})},e.prototype.delete=function(t){return I("SimpleDb","DELETE",this.store.name,t),be(this.store.delete(t))},e.prototype.count=function(){return I("SimpleDb","COUNT",this.store.name),be(this.store.count())},e.prototype.rs=function(t,n){var r=this.cursor(this.options(t,n)),i=[];return this.os(r,function(o,s){i.push(s)}).next(function(){return i})},e.prototype.cs=function(t,n){I("SimpleDb","DELETE ALL",this.store.name);var r=this.options(t,n);r.us=!1;var i=this.cursor(r);return this.os(i,function(o,s,u){return u.delete()})},e.prototype.hs=function(t,n){var r;n?r=t:(r={},n=t);var i=this.cursor(r);return this.os(i,n)},e.prototype.ls=function(t){var n=this.cursor({});return new E(function(r,i){n.onerror=function(o){var s=as(o.target.error);i(s)},n.onsuccess=function(o){var s=o.target.result;s?t(s.primaryKey,s.value).next(function(u){u?s.continue():r()}):r()}})},e.prototype.os=function(t,n){var r=[];return new E(function(i,o){t.onerror=function(s){o(s.target.error)},t.onsuccess=function(s){var u=s.target.result;if(u){var a=new td(u),c=n(u.primaryKey,u.value,a);if(c instanceof E){var h=c.catch(function(f){return a.done(),E.reject(f)});r.push(h)}a.xn?i():a.ns===null?u.continue():u.continue(a.ns)}else i()}}).next(function(){return E.Mn(r)})},e.prototype.options=function(t,n){var r;return t!==void 0&&(typeof t=="string"?r=t:n=t),{index:r,range:n}},e.prototype.cursor=function(t){var n="next";if(t.reverse&&(n="prev"),t.index){var r=this.store.index(t.index);return t.us?r.openKeyCursor(t.range,n):r.openCursor(t.range,n)}return this.store.openCursor(t.range,n)},e}();function be(e){return new E(function(t,n){e.onsuccess=function(r){var i=r.target.result;t(i)},e.onerror=function(r){var i=as(r.target.error);n(i)}})}var Tu=!1;function as(e){var t=on.Qn(Se());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new b("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Tu||(Tu=!0,setTimeout(function(){throw r},0)),r}}return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nd=function(){function e(t,n,r,i,o){this._s=t,this.fs=n,this.ds=r,this.op=i,this.ws=o,this.Es=new Ct,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(s){})}return e.Ts=function(t,n,r,i,o){var s=new e(t,n,Date.now()+r,i,o);return s.start(r),s},e.prototype.start=function(t){var n=this;this.Is=setTimeout(function(){return n.As()},t)},e.prototype.Rs=function(){return this.As()},e.prototype.cancel=function(t){this.Is!==null&&(this.clearTimeout(),this.Es.reject(new b(y.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},e.prototype.As=function(){var t=this;this._s.Ps(function(){return t.Is!==null?(t.clearTimeout(),t.op().then(function(n){return t.Es.resolve(n)})):Promise.resolve()})},e.prototype.clearTimeout=function(){this.Is!==null&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},e}();function gn(e,t){if(W("AsyncQueue",t+": "+e),Le(e))return new b(y.UNAVAILABLE,t+": "+e);throw e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",th=function(){function e(){this.ys=[]}return e.prototype.gs=function(t){this.ys.push(t)},e.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=Nu(t)),t=rd(e.get(n),t);return Nu(t)}function rd(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Nu(e){return e+""}function Bt(e){var t=e.length;if(P(t>=2),t===2)return P(e.charAt(0)===""&&e.charAt(1)===""),q.ct();for(var n=t-2,r=[],i="",o=0;o<t;){var s=e.indexOf("",o);switch((s<0||s>n)&&D(),e.charAt(s+1)){case"":var u=e.substring(o,s),a=void 0;i.length===0?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=e.substring(o,s),i+="\0";break;case"":i+=e.substring(o,s+1);break;default:D()}o=s+2}return new q(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var id=function(e,t){this.seconds=e,this.nanoseconds=t},Tt=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};Tt.store="owner",Tt.key="owner";var oe=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};oe.store="mutationQueues",oe.keyPath="userId";var H=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};H.store="mutations",H.keyPath="batchId",H.userMutationsIndex="userMutationsIndex",H.userMutationsKeyPath=["userId","batchId"];var st=function(){function e(){}return e.prefixForUser=function(t){return[t]},e.prefixForPath=function(t,n){return[t,Vt(n)]},e.key=function(t,n,r){return[t,Vt(n),r]},e}();st.store="documentMutations",st.PLACEHOLDER=new st;var od=function(e,t){this.path=e,this.readTime=t},sd=function(e,t){this.path=e,this.version=t},K=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};K.store="remoteDocuments",K.readTimeIndex="readTimeIndex",K.readTimeIndexPath="readTime",K.collectionReadTimeIndex="collectionReadTimeIndex",K.collectionReadTimeIndexPath=["parentPath","readTime"];var Ut=function(e){this.byteSize=e};Ut.store="remoteDocumentGlobal",Ut.key="remoteDocumentGlobalKey";var bt=function(e,t,n,r,i,o,s){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};bt.store="targets",bt.keyPath="targetId",bt.queryTargetsIndexName="queryTargetsIndex",bt.queryTargetsKeyPath=["canonicalId","targetId"];var it=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};it.store="targetDocuments",it.keyPath=["targetId","path"],it.documentTargetsIndex="documentTargetsIndex",it.documentTargetsKeyPath=["path","targetId"];var At=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};At.key="targetGlobalKey",At.store="targetGlobal";var Te=function(e,t){this.collectionId=e,this.parent=t};Te.store="collectionParents",Te.keyPath=["collectionId","parent"];var Ht=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Ht.store="clientMetadata",Ht.keyPath="clientId";var sn=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};sn.store="bundles",sn.keyPath="bundleId";var un=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};un.store="namedQueries",un.keyPath="name";var ud=at(at(at(at([oe.store,H.store,st.store,K.store,bt.store,Tt.store,At.store,it.store],[Ht.store]),[Ut.store]),[Te.store]),[sn.store,un.store]),Au=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).ps=n,i.bs=r,i}return N(t,e),t}(th);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(e,t){var n=T(e);return on.zn(n.ps,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cs=function(){function e(t,n,r,i){this.batchId=t,this.vs=n,this.baseMutations=r,this.mutations=i}return e.prototype.Ss=function(t,n,r){for(var i=r.Ds,o=0;o<this.mutations.length;o++){var s=this.mutations[o];s.key.isEqual(t)&&(n=Rp(s,n,i[o]))}return n},e.prototype.Cs=function(t,n){for(var r=0,i=this.baseMutations;r<i.length;r++)(u=i[r]).key.isEqual(t)&&(n=ao(u,n,this.vs));for(var o=0,s=this.mutations;o<s.length;o++){var u;(u=s[o]).key.isEqual(t)&&(n=ao(u,n,this.vs))}return n},e.prototype.xs=function(t){var n=this,r=t;return this.mutations.forEach(function(i){var o=n.Cs(i.key,t.get(i.key));o&&(r=r.zt(i.key,o))}),r},e.prototype.keys=function(){return this.mutations.reduce(function(t,n){return t.add(n.key)},G())},e.prototype.isEqual=function(t){return this.batchId===t.batchId&&We(this.mutations,t.mutations,function(n,r){return fu(n,r)})&&We(this.baseMutations,t.baseMutations,function(n,r){return fu(n,r)})},e}(),ad=function(){function e(t,n,r,i){this.batch=t,this.Ns=n,this.Ds=r,this.$s=i}return e.from=function(t,n,r){P(t.mutations.length===r.length);for(var i=jp(),o=t.mutations,s=0;s<o.length;s++)i=i.zt(o[s].key,r[s].version);return new e(t,n,r,i)},e}(),eh=function(e){this.Fs=e};function ho(e,t){if(t.document)return Kp(e.Fs,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=x.Et(t.noDocument.path),r=cn(t.noDocument.readTime);return new rt(n,r,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var i=x.Et(t.unknownDocument.path);return r=cn(t.unknownDocument.version),new Zo(i,r)}return D()}function Su(e,t,n){var r=hs(n),i=t.key.path.X().it();if(t instanceof B){var o=function(f,l){return{name:qn(f,l.key),fields:l.bt().mapValue.fields,updateTime:jn(f,l.version.j())}}(e.Fs,t),s=t.hasCommittedMutations;return new K(null,null,o,s,r,i)}if(t instanceof rt){var u=t.key.path.it(),a=an(t.version);return s=t.hasCommittedMutations,new K(null,new od(u,a),null,s,r,i)}if(t instanceof Zo){var c=t.key.path.it(),h=an(t.version);return new K(new sd(c,h),null,null,!0,r,i)}return D()}function hs(e){var t=e.j();return[t.seconds,t.nanoseconds]}function nh(e){var t=new Et(e[0],e[1]);return R.K(t)}function an(e){var t=e.j();return new id(t.seconds,t.nanoseconds)}function cn(e){var t=new Et(e.seconds,e.nanoseconds);return R.K(t)}function Be(e,t){for(var n=(t.baseMutations||[]).map(function(a){return Eu(e.Fs,a)}),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&t.mutations[r+1].transform!==void 0){var o=t.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var s=t.mutations.map(function(a){return Eu(e.Fs,a)}),u=Et.fromMillis(t.localWriteTimeMs);return new cs(t.batchId,u,n,s)}function An(e){var t,n,r=cn(e.readTime),i=e.lastLimboFreeSnapshotVersion!==void 0?cn(e.lastLimboFreeSnapshotVersion):R.min();return e.query.documents!==void 0?(P((n=e.query).documents.length===1),t=qt(or(Hc(n.documents[0])))):t=function(o){return qt(Qc(o))}(e.query),new pi(t,e.targetId,0,e.lastListenSequenceNumber,r,i,_t.fromBase64String(e.resumeToken))}function rh(e,t){var n,r=an(t.Ot),i=an(t.lastLimboFreeSnapshotVersion);n=qr(t.target)?Yc(e.Fs,t.target):Kc(e.Fs,t.target);var o=t.resumeToken.toBase64();return new bt(t.targetId,ir(t.target),r,o,t.sequenceNumber,i,n)}function ih(e){var t=Qc({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType==="LAST"?Sc(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cd=function(){function e(){}return e.prototype.Os=function(t,n){return Du(t).get(n).next(function(r){if(r)return{id:(i=r).bundleId,createTime:cn(i.createTime),version:i.version};var i})},e.prototype.ks=function(t,n){return Du(t).put({bundleId:(r=n).id,createTime:an(mt(r.createTime)),version:r.version});var r},e.prototype.Ms=function(t,n){return Ou(t).get(n).next(function(r){if(r)return{name:(i=r).name,query:ih(i.bundledQuery),readTime:cn(i.readTime)};var i})},e.prototype.Ls=function(t,n){return Ou(t).put(function(r){return{name:r.name,readTime:an(mt(r.readTime)),bundledQuery:r.bundledQuery}}(n))},e}();function Du(e){return It(e,sn.store)}function Ou(e){return It(e,un.store)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hd=function(){function e(){this.Bs=new fs}return e.prototype.qs=function(t,n){return this.Bs.add(n),E.resolve()},e.prototype.Us=function(t,n){return E.resolve(this.Bs.getEntries(n))},e}(),fs=function(){function e(){this.index={}}return e.prototype.add=function(t){var n=t.tt(),r=t.X(),i=this.index[n]||new tt(q.H),o=!i.has(r);return this.index[n]=i.add(r),o},e.prototype.has=function(t){var n=t.tt(),r=t.X(),i=this.index[n];return i&&i.has(r)},e.prototype.getEntries=function(t){return(this.index[t]||new tt(q.H)).it()},e}(),fd=function(){function e(){this.Qs=new fs}return e.prototype.qs=function(t,n){var r=this;if(!this.Qs.has(n)){var i=n.tt(),o=n.X();t.gs(function(){r.Qs.add(n)});var s={collectionId:i,parent:Vt(o)};return xu(t).put(s)}return E.resolve()},e.prototype.Us=function(t,n){var r=[],i=IDBKeyRange.bound([n,""],[wc(n),""],!1,!0);return xu(t).rs(i).next(function(o){for(var s=0,u=o;s<u.length;s++){var a=u[s];if(a.collectionId!==n)break;r.push(Bt(a.parent))}return r})},e}();function xu(e){return It(e,Te.store)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pu={Ks:!1,Ws:0,js:0,Gs:0},Ft=function(){function e(t,n,r){this.zs=t,this.Hs=n,this.Js=r}return e.Ys=function(t){return new e(t,e.Xs,e.Zs)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(e){return m(this,void 0,void 0,function(){return g(this,function(t){if(e.code!==y.FAILED_PRECONDITION||e.message!==Zc)throw e;return I("LocalStore","Unexpectedly lost primary lease"),[2]})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ft.Xs=10,Ft.Zs=1e3,Ft.ti=new Ft(41943040,Ft.Xs,Ft.Zs),Ft.ei=new Ft(-1,0,0);var mn=function(){function e(t,n){this.ni=t,this.si=n,this.ii={}}return e.prototype.get=function(t){var n=this.ni(t),r=this.ii[n];if(r!==void 0)for(var i=0,o=r;i<o.length;i++){var s=o[i],u=s[0],a=s[1];if(this.si(u,t))return a}},e.prototype.has=function(t){return this.get(t)!==void 0},e.prototype.set=function(t,n){var r=this.ni(t),i=this.ii[r];if(i!==void 0){for(var o=0;o<i.length;o++)if(this.si(i[o][0],t))return void(i[o]=[t,n]);i.push([t,n])}else this.ii[r]=[[t,n]]},e.prototype.delete=function(t){var n=this.ni(t),r=this.ii[n];if(r===void 0)return!1;for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return r.length===1?delete this.ii[n]:r.splice(i,1),!0;return!1},e.prototype.forEach=function(t){nr(this.ii,function(n,r){for(var i=0,o=r;i<o.length;i++){var s=o[i],u=s[0],a=s[1];t(u,a)}})},e.prototype.et=function(){return Ec(this.ii)},e}(),oh=function(){function e(){this.ri=new mn(function(t){return t.toString()},function(t,n){return t.isEqual(n)}),this.oi=!1}return e.prototype.ci=function(t){var n=this.ri.get(t);return n?n.readTime:R.min()},e.prototype.ai=function(t,n){this.ui(),this.ri.set(t.key,{hi:t,readTime:n})},e.prototype.li=function(t,n){n===void 0&&(n=null),this.ui(),this.ri.set(t,{hi:null,readTime:n})},e.prototype._i=function(t,n){this.ui();var r=this.ri.get(n);return r!==void 0?E.resolve(r.hi):this.fi(t,n)},e.prototype.getEntries=function(t,n){return this.di(t,n)},e.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},e.prototype.ui=function(){},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(e,t,n){var r=e.store(H.store),i=e.store(st.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.hs({range:s},function(d,v,w){return u++,w.delete()});o.push(a.next(function(){P(u===1)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=st.key(t,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return E.Mn(o).next(function(){return c})}function Yr(e){var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw D();t=e.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ld=function(){function e(t,n,r,i){this.userId=t,this.Qt=n,this.Ei=r,this.Ti=i,this.Ii={}}return e.mi=function(t,n,r,i){return P(t.uid!==""),new e(t.m()?t.uid:"",n,r,i)},e.prototype.Ai=function(t){var n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wt(t).hs({index:H.userMutationsIndex,range:r},function(i,o,s){n=!1,s.done()}).next(function(){return n})},e.prototype.Ri=function(t,n,r,i){var o=this,s=Ge(t),u=Wt(t);return u.add({}).next(function(a){P(typeof a=="number");for(var c=new cs(a,n,r,i),h=function(_,S,A){var C=A.baseMutations.map(function(V){return $r(_.Fs,V)}),M=A.mutations.map(function(V){return $r(_.Fs,V)});return new H(S,A.batchId,A.vs.toMillis(),C,M)}(o.Qt,o.userId,c),f=[],l=new tt(function(_,S){return L(_.rt(),S.rt())}),p=0,d=i;p<d.length;p++){var v=d[p],w=st.key(o.userId,v.key.path,a);l=l.add(v.key.path.X()),f.push(u.put(h)),f.push(s.put(w,st.PLACEHOLDER))}return l.forEach(function(_){f.push(o.Ei.qs(t,_))}),t.gs(function(){o.Ii[a]=c.keys()}),E.Mn(f).next(function(){return c})})},e.prototype.Pi=function(t,n){var r=this;return Wt(t).get(n).next(function(i){return i?(P(i.userId===r.userId),Be(r.Qt,i)):null})},e.prototype.yi=function(t,n){var r=this;return this.Ii[n]?E.resolve(this.Ii[n]):this.Pi(t,n).next(function(i){if(i){var o=i.keys();return r.Ii[n]=o,o}return null})},e.prototype.gi=function(t,n){var r=this,i=n+1,o=IDBKeyRange.lowerBound([this.userId,i]),s=null;return Wt(t).hs({index:H.userMutationsIndex,range:o},function(u,a,c){a.userId===r.userId&&(P(a.batchId>=i),s=Be(r.Qt,a)),c.done()}).next(function(){return s})},e.prototype.Vi=function(t){var n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Wt(t).hs({index:H.userMutationsIndex,range:n,reverse:!0},function(i,o,s){r=o.batchId,s.done()}).next(function(){return r})},e.prototype.pi=function(t){var n=this,r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Wt(t).rs(H.userMutationsIndex,r).next(function(i){return i.map(function(o){return Be(n.Qt,o)})})},e.prototype.bi=function(t,n){var r=this,i=st.prefixForPath(this.userId,n.path),o=IDBKeyRange.lowerBound(i),s=[];return Ge(t).hs({range:o},function(u,a,c){var h=u[0],f=u[1],l=u[2],p=Bt(f);if(h===r.userId&&n.path.isEqual(p))return Wt(t).get(l).next(function(d){if(!d)throw D();P(d.userId===r.userId),s.push(Be(r.Qt,d))});c.done()}).next(function(){return s})},e.prototype.vi=function(t,n){var r=this,i=new tt(L),o=[];return n.forEach(function(s){var u=st.prefixForPath(r.userId,s.path),a=IDBKeyRange.lowerBound(u),c=Ge(t).hs({range:a},function(h,f,l){var p=h[0],d=h[1],v=h[2],w=Bt(d);p===r.userId&&s.path.isEqual(w)?i=i.add(v):l.done()});o.push(c)}),E.Mn(o).next(function(){return r.Si(t,i)})},e.prototype.Di=function(t,n){var r=this,i=n.path,o=i.length+1,s=st.prefixForPath(this.userId,i),u=IDBKeyRange.lowerBound(s),a=new tt(L);return Ge(t).hs({range:u},function(c,h,f){var l=c[0],p=c[1],d=c[2],v=Bt(p);l===r.userId&&i.nt(v)?v.length===o&&(a=a.add(d)):f.done()}).next(function(){return r.Si(t,a)})},e.prototype.Si=function(t,n){var r=this,i=[],o=[];return n.forEach(function(s){o.push(Wt(t).get(s).next(function(u){if(u===null)throw D();P(u.userId===r.userId),i.push(Be(r.Qt,u))}))}),E.Mn(o).next(function(){return i})},e.prototype.Ci=function(t,n){var r=this;return sh(t.ps,this.userId,n).next(function(i){return t.gs(function(){r.xi(n.batchId)}),E.forEach(i,function(o){return r.Ti.Ni(t,o)})})},e.prototype.xi=function(t){delete this.Ii[t]},e.prototype.$i=function(t){var n=this;return this.Ai(t).next(function(r){if(!r)return E.resolve();var i=IDBKeyRange.lowerBound(st.prefixForUser(n.userId)),o=[];return Ge(t).hs({range:i},function(s,u,a){if(s[0]===n.userId){var c=Bt(s[1]);o.push(c)}else a.done()}).next(function(){P(o.length===0)})})},e.prototype.Fi=function(t,n){return uh(t,this.userId,n)},e.prototype.Oi=function(t){var n=this;return ah(t).get(this.userId).next(function(r){return r||new oe(n.userId,-1,"")})},e}();function uh(e,t,n){var r=st.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ge(e).hs({range:o,us:!0},function(u,a,c){var h=u[0],f=u[1];u[2],h===t&&f===i&&(s=!0),c.done()}).next(function(){return s})}function Wt(e){return It(e,H.store)}function Ge(e){return It(e,st.store)}function ah(e){return It(e,oe.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kr=function(){function e(t){this.ki=t}return e.prototype.next=function(){return this.ki+=2,this.ki},e.Mi=function(){return new e(0)},e.Li=function(){return new e(-1)},e}(),pd=function(){function e(t,n){this.Ti=t,this.Qt=n}return e.prototype.Bi=function(t){var n=this;return this.qi(t).next(function(r){var i=new Kr(r.highestTargetId);return r.highestTargetId=i.next(),n.Ui(t,r).next(function(){return r.highestTargetId})})},e.prototype.Qi=function(t){return this.qi(t).next(function(n){return R.K(new Et(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))})},e.prototype.Ki=function(t){return this.qi(t).next(function(n){return n.highestListenSequenceNumber})},e.prototype.Wi=function(t,n,r){var i=this;return this.qi(t).next(function(o){return o.highestListenSequenceNumber=n,r&&(o.lastRemoteSnapshotVersion=r.j()),n>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=n),i.Ui(t,o)})},e.prototype.ji=function(t,n){var r=this;return this.Gi(t,n).next(function(){return r.qi(t).next(function(i){return i.targetCount+=1,r.zi(n,i),r.Ui(t,i)})})},e.prototype.Hi=function(t,n){return this.Gi(t,n)},e.prototype.Ji=function(t,n){var r=this;return this.Yi(t,n.targetId).next(function(){return qe(t).delete(n.targetId)}).next(function(){return r.qi(t)}).next(function(i){return P(i.targetCount>0),i.targetCount-=1,r.Ui(t,i)})},e.prototype.Xi=function(t,n,r){var i=this,o=0,s=[];return qe(t).hs(function(u,a){var c=An(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(o++,s.push(i.Ji(t,c)))}).next(function(){return E.Mn(s)}).next(function(){return o})},e.prototype.In=function(t,n){return qe(t).hs(function(r,i){var o=An(i);n(o)})},e.prototype.qi=function(t){return ku(t).get(At.key).next(function(n){return P(n!==null),n})},e.prototype.Ui=function(t,n){return ku(t).put(At.key,n)},e.prototype.Gi=function(t,n){return qe(t).put(rh(this.Qt,n))},e.prototype.zi=function(t,n){var r=!1;return t.targetId>n.highestTargetId&&(n.highestTargetId=t.targetId,r=!0),t.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=t.sequenceNumber,r=!0),r},e.prototype.Zi=function(t){return this.qi(t).next(function(n){return n.targetCount})},e.prototype.tr=function(t,n){var r=ir(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return qe(t).hs({range:i,index:bt.queryTargetsIndexName},function(s,u,a){var c=An(u);li(n,c.target)&&(o=c,a.done())}).next(function(){return o})},e.prototype.er=function(t,n,r){var i=this,o=[],s=ee(t);return n.forEach(function(u){var a=Vt(u.path);o.push(s.put(new it(r,a))),o.push(i.Ti.nr(t,r,u))}),E.Mn(o)},e.prototype.sr=function(t,n,r){var i=this,o=ee(t);return E.forEach(n,function(s){var u=Vt(s.path);return E.Mn([o.delete([r,u]),i.Ti.ir(t,r,s)])})},e.prototype.Yi=function(t,n){var r=ee(t),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)},e.prototype.rr=function(t,n){var r=IDBKeyRange.bound([n],[n+1],!1,!0),i=ee(t),o=G();return i.hs({range:r,us:!0},function(s,u,a){var c=Bt(s[1]),h=new x(c);o=o.add(h)}).next(function(){return o})},e.prototype.Fi=function(t,n){var r=Vt(n.path),i=IDBKeyRange.bound([r],[wc(r)],!1,!0),o=0;return ee(t).hs({index:it.documentTargetsIndex,us:!0,range:i},function(s,u,a){var c=s[0];s[1],c!==0&&(o++,a.done())}).next(function(){return o>0})},e.prototype.Sn=function(t,n){return qe(t).get(n).next(function(r){return r?An(r):null})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(e){return It(e,bt.store)}function ku(e){return It(e,At.store)}function ee(e){return It(e,it.store)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],s=L(n,i);return s===0?L(r,o):s}var dd=function(){function e(t){this.cr=t,this.buffer=new tt(Cu),this.ar=0}return e.prototype.ur=function(){return++this.ar},e.prototype.hr=function(t){var n=[t,this.ur()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(n);else{var r=this.buffer.last();Cu(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),vd=function(){function e(t,n){this.lr=t,this._s=n,this._r=!1,this.dr=null}return e.prototype.start=function(t){this.lr.params.zs!==-1&&this.wr(t)},e.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(e.prototype,"Er",{get:function(){return this.dr!==null},enumerable:!1,configurable:!0}),e.prototype.wr=function(t){var n=this,r=this._r?3e5:6e4;I("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.dr=this._s.Tr("lru_garbage_collection",r,function(){return m(n,void 0,void 0,function(){var i;return g(this,function(o){switch(o.label){case 0:this.dr=null,this._r=!0,o.label=1;case 1:return o.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return o.sent(),[3,7];case 3:return Le(i=o.sent())?(I("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",i),[3,6]):[3,4];case 4:return[4,Ve(i)];case 5:o.sent(),o.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return o.sent(),[2]}})})})},e}(),yd=function(){function e(t,n){this.mr=t,this.params=n}return e.prototype.Ar=function(t,n){return this.mr.Rr(t).next(function(r){return Math.floor(n/100*r)})},e.prototype.Pr=function(t,n){var r=this;if(n===0)return E.resolve(Dt.q);var i=new dd(n);return this.mr.In(t,function(o){return i.hr(o.sequenceNumber)}).next(function(){return r.mr.yr(t,function(o){return i.hr(o)})}).next(function(){return i.maxValue})},e.prototype.Xi=function(t,n,r){return this.mr.Xi(t,n,r)},e.prototype.gr=function(t,n){return this.mr.gr(t,n)},e.prototype.Vr=function(t,n){var r=this;return this.params.zs===-1?(I("LruGarbageCollector","Garbage collection skipped; disabled"),E.resolve(Pu)):this.pr(t).next(function(i){return i<r.params.zs?(I("LruGarbageCollector","Garbage collection skipped; Cache size "+i+" is lower than threshold "+r.params.zs),Pu):r.br(t,n)})},e.prototype.pr=function(t){return this.mr.pr(t)},e.prototype.br=function(t,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ar(t,this.params.Hs).next(function(l){return l>h.params.Js?(I("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+l),i=h.params.Js):i=l,s=Date.now(),h.Pr(t,i)}).next(function(l){return r=l,u=Date.now(),h.Xi(t,r,n)}).next(function(l){return o=l,a=Date.now(),h.gr(t,r)}).next(function(l){return c=Date.now(),ro()<=j.DEBUG&&I("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in `+(s-f)+`ms
	Determined least recently used `+i+" in "+(u-s)+`ms
	Removed `+o+" targets in "+(a-u)+`ms
	Removed `+l+" documents in "+(c-a)+`ms
Total Duration: `+(c-f)+"ms"),E.resolve({Ks:!0,Ws:i,js:o,Gs:l})})},e}(),gd=function(){function e(t,n){this.db=t,this.lr=function(r,i){return new yd(r,i)}(this,n)}return e.prototype.Rr=function(t){var n=this.vr(t);return this.db.Sr().Zi(t).next(function(r){return n.next(function(i){return r+i})})},e.prototype.vr=function(t){var n=0;return this.yr(t,function(r){n++}).next(function(){return n})},e.prototype.In=function(t,n){return this.db.Sr().In(t,n)},e.prototype.yr=function(t,n){return this.Dr(t,function(r,i){return n(i)})},e.prototype.nr=function(t,n,r){return mr(t,r)},e.prototype.ir=function(t,n,r){return mr(t,r)},e.prototype.Xi=function(t,n,r){return this.db.Sr().Xi(t,n,r)},e.prototype.Ni=function(t,n){return mr(t,n)},e.prototype.Cr=function(t,n){return function(r,i){var o=!1;return ah(r).ls(function(s){return uh(r,s,i).next(function(u){return u&&(o=!0),E.resolve(!u)})}).next(function(){return o})}(t,n)},e.prototype.gr=function(t,n){var r=this,i=this.db.$r().Nr(),o=[],s=0;return this.Dr(t,function(u,a){if(a<=n){var c=r.Cr(t,u).next(function(h){if(!h)return s++,i._i(t,u).next(function(){return i.li(u),ee(t).delete([0,Vt(u.path)])})});o.push(c)}}).next(function(){return E.Mn(o)}).next(function(){return i.apply(t)}).next(function(){return s})},e.prototype.removeTarget=function(t,n){var r=n.kt(t.bs);return this.db.Sr().Hi(t,r)},e.prototype.Fr=function(t,n){return mr(t,n)},e.prototype.Dr=function(t,n){var r,i=ee(t),o=Dt.q;return i.hs({index:it.documentTargetsIndex},function(s,u){var a=s[0],c=(s[1],u.path),h=u.sequenceNumber;a===0?(o!==Dt.q&&n(new x(Bt(r)),o),o=h,r=c):o=Dt.q}).next(function(){o!==Dt.q&&n(new x(Bt(r)),o)})},e.prototype.pr=function(t){return this.db.$r().Or(t)},e}();function mr(e,t){return ee(e).put(function(n,r){return new it(0,Vt(n.path),r)}(t,e.bs))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var md=function(){function e(t,n){this.Qt=t,this.Ei=n}return e.prototype.ai=function(t,n,r){return Zt(t).put(wr(n),r)},e.prototype.li=function(t,n){var r=Zt(t),i=wr(n);return r.delete(i)},e.prototype.updateMetadata=function(t,n){var r=this;return this.getMetadata(t).next(function(i){return i.byteSize+=n,r.kr(t,i)})},e.prototype._i=function(t,n){var r=this;return Zt(t).get(wr(n)).next(function(i){return r.Mr(i)})},e.prototype.Lr=function(t,n){var r=this;return Zt(t).get(wr(n)).next(function(i){var o=r.Mr(i);return o?{hi:o,size:Yr(i)}:null})},e.prototype.getEntries=function(t,n){var r=this,i=Gr();return this.Br(t,n,function(o,s){var u=r.Mr(s);i=i.zt(o,u)}).next(function(){return i})},e.prototype.qr=function(t,n){var r=this,i=Gr(),o=new lt(x.H);return this.Br(t,n,function(s,u){var a=r.Mr(u);a?(i=i.zt(s,a),o=o.zt(s,Yr(u))):(i=i.zt(s,null),o=o.zt(s,0))}).next(function(){return{Ur:i,Qr:o}})},e.prototype.Br=function(t,n,r){if(n.et())return E.resolve();var i=IDBKeyRange.bound(n.first().path.it(),n.last().path.it()),o=n.te(),s=o.oe();return Zt(t).hs({range:i},function(u,a,c){for(var h=x.Et(u);s&&x.H(s,h)<0;)r(s,null),s=o.oe();s&&s.isEqual(h)&&(r(s,a),s=o.ce()?o.oe():null),s?c.ss(s.path.it()):c.done()}).next(function(){for(;s;)r(s,null),s=o.ce()?o.oe():null})},e.prototype.Kr=function(t,n,r){var i=this,o=Un(),s=n.path.length+1,u={};if(r.isEqual(R.min())){var a=n.path.it();u.range=IDBKeyRange.lowerBound(a)}else{var c=n.path.it(),h=hs(r);u.range=IDBKeyRange.lowerBound([c,h],!0),u.index=K.collectionReadTimeIndex}return Zt(t).hs(u,function(f,l,p){if(f.length===s){var d=ho(i.Qt,l);n.path.nt(d.key.path)?d instanceof B&&ur(n,d)&&(o=o.zt(d.key,d)):p.done()}}).next(function(){return o})},e.prototype.Nr=function(t){return new wd(this,!!t&&t.Wr)},e.prototype.Or=function(t){return this.getMetadata(t).next(function(n){return n.byteSize})},e.prototype.getMetadata=function(t){return Ru(t).get(Ut.key).next(function(n){return P(!!n),n})},e.prototype.kr=function(t,n){return Ru(t).put(Ut.key,n)},e.prototype.Mr=function(t){if(t){var n=ho(this.Qt,t);return n instanceof rt&&n.version.isEqual(R.min())?null:n}return null},e}(),wd=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).jr=n,i.Wr=r,i.Gr=new mn(function(o){return o.toString()},function(o,s){return o.isEqual(s)}),i}return N(t,e),t.prototype.wi=function(n){var r=this,i=[],o=0,s=new tt(function(u,a){return L(u.rt(),a.rt())});return this.ri.forEach(function(u,a){var c=r.Gr.get(u);if(a.hi){var h=Su(r.jr.Qt,a.hi,r.ci(u));s=s.add(u.path.X());var f=Yr(h);o+=f-c,i.push(r.jr.ai(n,u,h))}else if(o-=c,r.Wr){var l=Su(r.jr.Qt,new rt(u,R.min()),r.ci(u));i.push(r.jr.ai(n,u,l))}else i.push(r.jr.li(n,u))}),s.forEach(function(u){i.push(r.jr.Ei.qs(n,u))}),i.push(this.jr.updateMetadata(n,o)),E.Mn(i)},t.prototype.fi=function(n,r){var i=this;return this.jr.Lr(n,r).next(function(o){return o===null?(i.Gr.set(r,0),null):(i.Gr.set(r,o.size),o.hi)})},t.prototype.di=function(n,r){var i=this;return this.jr.qr(n,r).next(function(o){var s=o.Ur;return o.Qr.forEach(function(u,a){i.Gr.set(u,a)}),s})},t}(oh);function Ru(e){return It(e,Ut.store)}function Zt(e){return It(e,K.store)}function wr(e){return e.path.it()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bd=function(){function e(t){this.Qt=t}return e.prototype.Jn=function(t,n,r,i){var o=this;P(r<i&&r>=0&&i<=11);var s=new Jc("createOrUpgrade",n);r<1&&i>=1&&(function(a){a.createObjectStore(Tt.store)}(t),function(a){a.createObjectStore(oe.store,{keyPath:oe.keyPath}),a.createObjectStore(H.store,{keyPath:H.keyPath,autoIncrement:!0}).createIndex(H.userMutationsIndex,H.userMutationsKeyPath,{unique:!0}),a.createObjectStore(st.store)}(t),Lu(t),function(a){a.createObjectStore(K.store)}(t));var u=E.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore(it.store),a.deleteObjectStore(bt.store),a.deleteObjectStore(At.store)}(t),Lu(t)),u=u.next(function(){return function(a){var c=a.store(At.store),h=new At(0,0,R.min().j(),0);return c.put(At.key,h)}(s)})),r<4&&i>=4&&(r!==0&&(u=u.next(function(){return function(a,c){return c.store(H.store).rs().next(function(h){a.deleteObjectStore(H.store),a.createObjectStore(H.store,{keyPath:H.keyPath,autoIncrement:!0}).createIndex(H.userMutationsIndex,H.userMutationsKeyPath,{unique:!0});var f=c.store(H.store),l=h.map(function(p){return f.put(p)});return E.Mn(l)})}(t,s)})),u=u.next(function(){(function(a){a.createObjectStore(Ht.store,{keyPath:Ht.keyPath})})(t)})),r<5&&i>=5&&(u=u.next(function(){return o.zr(s)})),r<6&&i>=6&&(u=u.next(function(){return function(a){a.createObjectStore(Ut.store)}(t),o.Hr(s)})),r<7&&i>=7&&(u=u.next(function(){return o.Jr(s)})),r<8&&i>=8&&(u=u.next(function(){return o.Yr(t,s)})),r<9&&i>=9&&(u=u.next(function(){(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(t),function(a){var c=a.objectStore(K.store);c.createIndex(K.readTimeIndex,K.readTimeIndexPath,{unique:!1}),c.createIndex(K.collectionReadTimeIndex,K.collectionReadTimeIndexPath,{unique:!1})}(n)})),r<10&&i>=10&&(u=u.next(function(){return o.Xr(s)})),r<11&&i>=11&&(u=u.next(function(){(function(a){a.createObjectStore(sn.store,{keyPath:sn.keyPath})})(t),function(a){a.createObjectStore(un.store,{keyPath:un.keyPath})}(t)})),u},e.prototype.Hr=function(t){var n=0;return t.store(K.store).hs(function(r,i){n+=Yr(i)}).next(function(){var r=new Ut(n);return t.store(Ut.store).put(Ut.key,r)})},e.prototype.zr=function(t){var n=this,r=t.store(oe.store),i=t.store(H.store);return r.rs().next(function(o){return E.forEach(o,function(s){var u=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.rs(H.userMutationsIndex,u).next(function(a){return E.forEach(a,function(c){P(c.userId===s.userId);var h=Be(n.Qt,c);return sh(t,s.userId,h).next(function(){})})})})})},e.prototype.Jr=function(t){var n=t.store(it.store),r=t.store(K.store);return t.store(At.store).get(At.key).next(function(i){var o=[];return r.hs(function(s,u){var a=new q(s),c=function(h){return[0,Vt(h)]}(a);o.push(n.get(c).next(function(h){return h?E.resolve():function(f){return n.put(new it(0,Vt(f),i.highestListenSequenceNumber))}(a)}))}).next(function(){return E.Mn(o)})})},e.prototype.Yr=function(t,n){t.createObjectStore(Te.store,{keyPath:Te.keyPath});var r=n.store(Te.store),i=new fs,o=function(s){if(i.add(s)){var u=s.tt(),a=s.X();return r.put({collectionId:u,parent:Vt(a)})}};return n.store(K.store).hs({us:!0},function(s,u){var a=new q(s);return o(a.X())}).next(function(){return n.store(st.store).hs({us:!0},function(s,u){s[0];var a=s[1],c=(s[2],Bt(a));return o(c.X())})})},e.prototype.Xr=function(t){var n=this,r=t.store(bt.store);return r.hs(function(i,o){var s=An(o),u=rh(n.Qt,s);return r.put(u)})},e}();function Lu(e){e.createObjectStore(it.store,{keyPath:it.keyPath}).createIndex(it.documentTargetsIndex,it.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(bt.store,{keyPath:bt.keyPath}).createIndex(bt.queryTargetsIndexName,bt.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(At.store)}var Ui="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ed=function(){function e(t,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Zr=o,this.window=s,this.document=u,this.eo=c,this.no=h,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(f){return Promise.resolve()},!e.Kn())throw new b(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new gd(this,i),this.ho=n+"main",this.Qt=new eh(a),this.lo=new on(this.ho,11,new bd(this.Qt)),this._o=new pd(this.Ti,this.Qt),this.Ei=new fd,this.fo=function(f,l){return new md(f,l)}(this.Qt,this.Ei),this.wo=new cd,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,h===!1&&W("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var t=this;return this.To().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new b(y.FAILED_PRECONDITION,Ui);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(n){return t._o.Ki(n)})}).then(function(n){t.so=new Dt(n,t.eo)}).then(function(){t.io=!0}).catch(function(n){return t.lo&&t.lo.close(),Promise.reject(n)})},e.prototype.Ro=function(t){var n=this;return this.uo=function(r){return m(n,void 0,void 0,function(){return g(this,function(i){return this.Er?[2,t(r)]:[2]})})},t(this.isPrimary)},e.prototype.Po=function(t){var n=this;this.lo.Xn(function(r){return m(n,void 0,void 0,function(){return g(this,function(i){switch(i.label){case 0:return r.newVersion===null?[4,t()]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}})})})},e.prototype.yo=function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps(function(){return m(n,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}))},e.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(n){return br(n).put(new Ht(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Vo(n).next(function(r){r||(t.isPrimary=!1,t.Zr.po(function(){return t.uo(!1)}))})}).next(function(){return t.bo(n)}).next(function(r){return t.isPrimary&&!r?t.vo(n).next(function(){return!1}):!!r&&t.So(n).next(function(){return!0})})}).catch(function(n){if(Le(n))return I("IndexedDbPersistence","Failed to extend owner lease: ",n),t.isPrimary;if(!t.allowTabSynchronization)throw n;return I("IndexedDbPersistence","Releasing owner lease after error during lease refresh",n),!1}).then(function(n){t.isPrimary!==n&&t.Zr.po(function(){return t.uo(n)}),t.isPrimary=n})},e.prototype.Vo=function(t){var n=this;return Tn(t).get(Tt.key).next(function(r){return E.resolve(n.Do(r))})},e.prototype.Co=function(t){return br(t).delete(this.clientId)},e.prototype.xo=function(){return m(this,void 0,void 0,function(){var t,n,r,i,o=this;return g(this,function(s){switch(s.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(u){var a=It(u,Ht.store);return a.rs().next(function(c){var h=o.$o(c,18e5),f=c.filter(function(l){return h.indexOf(l)===-1});return E.forEach(f,function(l){return a.delete(l.clientId)}).next(function(){return f})})}).catch(function(){return[]})]);case 1:if(t=s.sent(),this.Eo)for(n=0,r=t;n<r.length;n++)i=r[n],this.Eo.removeItem(this.Fo(i.clientId));s.label=2;case 2:return[2]}})})},e.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,function(){return t.To().then(function(){return t.xo()}).then(function(){return t.Ao()})})},e.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},e.prototype.bo=function(t){var n=this;return this.no?E.resolve(!0):Tn(t).get(Tt.key).next(function(r){if(r!==null&&n.No(r.leaseTimestampMs,5e3)&&!n.Oo(r.ownerId)){if(n.Do(r)&&n.networkEnabled)return!0;if(!n.Do(r)){if(!r.allowTabSynchronization)throw new b(y.FAILED_PRECONDITION,Ui);return!1}}return!(!n.networkEnabled||!n.inForeground)||br(t).rs().next(function(i){return n.$o(i,5e3).find(function(o){if(n.clientId!==o.clientId){var s=!n.networkEnabled&&o.networkEnabled,u=!n.inForeground&&o.inForeground,a=n.networkEnabled===o.networkEnabled;if(s||u&&a)return!0}return!1})===void 0})}).next(function(r){return n.isPrimary!==r&&I("IndexedDbPersistence","Client "+(r?"is":"is not")+" eligible for a primary lease."),r})},e.prototype.ko=function(){return m(this,void 0,void 0,function(){var t=this;return g(this,function(n){switch(n.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Tt.store,Ht.store],function(r){var i=new Au(r,Dt.q);return t.vo(i).next(function(){return t.Co(i)})})];case 1:return n.sent(),this.lo.close(),this.qo(),[2]}})})},e.prototype.$o=function(t,n){var r=this;return t.filter(function(i){return r.No(i.updateTimeMs,n)&&!r.Oo(i.clientId)})},e.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(n){return br(n).rs().next(function(r){return t.$o(r,18e5).map(function(i){return i.clientId})})})},Object.defineProperty(e.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),e.prototype.Qo=function(t){return ld.mi(t,this.Qt,this.Ei,this.Ti)},e.prototype.Sr=function(){return this._o},e.prototype.$r=function(){return this.fo},e.prototype.Ko=function(){return this.Ei},e.prototype.Wo=function(){return this.wo},e.prototype.runTransaction=function(t,n,r){var i=this;I("IndexedDbPersistence","Starting transaction:",t);var o,s=n==="readonly"?"readonly":"readwrite";return this.lo.runTransaction(t,s,ud,function(u){return o=new Au(u,i.so?i.so.next():Dt.q),n==="readwrite-primary"?i.Vo(o).next(function(a){return!!a||i.bo(o)}).next(function(a){if(!a)throw W("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Zr.po(function(){return i.uo(!1)}),new b(y.FAILED_PRECONDITION,Zc);return r(o)}).next(function(a){return i.So(o).next(function(){return a})}):i.jo(o).next(function(){return r(o)})}).then(function(u){return o.Vs(),u})},e.prototype.jo=function(t){var n=this;return Tn(t).get(Tt.key).next(function(r){if(r!==null&&n.No(r.leaseTimestampMs,5e3)&&!n.Oo(r.ownerId)&&!n.Do(r)&&!(n.no||n.allowTabSynchronization&&r.allowTabSynchronization))throw new b(y.FAILED_PRECONDITION,Ui)})},e.prototype.So=function(t){var n=new Tt(this.clientId,this.allowTabSynchronization,Date.now());return Tn(t).put(Tt.key,n)},e.Kn=function(){return on.Kn()},e.prototype.vo=function(t){var n=this,r=Tn(t);return r.get(Tt.key).next(function(i){return n.Do(i)?(I("IndexedDbPersistence","Releasing primary lease."),r.delete(Tt.key)):E.resolve()})},e.prototype.No=function(t,n){var r=Date.now();return!(t<r-n||t>r&&(W("Detected an update time that is in the future: "+t+" > "+r),1))},e.prototype.Io=function(){var t=this;this.document!==null&&typeof this.document.addEventListener=="function"&&(this.oo=function(){t.Zr.Ps(function(){return t.inForeground=t.document.visibilityState==="visible",t.To()})},this.document.addEventListener("visibilitychange",this.oo),this.inForeground=this.document.visibilityState==="visible")},e.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},e.prototype.mo=function(){var t,n=this;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.ro=function(){n.Mo(),n.Zr.Ps(function(){return n.ko()})},this.window.addEventListener("unload",this.ro))},e.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},e.prototype.Oo=function(t){var n;try{var r=((n=this.Eo)===null||n===void 0?void 0:n.getItem(this.Fo(t)))!==null;return I("IndexedDbPersistence","Client '"+t+"' "+(r?"is":"is not")+" zombied in LocalStorage"),r}catch(i){return W("IndexedDbPersistence","Failed to get zombied client id.",i),!1}},e.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){W("Failed to set zombie client id.",t)}},e.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch{}},e.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},e}();function Tn(e){return It(e,Tt.store)}function br(e){return It(e,Ht.store)}function ls(e,t){var n=e.projectId;return e.o||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var ch=function(){function e(t,n,r){this.fo=t,this.zo=n,this.Ei=r}return e.prototype.Ho=function(t,n){var r=this;return this.zo.bi(t,n).next(function(i){return r.Jo(t,n,i)})},e.prototype.Jo=function(t,n,r){return this.fo._i(t,n).next(function(i){for(var o=0,s=r;o<s.length;o++)i=s[o].Cs(n,i);return i})},e.prototype.Yo=function(t,n,r){var i=Gr();return n.forEach(function(o,s){for(var u=0,a=r;u<a.length;u++)s=a[u].Cs(o,s);i=i.zt(o,s)}),i},e.prototype.Xo=function(t,n){var r=this;return this.fo.getEntries(t,n).next(function(i){return r.Zo(t,i)})},e.prototype.Zo=function(t,n){var r=this;return this.zo.vi(t,n).next(function(i){var o=r.Yo(t,n,i),s=fe();return o.forEach(function(u,a){a||(a=new rt(u,R.min())),s=s.zt(u,a)}),s})},e.prototype.Kr=function(t,n,r){return function(i){return x.wt(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.tc(t,n.path):ns(n)?this.ec(t,n,r):this.nc(t,n,r)},e.prototype.tc=function(t,n){return this.Ho(t,new x(n)).next(function(r){var i=Un();return r instanceof B&&(i=i.zt(r.key,r)),i})},e.prototype.ec=function(t,n,r){var i=this,o=n.collectionGroup,s=Un();return this.Ei.Us(t,o).next(function(u){return E.forEach(u,function(a){var c=function(h,f){return new Qt(f,null,h.xt.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,a.child(o));return i.nc(t,c,r).next(function(h){h.forEach(function(f,l){s=s.zt(f,l)})})}).next(function(){return s})})},e.prototype.nc=function(t,n,r){var i,o,s=this;return this.fo.Kr(t,n,r).next(function(u){return i=u,s.zo.Di(t,n)}).next(function(u){return o=u,s.sc(t,o,i).next(function(a){i=a;for(var c=0,h=o;c<h.length;c++)for(var f=h[c],l=0,p=f.mutations;l<p.length;l++){var d=p[l],v=d.key,w=ao(d,i.get(v),f.vs);i=w instanceof B?i.zt(v,w):i.remove(v)}})}).next(function(){return i.forEach(function(u,a){ur(n,a)||(i=i.remove(u))}),i})},e.prototype.sc=function(t,n,r){for(var i=G(),o=0,s=n;o<s.length;o++)for(var u=0,a=s[o].mutations;u<a.length;u++){var c=a[u];c instanceof ve&&r.get(c.key)===null&&(i=i.add(c.key))}var h=r;return this.fo.getEntries(t,i).next(function(f){return f.forEach(function(l,p){p!==null&&p instanceof B&&(h=h.zt(l,p))}),h})},e}(),_d=function(){function e(t,n,r,i){this.targetId=t,this.fromCache=n,this.ic=r,this.rc=i}return e.oc=function(t,n){for(var r=G(),i=G(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),hh=function(){function e(){}return e.prototype.cc=function(t){this.ac=t},e.prototype.Kr=function(t,n,r,i){var o=this;return function(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.xt.length===0||s.xt.length===1&&s.xt[0].field.ut())}(n)||r.isEqual(R.min())?this.uc(t,n):this.ac.Xo(t,i).next(function(s){var u=o.hc(n,s);return(Ir(n)||Br(n))&&o.lc(n.limitType,u,i,r)?o.uc(t,n):(ro()<=j.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),uo(n)),o.ac.Kr(t,n,r).next(function(a){return u.forEach(function(c){a=a.zt(c.key,c)}),a}))})},e.prototype.hc=function(t,n){var r=new tt(Oc(t));return n.forEach(function(i,o){o instanceof B&&ur(t,o)&&(r=r.add(o))}),r},e.prototype.lc=function(t,n,r,i){if(r.size!==n.size)return!0;var o=t==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version._(i)>0)},e.prototype.uc=function(t,n){return ro()<=j.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",uo(n)),this.ac.Kr(t,n,R.min())},e}(),Id=function(){function e(t,n,r,i){this.persistence=t,this._c=n,this.Qt=i,this.fc=new lt(L),this.dc=new mn(function(o){return ir(o)},li),this.wc=R.min(),this.zo=t.Qo(r),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new ch(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}return e.prototype.Ir=function(t){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(r){return t.Vr(r,n.fc)})},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fh(e,t,n,r){return new Id(e,t,n,r)}function lh(e,t){return m(this,void 0,void 0,function(){var n,r,i,o;return g(this,function(s){switch(s.label){case 0:return n=T(e),r=n.zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",function(u){var a;return n.zo.pi(u).next(function(c){return a=c,r=n.persistence.Qo(t),i=new ch(n.Ec,r,n.persistence.Ko()),r.pi(u)}).next(function(c){for(var h=[],f=[],l=G(),p=0,d=a;p<d.length;p++){var v=d[p];h.push(v.batchId);for(var w=0,_=v.mutations;w<_.length;w++){var S=_[w];l=l.add(S.key)}}for(var A=0,C=c;A<C.length;A++){var M=C[A];f.push(M.batchId);for(var V=0,J=M.mutations;V<J.length;V++){var Di=J[V];l=l.add(Di.key)}}return i.Xo(u,l).next(function(_n){return{Ic:_n,mc:h,Ac:f}})})})];case 1:return o=s.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}})})}function Td(e,t){var n=T(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(r){var i=t.batch.keys(),o=n.Ec.Nr({Wr:!0});return function(s,u,a,c){var h=a.batch,f=h.keys(),l=E.resolve();return f.forEach(function(p){l=l.next(function(){return c._i(u,p)}).next(function(d){var v=d,w=a.$s.get(p);P(w!==null),(!v||v.version._(w)<0)&&(v=h.Ss(p,v,a))&&c.ai(v,a.Ns)})}),l.next(function(){return s.zo.Ci(u,h)})}(n,r,t,o).next(function(){return o.apply(r)}).next(function(){return n.zo.$i(r)}).next(function(){return n.Tc.Xo(r,i)})})}function ph(e){var t=T(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(n){return t._o.Qi(n)})}function Nd(e,t){var n=T(e),r=t.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var s=n.Ec.Nr({Wr:!0});i=n.fc;var u=[];t.$e.forEach(function(h,f){var l=i.get(f);if(l){u.push(n._o.sr(o,h.Qe,f).next(function(){return n._o.er(o,h.qe,f)}));var p=h.resumeToken;if(p.l()>0){var d=l.Mt(p,r).kt(o.bs);i=i.zt(f,d),function(v,w,_){return P(w.resumeToken.l()>0),v.resumeToken.l()===0||w.Ot.W()-v.Ot.W()>=3e8||_.qe.size+_.Ue.size+_.Qe.size>0}(l,d,h)&&u.push(n._o.Hi(o,d))}}});var a=fe();if(t.Oe.forEach(function(h,f){t.ke.has(h)&&u.push(n.persistence.Ti.Fr(o,h))}),u.push(Ad(o,s,t.Oe,r,void 0).next(function(h){a=h})),!r.isEqual(R.min())){var c=n._o.Qi(o).next(function(h){return n._o.Wi(o,o.bs,r)});u.push(c)}return E.Mn(u).next(function(){return s.apply(o)}).next(function(){return n.Tc.Zo(o,a)})}).then(function(o){return n.fc=i,o})}function Ad(e,t,n,r,i){var o=G();return n.forEach(function(s){return o=o.add(s)}),t.getEntries(e,o).next(function(s){var u=fe();return n.forEach(function(a,c){var h=s.get(a),f=(i==null?void 0:i.get(a))||r;c instanceof rt&&c.version.isEqual(R.min())?(t.li(a,f),u=u.zt(a,c)):h==null||c.version._(h.version)>0||c.version._(h.version)===0&&h.hasPendingWrites?(t.ai(c,f),u=u.zt(a,c)):I("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)}),u})}function Sd(e,t){var n=T(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(r){return t===void 0&&(t=-1),n.zo.gi(r,t)})}function Qr(e,t){var n=T(e);return n.persistence.runTransaction("Allocate target","readwrite",function(r){var i;return n._o.tr(r,t).next(function(o){return o?(i=o,E.resolve(i)):n._o.Bi(r).next(function(s){return i=new pi(t,s,0,r.bs),n._o.ji(r,i).next(function(){return i})})})}).then(function(r){var i=n.fc.get(r.targetId);return(i===null||r.Ot._(i.Ot)>0)&&(n.fc=n.fc.zt(r.targetId,r),n.dc.set(t,r.targetId)),r})}function hn(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return g(this,function(u){switch(u.label){case 0:r=T(e),i=r.fc.get(t),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(a){return r.persistence.Ti.removeTarget(a,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!Le(s=u.sent()))throw s;return I("LocalStore","Failed to update sequence numbers for target "+t+": "+s),[3,5];case 5:return r.fc=r.fc.remove(t),r.dc.delete(i.target),[2]}})})}function Xr(e,t,n){var r=T(e),i=R.min(),o=G();return r.persistence.runTransaction("Execute query","readonly",function(s){return function(u,a,c){var h=T(u),f=h.dc.get(c);return f!==void 0?E.resolve(h.fc.get(f)):h._o.tr(a,c)}(r,s,qt(t)).next(function(u){if(u)return i=u.lastLimboFreeSnapshotVersion,r._o.rr(s,u.targetId).next(function(a){o=a})}).next(function(){return r._c.Kr(s,t,n?i:R.min(),n?o:G())}).next(function(u){return{documents:u,Rc:o}})})}function dh(e,t){var n=T(e),r=T(n._o),i=n.fc.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(o){return r.Sn(o,t).next(function(s){return s?s.target:null})})}function vh(e){var t=T(e);return t.persistence.runTransaction("Get new document changes","readonly",function(n){return function(r,i,o){var s=T(r),u=fe(),a=hs(o),c=Zt(i),h=IDBKeyRange.lowerBound(a,!0);return c.hs({index:K.readTimeIndex,range:h},function(f,l){var p=ho(s.Qt,l);u=u.zt(p.key,p),a=l.readTime}).next(function(){return{Go:u,readTime:nh(a)}})}(t.Ec,n,t.wc)}).then(function(n){var r=n.Go,i=n.readTime;return t.wc=i,r})}function Dd(e){return m(this,void 0,void 0,function(){var t;return g(this,function(n){return[2,(t=T(e)).persistence.runTransaction("Synchronize last document change read time","readonly",function(r){return function(i){var o=Zt(i),s=R.min();return o.hs({index:K.readTimeIndex,reverse:!0},function(u,a,c){a.readTime&&(s=nh(a.readTime)),c.done()}).next(function(){return s})}(r)}).then(function(r){t.wc=r})]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Od=function(){function e(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}return e.prototype.Os=function(t,n){return E.resolve(this.Vc.get(n))},e.prototype.ks=function(t,n){var r;return this.Vc.set(n.id,{id:(r=n).id,version:r.version,createTime:mt(r.createTime)}),E.resolve()},e.prototype.Ms=function(t,n){return E.resolve(this.bc.get(n))},e.prototype.Ls=function(t,n){return this.bc.set(n.name,function(r){return{name:r.name,query:ih(r.bundledQuery),readTime:mt(r.readTime)}}(n)),E.resolve()},e}(),ps=function(){function e(){this.vc=new tt(nt.Sc),this.Dc=new tt(nt.Cc)}return e.prototype.et=function(){return this.vc.et()},e.prototype.nr=function(t,n){var r=new nt(t,n);this.vc=this.vc.add(r),this.Dc=this.Dc.add(r)},e.prototype.xc=function(t,n){var r=this;t.forEach(function(i){return r.nr(i,n)})},e.prototype.ir=function(t,n){this.Nc(new nt(t,n))},e.prototype.$c=function(t,n){var r=this;t.forEach(function(i){return r.ir(i,n)})},e.prototype.Fc=function(t){var n=this,r=new x(new q([])),i=new nt(r,t),o=new nt(r,t+1),s=[];return this.Dc.me([i,o],function(u){n.Nc(u),s.push(u.key)}),s},e.prototype.Oc=function(){var t=this;this.vc.forEach(function(n){return t.Nc(n)})},e.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},e.prototype.kc=function(t){var n=new x(new q([])),r=new nt(n,t),i=new nt(n,t+1),o=G();return this.Dc.me([r,i],function(s){o=o.add(s.key)}),o},e.prototype.Fi=function(t){var n=new nt(t,0),r=this.vc.Re(n);return r!==null&&t.isEqual(r.key)},e}(),nt=function(){function e(t,n){this.key=t,this.Mc=n}return e.Sc=function(t,n){return x.H(t.key,n.key)||L(t.Mc,n.Mc)},e.Cc=function(t,n){return L(t.Mc,n.Mc)||x.H(t.key,n.key)},e}(),xd=function(){function e(t,n){this.Ei=t,this.Ti=n,this.zo=[],this.Lc=1,this.Bc=new tt(nt.Sc)}return e.prototype.Ai=function(t){return E.resolve(this.zo.length===0)},e.prototype.Ri=function(t,n,r,i){var o=this.Lc;this.Lc++,this.zo.length>0&&this.zo[this.zo.length-1];var s=new cs(o,n,r,i);this.zo.push(s);for(var u=0,a=i;u<a.length;u++){var c=a[u];this.Bc=this.Bc.add(new nt(c.key,o)),this.Ei.qs(t,c.key.path.X())}return E.resolve(s)},e.prototype.Pi=function(t,n){return E.resolve(this.qc(n))},e.prototype.gi=function(t,n){var r=n+1,i=this.Uc(r),o=i<0?0:i;return E.resolve(this.zo.length>o?this.zo[o]:null)},e.prototype.Vi=function(){return E.resolve(this.zo.length===0?-1:this.Lc-1)},e.prototype.pi=function(t){return E.resolve(this.zo.slice())},e.prototype.bi=function(t,n){var r=this,i=new nt(n,0),o=new nt(n,Number.POSITIVE_INFINITY),s=[];return this.Bc.me([i,o],function(u){var a=r.qc(u.Mc);s.push(a)}),E.resolve(s)},e.prototype.vi=function(t,n){var r=this,i=new tt(L);return n.forEach(function(o){var s=new nt(o,0),u=new nt(o,Number.POSITIVE_INFINITY);r.Bc.me([s,u],function(a){i=i.add(a.Mc)})}),E.resolve(this.Qc(i))},e.prototype.Di=function(t,n){var r=n.path,i=r.length+1,o=r;x.wt(o)||(o=o.child(""));var s=new nt(new x(o),0),u=new tt(L);return this.Bc.Ae(function(a){var c=a.key.path;return!!r.nt(c)&&(c.length===i&&(u=u.add(a.Mc)),!0)},s),E.resolve(this.Qc(u))},e.prototype.Qc=function(t){var n=this,r=[];return t.forEach(function(i){var o=n.qc(i);o!==null&&r.push(o)}),r},e.prototype.Ci=function(t,n){var r=this;P(this.Kc(n.batchId,"removed")===0),this.zo.shift();var i=this.Bc;return E.forEach(n.mutations,function(o){var s=new nt(o.key,n.batchId);return i=i.delete(s),r.Ti.Ni(t,o.key)}).next(function(){r.Bc=i})},e.prototype.xi=function(t){},e.prototype.Fi=function(t,n){var r=new nt(n,0),i=this.Bc.Re(r);return E.resolve(n.isEqual(i&&i.key))},e.prototype.$i=function(t){return this.zo.length,E.resolve()},e.prototype.Kc=function(t,n){return this.Uc(t)},e.prototype.Uc=function(t){return this.zo.length===0?0:t-this.zo[0].batchId},e.prototype.qc=function(t){var n=this.Uc(t);return n<0||n>=this.zo.length?null:this.zo[n]},e}(),Pd=function(){function e(t,n){this.Ei=t,this.Wc=n,this.docs=new lt(x.H),this.size=0}return e.prototype.ai=function(t,n,r){var i=n.key,o=this.docs.get(i),s=o?o.size:0,u=this.Wc(n);return this.docs=this.docs.zt(i,{hi:n,size:u,readTime:r}),this.size+=u-s,this.Ei.qs(t,i.path.X())},e.prototype.li=function(t){var n=this.docs.get(t);n&&(this.docs=this.docs.remove(t),this.size-=n.size)},e.prototype._i=function(t,n){var r=this.docs.get(n);return E.resolve(r?r.hi:null)},e.prototype.getEntries=function(t,n){var r=this,i=Gr();return n.forEach(function(o){var s=r.docs.get(o);i=i.zt(o,s?s.hi:null)}),E.resolve(i)},e.prototype.Kr=function(t,n,r){for(var i=Un(),o=new x(n.path.child("")),s=this.docs.ee(o);s.ce();){var u=s.oe(),a=u.key,c=u.value,h=c.hi,f=c.readTime;if(!n.path.nt(a.path))break;f._(r)<=0||h instanceof B&&ur(n,h)&&(i=i.zt(h.key,h))}return E.resolve(i)},e.prototype.jc=function(t,n){return E.forEach(this.docs,function(r){return n(r)})},e.prototype.Nr=function(t){return new kd(this)},e.prototype.Or=function(t){return E.resolve(this.size)},e}(),kd=function(e){function t(n){var r=this;return(r=e.call(this)||this).jr=n,r}return N(t,e),t.prototype.wi=function(n){var r=this,i=[];return this.ri.forEach(function(o,s){s&&s.hi?i.push(r.jr.ai(n,s.hi,r.ci(o))):r.jr.li(o)}),E.Mn(i)},t.prototype.fi=function(n,r){return this.jr._i(n,r)},t.prototype.di=function(n,r){return this.jr.getEntries(n,r)},t}(oh),Cd=function(){function e(t){this.persistence=t,this.Gc=new mn(function(n){return ir(n)},li),this.lastRemoteSnapshotVersion=R.min(),this.highestTargetId=0,this.zc=0,this.Hc=new ps,this.targetCount=0,this.Jc=Kr.Mi()}return e.prototype.In=function(t,n){return this.Gc.forEach(function(r,i){return n(i)}),E.resolve()},e.prototype.Qi=function(t){return E.resolve(this.lastRemoteSnapshotVersion)},e.prototype.Ki=function(t){return E.resolve(this.zc)},e.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),E.resolve(this.highestTargetId)},e.prototype.Wi=function(t,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.zc&&(this.zc=n),E.resolve()},e.prototype.Gi=function(t){this.Gc.set(t.target,t);var n=t.targetId;n>this.highestTargetId&&(this.Jc=new Kr(n),this.highestTargetId=n),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},e.prototype.ji=function(t,n){return this.Gi(n),this.targetCount+=1,E.resolve()},e.prototype.Hi=function(t,n){return this.Gi(n),E.resolve()},e.prototype.Ji=function(t,n){return this.Gc.delete(n.target),this.Hc.Fc(n.targetId),this.targetCount-=1,E.resolve()},e.prototype.Xi=function(t,n,r){var i=this,o=0,s=[];return this.Gc.forEach(function(u,a){a.sequenceNumber<=n&&r.get(a.targetId)===null&&(i.Gc.delete(u),s.push(i.Yi(t,a.targetId)),o++)}),E.Mn(s).next(function(){return o})},e.prototype.Zi=function(t){return E.resolve(this.targetCount)},e.prototype.tr=function(t,n){var r=this.Gc.get(n)||null;return E.resolve(r)},e.prototype.er=function(t,n,r){return this.Hc.xc(n,r),E.resolve()},e.prototype.sr=function(t,n,r){this.Hc.$c(n,r);var i=this.persistence.Ti,o=[];return i&&n.forEach(function(s){o.push(i.Ni(t,s))}),E.Mn(o)},e.prototype.Yi=function(t,n){return this.Hc.Fc(n),E.resolve()},e.prototype.rr=function(t,n){var r=this.Hc.kc(n);return E.resolve(r)},e.prototype.Fi=function(t,n){return E.resolve(this.Hc.Fi(n))},e}(),Rd=function(){function e(t,n){var r=this;this.Yc={},this.so=new Dt(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Cd(this),this.Ei=new hd,this.fo=function(i,o){return new Pd(i,function(s){return r.Ti.Xc(s)})}(this.Ei),this.Qt=new eh(n),this.wo=new Od(this.Qt)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(e.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),e.prototype.Po=function(){},e.prototype.yo=function(){},e.prototype.Ko=function(){return this.Ei},e.prototype.Qo=function(t){var n=this.Yc[t.A()];return n||(n=new xd(this.Ei,this.Ti),this.Yc[t.A()]=n),n},e.prototype.Sr=function(){return this._o},e.prototype.$r=function(){return this.fo},e.prototype.Wo=function(){return this.wo},e.prototype.runTransaction=function(t,n,r){var i=this;I("MemoryPersistence","Starting transaction:",t);var o=new Ld(this.so.next());return this.Ti.Zc(),r(o).next(function(s){return i.Ti.ta(o).next(function(){return s})}).On().then(function(s){return o.Vs(),s})},e.prototype.ea=function(t,n){return E.Ln(Object.values(this.Yc).map(function(r){return function(){return r.Fi(t,n)}}))},e}(),Ld=function(e){function t(n){var r=this;return(r=e.call(this)||this).bs=n,r}return N(t,e),t}(th),Vd=function(){function e(t){this.persistence=t,this.na=new ps,this.sa=null}return e.ia=function(t){return new e(t)},Object.defineProperty(e.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw D()},enumerable:!1,configurable:!0}),e.prototype.nr=function(t,n,r){return this.na.nr(r,n),this.ra.delete(r.toString()),E.resolve()},e.prototype.ir=function(t,n,r){return this.na.ir(r,n),this.ra.add(r.toString()),E.resolve()},e.prototype.Ni=function(t,n){return this.ra.add(n.toString()),E.resolve()},e.prototype.removeTarget=function(t,n){var r=this;this.na.Fc(n.targetId).forEach(function(o){return r.ra.add(o.toString())});var i=this.persistence.Sr();return i.rr(t,n.targetId).next(function(o){o.forEach(function(s){return r.ra.add(s.toString())})}).next(function(){return i.Ji(t,n)})},e.prototype.Zc=function(){this.sa=new Set},e.prototype.ta=function(t){var n=this,r=this.persistence.$r().Nr();return E.forEach(this.ra,function(i){var o=x._t(i);return n.oa(t,o).next(function(s){s||r.li(o)})}).next(function(){return n.sa=null,r.apply(t)})},e.prototype.Fr=function(t,n){var r=this;return this.oa(t,n).next(function(i){i?r.ra.delete(n.toString()):r.ra.add(n.toString())})},e.prototype.Xc=function(t){return 0},e.prototype.oa=function(t,n){var r=this;return E.Ln([function(){return E.resolve(r.na.Fi(n))},function(){return r.persistence.Sr().Fi(t,n)},function(){return r.persistence.ea(t,n)}])},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(e,t){return"firestore_clients_"+e+"_"+t}function Mu(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.m()&&(r+="_"+t.uid),r}function ji(e,t){return"firestore_targets_"+e+"_"+t}var Fu=function(){function e(t,n,r,i){this.user=t,this.batchId=n,this.state=r,this.error=i}return e.ca=function(t,n,r){var i,o=JSON.parse(r),s=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return s&&o.error&&(s=typeof o.error.message=="string"&&typeof o.error.code=="string")&&(i=new b(o.error.code,o.error.message)),s?new e(t,n,o.state,i):(W("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),qi=function(){function e(t,n,r){this.targetId=t,this.state=n,this.error=r}return e.ca=function(t,n){var r,i=JSON.parse(n),o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string")&&(r=new b(i.error.code,i.error.message)),o?new e(t,i.state,r):(W("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},e}(),Uu=function(){function e(t,n){this.clientId=t,this.activeTargetIds=n}return e.ca=function(t,n){for(var r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=yi(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ic(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new e(t,o):(W("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Md=function(){function e(t,n){this.clientId=t,this.onlineState=n}return e.ca=function(t){var n=JSON.parse(t);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new e(n.clientId,n.onlineState):(W("SharedClientState","Failed to parse online state: "+t),null)},e}(),fo=function(){function e(){this.activeTargetIds=yi()}return e.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},e.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},e.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},e}(),zi=function(){function e(t,n,r,i,o){this.window=t,this.Zr=n,this.persistenceKey=r,this.la=i,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new lt(L),this.Er=!1,this.Ta=[];var s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ia=Vu(this.persistenceKey,this.la),this.ma=function(u){return"firestore_sequence_number_"+u}(this.persistenceKey),this.Ea=this.Ea.zt(this.la,new fo),this.Aa=new RegExp("^firestore_clients_"+s+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+s+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+s+"_(\\d+)$"),this.ya=function(u){return"firestore_online_state_"+u}(this.persistenceKey),this.ga=function(u){return"firestore_bundle_loaded_"+u}(this.persistenceKey),this.window.addEventListener("storage",this.da)}return e.Kn=function(t){return!(!t||!t.localStorage)},e.prototype.start=function(){return m(this,void 0,void 0,function(){var t,n,r,i,o,s,u,a,c,h,f,l=this;return g(this,function(p){switch(p.label){case 0:return[4,this._a.Uo()];case 1:for(t=p.sent(),n=0,r=t;n<r.length;n++)(i=r[n])!==this.la&&(o=this.getItem(Vu(this.persistenceKey,i)))&&(s=Uu.ca(i,o))&&(this.Ea=this.Ea.zt(s.clientId,s));for(this.Va(),(u=this.storage.getItem(this.ya))&&(a=this.pa(u))&&this.ba(a),c=0,h=this.Ta;c<h.length;c++)f=h[c],this.wa(f);return this.Ta=[],this.window.addEventListener("unload",function(){return l.ko()}),this.Er=!0,[2]}})})},e.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},e.prototype.va=function(){return this.Sa(this.Ea)},e.prototype.Da=function(t){var n=!1;return this.Ea.forEach(function(r,i){i.activeTargetIds.has(t)&&(n=!0)}),n},e.prototype.Ca=function(t){this.xa(t,"pending")},e.prototype.Na=function(t,n,r){this.xa(t,n,r),this.$a(t)},e.prototype.Fa=function(t){var n="not-current";if(this.Da(t)){var r=this.storage.getItem(ji(this.persistenceKey,t));if(r){var i=qi.ca(t,r);i&&(n=i.state)}}return this.Oa.ua(t),this.Va(),n},e.prototype.ka=function(t){this.Oa.ha(t),this.Va()},e.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},e.prototype.La=function(t){this.removeItem(ji(this.persistenceKey,t))},e.prototype.Ba=function(t,n,r){this.qa(t,n,r)},e.prototype.Ua=function(t,n,r){var i=this;n.forEach(function(o){i.$a(o)}),this.currentUser=t,r.forEach(function(o){i.Ca(o)})},e.prototype.Qa=function(t){this.Ka(t)},e.prototype.Wa=function(){this.ja()},e.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},e.prototype.getItem=function(t){var n=this.storage.getItem(t);return I("SharedClientState","READ",t,n),n},e.prototype.setItem=function(t,n){I("SharedClientState","SET",t,n),this.storage.setItem(t,n)},e.prototype.removeItem=function(t){I("SharedClientState","REMOVE",t),this.storage.removeItem(t)},e.prototype.wa=function(t){var n=this,r=t;if(r.storageArea===this.storage){if(I("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Ia)return void W("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Zr.po(function(){return m(n,void 0,void 0,function(){var i,o,s,u,a,c;return g(this,function(h){if(this.Er){if(r.key!==null){if(this.Aa.test(r.key)){if(r.newValue==null)return i=this.Ga(r.key),[2,this.za(i,null)];if(o=this.Ha(r.key,r.newValue))return[2,this.za(o.clientId,o)]}else if(this.Ra.test(r.key)){if(r.newValue!==null&&(s=this.Ja(r.key,r.newValue)))return[2,this.Ya(s)]}else if(this.Pa.test(r.key)){if(r.newValue!==null&&(u=this.Xa(r.key,r.newValue)))return[2,this.Za(u)]}else if(r.key===this.ya){if(r.newValue!==null&&(a=this.pa(r.newValue)))return[2,this.ba(a)]}else if(r.key===this.ma)(c=function(f){var l=Dt.q;if(f!=null)try{var p=JSON.parse(f);P(typeof p=="number"),l=p}catch(d){W("SharedClientState","Failed to read sequence number from WebStorage",d)}return l}(r.newValue))!==Dt.q&&this.k(c);else if(r.key===this.ga)return[2,this._a.tu()]}}else this.Ta.push(r);return[2]})})})}},Object.defineProperty(e.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),e.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},e.prototype.xa=function(t,n,r){var i=new Fu(this.currentUser,t,n,r),o=Mu(this.persistenceKey,this.currentUser,t);this.setItem(o,i.aa())},e.prototype.$a=function(t){var n=Mu(this.persistenceKey,this.currentUser,t);this.removeItem(n)},e.prototype.Ka=function(t){var n={clientId:this.la,onlineState:t};this.storage.setItem(this.ya,JSON.stringify(n))},e.prototype.qa=function(t,n,r){var i=ji(this.persistenceKey,t),o=new qi(t,n,r);this.setItem(i,o.aa())},e.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},e.prototype.Ga=function(t){var n=this.Aa.exec(t);return n?n[1]:null},e.prototype.Ha=function(t,n){var r=this.Ga(t);return Uu.ca(r,n)},e.prototype.Ja=function(t,n){var r=this.Ra.exec(t),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Fu.ca(new Nt(o),i,n)},e.prototype.Xa=function(t,n){var r=this.Pa.exec(t),i=Number(r[1]);return qi.ca(i,n)},e.prototype.pa=function(t){return Md.ca(t)},e.prototype.Ya=function(t){return m(this,void 0,void 0,function(){return g(this,function(n){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(I("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},e.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},e.prototype.za=function(t,n){var r=this,i=n?this.Ea.zt(t,n):this.Ea.remove(t),o=this.Sa(this.Ea),s=this.Sa(i),u=[],a=[];return s.forEach(function(c){o.has(c)||u.push(c)}),o.forEach(function(c){s.has(c)||a.push(c)}),this._a.su(u,a).then(function(){r.Ea=i})},e.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},e.prototype.Sa=function(t){var n=yi();return t.forEach(function(r,i){n=n.Pe(i.activeTargetIds)}),n},e}(),yh=function(){function e(){this.iu=new fo,this.ru={},this.fa=null,this.k=null}return e.prototype.Ca=function(t){},e.prototype.Na=function(t,n,r){},e.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},e.prototype.Ba=function(t,n,r){this.ru[t]=n},e.prototype.ka=function(t){this.iu.ha(t)},e.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},e.prototype.La=function(t){delete this.ru[t]},e.prototype.va=function(){return this.iu.activeTargetIds},e.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},e.prototype.start=function(){return this.iu=new fo,Promise.resolve()},e.prototype.Ua=function(t,n,r){},e.prototype.Qa=function(t){},e.prototype.ko=function(){},e.prototype.B=function(t){},e.prototype.Wa=function(){},e}(),Fd=function(){function e(){}return e.prototype.ou=function(t){},e.prototype.ko=function(){},e}(),ju=function(){function e(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}return e.prototype.ou=function(t){this.lu.push(t)},e.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},e.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},e.prototype.au=function(){I("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,n=this.lu;t<n.length;t++)(0,n[t])(0)},e.prototype.hu=function(){I("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,n=this.lu;t<n.length;t++)(0,n[t])(1)},e.Kn=function(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0},e}(),Ud={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},jd=function(){function e(t){this.fu=t.fu,this.du=t.du}return e.prototype.wu=function(t){this.Eu=t},e.prototype.Tu=function(t){this.Iu=t},e.prototype.onMessage=function(t){this.mu=t},e.prototype.close=function(){this.du()},e.prototype.send=function(t){this.fu(t)},e.prototype.Au=function(){this.Eu()},e.prototype.Ru=function(t){this.Iu(t)},e.prototype.Pu=function(t){this.mu(t)},e}(),qd=function(e){function t(n){var r=this;return(r=e.call(this,n)||this).forceLongPolling=n.forceLongPolling,r.i=n.i,r}return N(t,e),t.prototype.Su=function(n,r,i,o){return new Promise(function(s,u){var a=new lp;a.listenOnce(hp.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Fi.NO_ERROR:var h=a.getResponseJson();I("Connection","XHR received:",JSON.stringify(h)),s(h);break;case Fi.TIMEOUT:I("Connection",'RPC "'+n+'" timed out'),u(new b(y.DEADLINE_EXCEEDED,"Request time out"));break;case Fi.HTTP_ERROR:var f=a.getStatus();if(I("Connection",'RPC "'+n+'" failed with status:',f,"response text:",a.getResponseText()),f>0){var l=a.getResponseJson().error;if(l&&l.status&&l.message){var p=function(d){var v=d.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(v)>=0?v:y.UNKNOWN}(l.status);u(new b(p,l.message))}else u(new b(y.UNKNOWN,"Server responded with status "+a.getStatus()))}else u(new b(y.UNAVAILABLE,"Connection failed."));break;default:D()}}finally{I("Connection",'RPC "'+n+'" completed.')}});var c=JSON.stringify(o);a.send(r,"POST",c,i,15)})},t.prototype.Cu=function(n,r){var i=[this.gu,"/","google.firestore.v1.Firestore","/",n,"/channel"],o=ap(),s=cp(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(u.initMessageHeaders,r),gf()||Ef()||_f()||If()||Tf()||bf()||(u.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");I("Connection","Creating WebChannel: "+a,u);var c=o.createWebChannel(a,u),h=!1,f=!1,l=new jd({fu:function(d){f?I("Connection","Not sending because WebChannel is closed:",d):(h||(I("Connection","Opening WebChannel transport."),c.open(),h=!0),I("Connection","WebChannel sending:",d),c.send(d))},du:function(){return c.close()}}),p=function(d,v,w){d.listen(v,function(_){try{w(_)}catch(S){setTimeout(function(){throw S},0)}})};return p(c,yr.EventType.OPEN,function(){f||I("Connection","WebChannel transport opened.")}),p(c,yr.EventType.CLOSE,function(){f||(f=!0,I("Connection","WebChannel transport closed"),l.Ru())}),p(c,yr.EventType.ERROR,function(d){f||(f=!0,io("Connection","WebChannel transport errored:",d),l.Ru(new b(y.UNAVAILABLE,"The operation could not be completed")))}),p(c,yr.EventType.MESSAGE,function(d){var v;if(!f){var w=d.data[0];P(!!w);var _=w,S=_.error||((v=_[0])===null||v===void 0?void 0:v.error);if(S){I("Connection","WebChannel received error:",S);var A=S.status,C=function(V){var J=Q[V];if(J!==void 0)return Uc(J)}(A),M=S.message;C===void 0&&(C=y.INTERNAL,M="Unknown error status: "+A+" with message "+S.message),f=!0,l.Ru(new b(C,M)),c.close()}else I("Connection","WebChannel received:",w),l.Pu(w)}}),p(s,fp.STAT_EVENT,function(d){d.stat===eu.PROXY?I("Connection","Detected buffering proxy"):d.stat===eu.NOPROXY&&I("Connection","Detected no buffering proxy")}),setTimeout(function(){l.Au()},0),l},t}(function(){function e(t){this.yu=t,this.t=t.t;var n=t.ssl?"https":"http";this.gu=n+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return e.prototype.pu=function(t,n,r,i){var o=this.bu(t,n);I("RestConnection","Sending: ",o,r);var s={};return this.vu(s,i),this.Su(t,o,s,r).then(function(u){return I("RestConnection","Received: ",u),u},function(u){throw io("RestConnection",t+" failed with error: ",u,"url: ",o,"request:",r),u})},e.prototype.Du=function(t,n,r,i){return this.pu(t,n,r,i)},e.prototype.vu=function(t,n){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.9",t["Content-Type"]="text/plain",n)for(var r in n.g)n.g.hasOwnProperty(r)&&(t[r]=n.g[r])},e.prototype.bu=function(t,n){var r=Ud[t];return this.gu+"/v1/"+n+":"+r},e}());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gh(){return typeof window!="undefined"?window:null}function Ar(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(e){return new $p(e,!0)}var ds=function(){function e(t,n,r,i,o){r===void 0&&(r=1e3),i===void 0&&(i=1.5),o===void 0&&(o=6e4),this.Zr=t,this.fs=n,this.xu=r,this.Nu=i,this.$u=o,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}return e.prototype.reset=function(){this.Fu=0},e.prototype.Mu=function(){this.Fu=this.$u},e.prototype.Lu=function(t){var n=this;this.cancel();var r=Math.floor(this.Fu+this.Bu()),i=Math.max(0,Date.now()-this.ku),o=Math.max(0,r-i);o>0&&I("ExponentialBackoff","Backing off for "+o+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+r+" ms, last attempt: "+i+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,o,function(){return n.ku=Date.now(),t()}),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},e.prototype.qu=function(){this.Ou!==null&&(this.Ou.Rs(),this.Ou=null)},e.prototype.cancel=function(){this.Ou!==null&&(this.Ou.cancel(),this.Ou=null)},e.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},e}(),mh=function(){function e(t,n,r,i,o,s){this.Zr=t,this.Uu=r,this.Qu=i,this.Ku=o,this.listener=s,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new ds(t,n)}return e.prototype.zu=function(){return this.state===1||this.state===2||this.state===4},e.prototype.Hu=function(){return this.state===2},e.prototype.start=function(){this.state!==3?this.auth():this.Ju()},e.prototype.stop=function(){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.Yu=function(){this.state=0,this.Gu.reset()},e.prototype.Xu=function(){var t=this;this.Hu()&&this.ju===null&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},e.prototype.th=function(t){this.eh(),this.stream.send(t)},e.prototype.Zu=function(){return m(this,void 0,void 0,function(){return g(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},e.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},e.prototype.close=function(t,n){return m(this,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,t!==3?this.Gu.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(W(n.toString()),W("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):n&&n.code===y.UNAUTHENTICATED&&this.Ku.p(),this.stream!==null&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(n)];case 1:return r.sent(),[2]}})})},e.prototype.nh=function(){},e.prototype.auth=function(){var t=this;this.state=1;var n=this.sh(this.Wu),r=this.Wu;this.Ku.getToken().then(function(i){t.Wu===r&&t.ih(i)},function(i){n(function(){var o=new b(y.UNKNOWN,"Fetching auth token failed: "+i.message);return t.rh(o)})})},e.prototype.ih=function(t){var n=this,r=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){r(function(){return n.state=2,n.listener.wu()})}),this.stream.Tu(function(i){r(function(){return n.rh(i)})}),this.stream.onMessage(function(i){r(function(){return n.onMessage(i)})})},e.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu(function(){return m(t,void 0,void 0,function(){return g(this,function(n){return this.state=0,this.start(),[2]})})})},e.prototype.rh=function(t){return I("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},e.prototype.sh=function(t){var n=this;return function(r){n.Zr.Ps(function(){return n.Wu===t?r():(I("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},e}(),zd=function(e){function t(n,r,i,o,s){var u=this;return(u=e.call(this,n,"listen_stream_connection_backoff","listen_stream_idle",r,i,s)||this).Qt=o,u}return N(t,e),t.prototype.oh=function(n){return this.Qu.Cu("Listen",n)},t.prototype.onMessage=function(n){this.Gu.reset();var r=function(o,s){var u;if("targetChange"in s){s.targetChange;var a=function(w){return w==="NO_CHANGE"?0:w==="ADD"?1:w==="REMOVE"?2:w==="CURRENT"?3:w==="RESET"?4:D()}(s.targetChange.targetChangeType||"NO_CHANGE"),c=s.targetChange.targetIds||[],h=function(w,_){return w.Bt?(P(_===void 0||typeof _=="string"),_t.fromBase64String(_||"")):(P(_===void 0||_ instanceof Uint8Array),_t.fromUint8Array(_||new Uint8Array))}(o,s.targetChange.resumeToken),f=(l=s.targetChange.cause)&&function(w){var _=w.code===void 0?y.UNKNOWN:Uc(w.code);return new b(_,w.message||"")}(l);u=new zc(a,c,h,f||null)}else if("documentChange"in s){s.documentChange,(a=s.documentChange).document,a.document.name,a.document.updateTime,c=Gt(o,a.document.name),h=mt(a.document.updateTime);var l=new he({mapValue:{fields:a.document.fields}}),p=(f=new B(c,h,l,{}),a.targetIds||[]),d=a.removedTargetIds||[];u=new Nr(p,d,f.key,f)}else if("documentDelete"in s)s.documentDelete,(a=s.documentDelete).document,c=Gt(o,a.document),h=a.readTime?mt(a.readTime):R.min(),l=new rt(c,h),f=a.removedTargetIds||[],u=new Nr([],f,l.key,l);else if("documentRemove"in s)s.documentRemove,(a=s.documentRemove).document,c=Gt(o,a.document),h=a.removedTargetIds||[],u=new Nr([],h,c,null);else{if(!("filter"in s))return D();s.filter;var v=s.filter;v.targetId,a=v.count||0,c=new Vp(a),h=v.targetId,u=new qc(h,c)}return u}(this.Qt,n),i=function(o){if(!("targetChange"in o))return R.min();var s=o.targetChange;return s.targetIds&&s.targetIds.length?R.min():s.readTime?mt(s.readTime):R.min()}(n);return this.listener.ah(r,i)},t.prototype.uh=function(n){var r={};r.database=zn(this.Qt),r.addTarget=function(o,s){var u,a=s.target;return(u=qr(a)?{documents:Yc(o,a)}:{query:Kc(o,a)}).targetId=s.targetId,s.resumeToken.l()>0?u.resumeToken=Bc(o,s.resumeToken):s.Ot._(R.min())>0&&(u.readTime=jn(o,s.Ot.j())),u}(this.Qt,n);var i=function(o,s){var u=function(a,c){switch(c){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return D()}}(0,s.Ft);return u==null?null:{"goog-listen-tags":u}}(this.Qt,n);i&&(r.labels=i),this.th(r)},t.prototype.hh=function(n){var r={};r.database=zn(this.Qt),r.removeTarget=n,this.th(r)},t}(mh),Bd=function(e){function t(n,r,i,o,s){var u=this;return(u=e.call(this,n,"write_stream_connection_backoff","write_stream_idle",r,i,s)||this).Qt=o,u.lh=!1,u}return N(t,e),Object.defineProperty(t.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.nh=function(){this.lh&&this.fh([])},t.prototype.oh=function(n){return this.Qu.Cu("Write",n)},t.prototype.onMessage=function(n){if(P(!!n.streamToken),this.lastStreamToken=n.streamToken,this.lh){this.Gu.reset();var r=function(o,s){return o&&o.length>0?(P(s!==void 0),o.map(function(u){return function(a,c){var h=a.updateTime?mt(a.updateTime):mt(c);h.isEqual(R.min())&&(h=mt(c));var f=null;return a.transformResults&&a.transformResults.length>0&&(f=a.transformResults),new Cp(h,f)}(u,s)})):[]}(n.writeResults,n.commitTime),i=mt(n.commitTime);return this.listener.dh(i,r)}return P(!n.writeResults||n.writeResults.length===0),this.lh=!0,this.listener.wh()},t.prototype.Eh=function(){var n={};n.database=zn(this.Qt),this.th(n)},t.prototype.fh=function(n){var r=this,i={streamToken:this.lastStreamToken,writes:n.map(function(o){return $r(r.Qt,o)})};this.th(i)},t}(mh),Gd=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).credentials=n,o.Qu=r,o.Qt=i,o.Th=!1,o}return N(t,e),t.prototype.Ih=function(){if(this.Th)throw new b(y.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.pu=function(n,r,i){var o=this;return this.Ih(),this.credentials.getToken().then(function(s){return o.Qu.pu(n,r,i,s)}).catch(function(s){throw s.code===y.UNAUTHENTICATED&&o.credentials.p(),s})},t.prototype.Du=function(n,r,i){var o=this;return this.Ih(),this.credentials.getToken().then(function(s){return o.Qu.Du(n,r,i,s)}).catch(function(s){throw s.code===y.UNAUTHENTICATED&&o.credentials.p(),s})},t.prototype.terminate=function(){this.Th=!1},t}(function(){}),Hd=function(){function e(t,n){this._s=t,this.fa=n,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}return e.prototype.Ph=function(){var t=this;this.mh===0&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},e.prototype.Vh=function(t){this.state==="Online"?this.yh("Unknown"):(this.mh++,this.mh>=1&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},e.prototype.set=function(t){this.ph(),this.mh=0,t==="Online"&&(this.Rh=!1),this.yh(t)},e.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},e.prototype.gh=function(t){var n="Could not reach Cloud Firestore backend. "+t+`
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Rh?(W(n),this.Rh=!1):I("OnlineStateTracker",n)},e.prototype.ph=function(){this.Ah!==null&&(this.Ah.cancel(),this.Ah=null)},e}(),$d=function(e,t,n,r,i){var o=this;this.bh=e,this.Sh=t,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou(function(s){n.Ps(function(){return m(o,void 0,void 0,function(){return g(this,function(u){switch(u.label){case 0:return ye(this)?(I("RemoteStore","Restarting streams for network reachability change."),[4,function(a){return m(this,void 0,void 0,function(){var c;return g(this,function(h){switch(h.label){case 0:return(c=T(a)).Nh.add(4),[4,wn(c)];case 1:return h.sent(),c.Oh.set("Unknown"),c.Nh.delete(4),[4,fr(c)];case 2:return h.sent(),[2]}})})}(this)]):[3,2];case 1:u.sent(),u.label=2;case 2:return[2]}})})})}),this.Oh=new Hd(n,r)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(e){return m(this,void 0,void 0,function(){var t,n;return g(this,function(r){switch(r.label){case 0:if(!ye(e))return[3,4];t=0,n=e.$h,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function wn(e){return m(this,void 0,void 0,function(){var t,n;return g(this,function(r){switch(r.label){case 0:t=0,n=e.$h,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}})})}function mi(e,t){var n=T(e);n.xh.has(t.targetId)||(n.xh.set(t.targetId,t),gs(n)?ys(n):En(n).Hu()&&vs(n,t))}function Bn(e,t){var n=T(e),r=En(n);n.xh.delete(t),r.Hu()&&wh(n,t),n.xh.size===0&&(r.Hu()?r.Xu():ye(n)&&n.Oh.set("Unknown"))}function vs(e,t){e.kh.on(t.targetId),En(e).uh(t)}function wh(e,t){e.kh.on(t),En(e).hh(t)}function ys(e){e.kh=new Bp({vn:function(t){return e.Dh.vn(t)},Sn:function(t){return e.xh.get(t)||null}}),En(e).start(),e.Oh.Ph()}function gs(e){return ye(e)&&!En(e).zu()&&e.xh.size>0}function ye(e){return T(e).Nh.size===0}function bh(e){e.kh=void 0}function Yd(e){return m(this,void 0,void 0,function(){return g(this,function(t){return e.xh.forEach(function(n,r){vs(e,n)}),[2]})})}function Kd(e,t){return m(this,void 0,void 0,function(){return g(this,function(n){return bh(e),gs(e)?(e.Oh.Vh(t),ys(e)):e.Oh.set("Unknown"),[2]})})}function Qd(e,t,n){return m(this,void 0,void 0,function(){var r,i,o;return g(this,function(s){switch(s.label){case 0:if(e.Oh.set("Online"),!(t instanceof zc&&t.state===2&&t.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(u,a){return m(this,void 0,void 0,function(){var c,h,f,l;return g(this,function(p){switch(p.label){case 0:c=a.cause,h=0,f=a.targetIds,p.label=1;case 1:return h<f.length?(l=f[h],u.xh.has(l)?[4,u.Dh.Mh(l,c)]:[3,3]):[3,5];case 2:p.sent(),u.xh.delete(l),u.kh.removeTarget(l),p.label=3;case 3:p.label=4;case 4:return h++,[3,1];case 5:return[2]}})})}(e,t)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),I("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,Wr(e,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Nr?e.kh.dn(t):t instanceof qc?e.kh.Pn(t):e.kh.Tn(t),n.isEqual(R.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,ph(e.bh)];case 8:return i=s.sent(),n._(i)>=0?[4,function(u,a){var c=u.kh.Vn(a);return c.$e.forEach(function(h,f){if(h.resumeToken.l()>0){var l=u.xh.get(f);l&&u.xh.set(f,l.Mt(h.resumeToken,a))}}),c.Fe.forEach(function(h){var f=u.xh.get(h);if(f){u.xh.set(h,f.Mt(_t.T,f.Ot)),wh(u,h);var l=new pi(f.target,h,1,f.sequenceNumber);vs(u,l)}}),u.Dh.Lh(c)}(e,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return I("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Wr(e,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}function Wr(e,t,n){return m(this,void 0,void 0,function(){var r=this;return g(this,function(i){switch(i.label){case 0:if(!Le(t))throw t;return e.Nh.add(1),[4,wn(e)];case 1:return i.sent(),e.Oh.set("Offline"),n||(n=function(){return ph(e.bh)}),e._s.po(function(){return m(r,void 0,void 0,function(){return g(this,function(o){switch(o.label){case 0:return I("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return o.sent(),e.Nh.delete(1),[4,fr(e)];case 2:return o.sent(),[2]}})})}),[2]}})})}function Eh(e,t){return t().catch(function(n){return Wr(e,n,t)})}function bn(e){return m(this,void 0,void 0,function(){var t,n,r,i,o;return g(this,function(s){switch(s.label){case 0:t=T(e),n=le(t),r=t.Ch.length>0?t.Ch[t.Ch.length-1].batchId:-1,s.label=1;case 1:if(!function(u){return ye(u)&&u.Ch.length<10}(t))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,Sd(t.bh,r)];case 3:return(i=s.sent())===null?(t.Ch.length===0&&n.Xu(),[3,7]):(r=i.batchId,function(u,a){u.Ch.push(a);var c=le(u);c.Hu()&&c._h&&c.fh(a.mutations)}(t,i),[3,6]);case 4:return o=s.sent(),[4,Wr(t,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return _h(t)&&Ih(t),[2]}})})}function _h(e){return ye(e)&&!le(e).zu()&&e.Ch.length>0}function Ih(e){le(e).start()}function Xd(e){return m(this,void 0,void 0,function(){return g(this,function(t){return le(e).Eh(),[2]})})}function Wd(e){return m(this,void 0,void 0,function(){var t,n,r,i;return g(this,function(o){for(t=le(e),n=0,r=e.Ch;n<r.length;n++)i=r[n],t.fh(i.mutations);return[2]})})}function Jd(e,t,n){return m(this,void 0,void 0,function(){var r,i;return g(this,function(o){switch(o.label){case 0:return r=e.Ch.shift(),i=ad.from(r,t,n),[4,Eh(e,function(){return e.Dh.Bh(i)})];case 1:return o.sent(),[4,bn(e)];case 2:return o.sent(),[2]}})})}function Zd(e,t){return m(this,void 0,void 0,function(){return g(this,function(n){switch(n.label){case 0:return t&&le(e)._h?[4,function(r,i){return m(this,void 0,void 0,function(){var o,s;return g(this,function(u){switch(u.label){case 0:return Fc(s=i.code)&&s!==y.ABORTED?(o=r.Ch.shift(),le(r).Yu(),[4,Eh(r,function(){return r.Dh.qh(o.batchId,i)})]):[3,3];case 1:return u.sent(),[4,bn(r)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return _h(e)&&Ih(e),[2]}})})}function lo(e,t){return m(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return n=T(e),t?(n.Nh.delete(2),[4,fr(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.Nh.add(2),[4,wn(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function En(e){var t=this;return e.Uh||(e.Uh=function(n,r,i){var o=T(n);return o.Ih(),new zd(r,o.Qu,o.credentials,o.Qt,i)}(e.Sh,e._s,{wu:Yd.bind(null,e),Tu:Kd.bind(null,e),ah:Qd.bind(null,e)}),e.$h.push(function(n){return m(t,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return n?(e.Uh.Yu(),gs(e)?ys(e):e.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Uh.stop()];case 2:r.sent(),bh(e),r.label=3;case 3:return[2]}})})})),e.Uh}function le(e){var t=this;return e.Qh||(e.Qh=function(n,r,i){var o=T(n);return o.Ih(),new Bd(r,o.Qu,o.credentials,o.Qt,i)}(e.Sh,e._s,{wu:Xd.bind(null,e),Tu:Zd.bind(null,e),wh:Wd.bind(null,e),dh:Jd.bind(null,e)}),e.$h.push(function(n){return m(t,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return n?(e.Qh.Yu(),[4,bn(e)]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.Qh.stop()];case 3:r.sent(),e.Ch.length>0&&(I("RemoteStore","Stopping write stream with "+e.Ch.length+" pending writes"),e.Ch=[]),r.label=4;case 4:return[2]}})})})),e.Qh}var tv=function(){this.Kh=void 0,this.listeners=[]},ev=function(){this.queries=new mn(function(e){return Dc(e)},sr),this.onlineState="Unknown",this.Wh=new Set};function ms(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return g(this,function(c){switch(c.label){case 0:if(n=T(e),r=t.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new tv),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),s=o,[4,n.jh(r)];case 2:return s.Kh=c.sent(),[3,4];case 3:return u=c.sent(),a=gn(u,"Initialization of query '"+uo(t.query)+"' failed"),[2,void t.onError(a)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.Gh(n.onlineState),o.Kh&&t.zh(o.Kh)&&bs(n),[2]}})})}function ws(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s;return g(this,function(u){return n=T(e),r=t.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(t))>=0&&(o.listeners.splice(s,1),i=o.listeners.length===0),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]})})}function nv(e,t){for(var n=T(e),r=!1,i=0,o=t;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].zh(s)&&(r=!0);a.Kh=s}}r&&bs(n)}function rv(e,t,n){var r=T(e),i=r.queries.get(t);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(t)}function bs(e){e.Wh.forEach(function(t){t.next()})}var Es=function(){function e(t,n,r){this.query=t,this.Jh=n,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=r||{}}return e.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var n=[],r=0,i=t.docChanges;r<i.length;r++){var o=i[r];o.type!==3&&n.push(o)}t=new Hr(t.query,t.docs,t.Se,n,t.De,t.fromCache,t.Ce,!0)}var s=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),s=!0):this.tl(t,this.onlineState)&&(this.el(t),s=!0),this.Xh=t,s},e.prototype.onError=function(t){this.Jh.error(t)},e.prototype.Gh=function(t){this.onlineState=t;var n=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),n=!0),n},e.prototype.tl=function(t,n){if(!t.fromCache)return!0;var r=n!=="Offline";return!(this.options.nl&&r||t.docs.et()&&n!=="Offline")},e.prototype.Zh=function(t){if(t.docChanges.length>0)return!0;var n=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!n)&&this.options.includeMetadataChanges===!0},e.prototype.el=function(t){t=Hr.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Th=function(e){this.key=e},Nh=function(e){this.key=e},Ah=function(){function e(t,n){this.query=t,this.cl=n,this.al=null,this.Be=!1,this.ul=G(),this.De=G(),this.hl=Oc(t),this.ll=new jc(this.hl)}return Object.defineProperty(e.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),e.prototype.fl=function(t,n){var r=this,i=n?n.dl:new yu,o=n?n.ll:this.ll,s=n?n.De:this.De,u=o,a=!1,c=Ir(this.query)&&o.size===this.query.limit?o.last():null,h=Br(this.query)&&o.size===this.query.limit?o.first():null;if(t.Xt(function(l,p){var d=o.get(l),v=p instanceof B?p:null;v&&(v=ur(r.query,v)?v:null);var w=!!d&&r.De.has(d.key),_=!!v&&(v.Vt||r.De.has(v.key)&&v.hasCommittedMutations),S=!1;d&&v?d.data().isEqual(v.data())?w!==_&&(i.track({type:3,doc:v}),S=!0):r.wl(d,v)||(i.track({type:2,doc:v}),S=!0,(c&&r.hl(v,c)>0||h&&r.hl(v,h)<0)&&(a=!0)):!d&&v?(i.track({type:0,doc:v}),S=!0):d&&!v&&(i.track({type:1,doc:d}),S=!0,(c||h)&&(a=!0)),S&&(v?(u=u.add(v),s=_?s.add(l):s.delete(l)):(u=u.delete(l),s=s.delete(l)))}),Ir(this.query)||Br(this.query))for(;u.size>this.query.limit;){var f=Ir(this.query)?u.last():u.first();u=u.delete(f.key),s=s.delete(f.key),i.track({type:1,doc:f})}return{ll:u,dl:i,lc:a,De:s}},e.prototype.wl=function(t,n){return t.Vt&&n.hasCommittedMutations&&!n.Vt},e.prototype.wi=function(t,n,r){var i=this,o=this.ll;this.ll=t.ll,this.De=t.De;var s=t.dl.ve();s.sort(function(h,f){return function(l,p){var d=function(v){switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D()}};return d(l)-d(p)}(h.type,f.type)||i.hl(h.doc,f.doc)}),this.El(r);var u=n?this.Tl():[],a=this.ul.size===0&&this.Be?1:0,c=a!==this.al;return this.al=a,s.length!==0||c?{snapshot:new Hr(this.query,t.ll,o,s,t.De,a===0,c,!1),Il:u}:{Il:u}},e.prototype.Gh=function(t){return this.Be&&t==="Offline"?(this.Be=!1,this.wi({ll:this.ll,dl:new yu,De:this.De,lc:!1},!1)):{Il:[]}},e.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},e.prototype.El=function(t){var n=this;t&&(t.qe.forEach(function(r){return n.cl=n.cl.add(r)}),t.Ue.forEach(function(r){}),t.Qe.forEach(function(r){return n.cl=n.cl.delete(r)}),this.Be=t.Be)},e.prototype.Tl=function(){var t=this;if(!this.Be)return[];var n=this.ul;this.ul=G(),this.ll.forEach(function(i){t.ml(i.key)&&(t.ul=t.ul.add(i.key))});var r=[];return n.forEach(function(i){t.ul.has(i)||r.push(new Nh(i))}),this.ul.forEach(function(i){n.has(i)||r.push(new Th(i))}),r},e.prototype.Al=function(t){this.cl=t.Rc,this.ul=G();var n=this.fl(t.documents);return this.wi(n,!0)},e.prototype.Rl=function(){return Hr.Ne(this.query,this.ll,this.De,this.al===0)},e}(),iv=function(e,t,n){this.query=e,this.targetId=t,this.view=n},ov=function(e){this.key=e,this.Pl=!1},sv=function(){function e(t,n,r,i,o,s){this.bh=t,this.yl=n,this.gl=r,this.Vl=i,this.currentUser=o,this.pl=s,this.bl={},this.vl=new mn(function(u){return Dc(u)},sr),this.Sl=new Map,this.Dl=new Set,this.Cl=new lt(x.H),this.xl=new Map,this.Nl=new ps,this.$l={},this.Fl=new Map,this.Ol=Kr.Li(),this.onlineState="Unknown",this.kl=void 0}return Object.defineProperty(e.prototype,"Ml",{get:function(){return this.kl===!0},enumerable:!1,configurable:!0}),e}();function uv(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u;return g(this,function(a){switch(a.label){case 0:return n=As(e),(o=n.vl.get(t))?(r=o.targetId,n.Vl.Fa(r),i=o.view.Rl(),[3,4]):[3,1];case 1:return[4,Qr(n.bh,qt(t))];case 2:return s=a.sent(),u=n.Vl.Fa(s.targetId),r=s.targetId,[4,_s(n,t,r,u==="current")];case 3:i=a.sent(),n.Ml&&mi(n.yl,s),a.label=4;case 4:return[2,i]}})})}function _s(e,t,n,r){return m(this,void 0,void 0,function(){var i,o,s,u,a,c;return g(this,function(h){switch(h.label){case 0:return e.Ll=function(f,l,p){return function(d,v,w,_){return m(this,void 0,void 0,function(){var S,A,C;return g(this,function(M){switch(M.label){case 0:return S=v.view.fl(w),S.lc?[4,Xr(d.bh,v.query,!1).then(function(V){var J=V.documents;return v.view.fl(J,S)})]:[3,2];case 1:S=M.sent(),M.label=2;case 2:return A=_&&_.$e.get(v.targetId),C=v.view.wi(S,d.Ml,A),[2,(po(d,v.targetId,C.Il),C.snapshot)]}})})}(e,f,l,p)},[4,Xr(e.bh,t,!0)];case 1:return i=h.sent(),o=new Ah(t,i.Rc),s=o.fl(i.documents),u=ss.Le(n,r&&e.onlineState!=="Offline"),a=o.wi(s,e.Ml,u),po(e,n,a.Il),c=new iv(t,n,o),[2,(e.vl.set(t,c),e.Sl.has(n)?e.Sl.get(n).push(t):e.Sl.set(n,[t]),a.snapshot)]}})})}function av(e,t){return m(this,void 0,void 0,function(){var n,r,i;return g(this,function(o){switch(o.label){case 0:return n=T(e),r=n.vl.get(t),(i=n.Sl.get(r.targetId)).length>1?[2,(n.Sl.set(r.targetId,i.filter(function(s){return!sr(s,t)})),void n.vl.delete(t))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,hn(n.bh,r.targetId,!1).then(function(){n.Vl.La(r.targetId),Bn(n.yl,r.targetId),fn(n,r.targetId)}).catch(Ve)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return fn(n,r.targetId),[4,hn(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}function cv(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return g(this,function(u){switch(u.label){case 0:r=Ss(e),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(a,c){var h,f=T(a),l=Et.now(),p=c.reduce(function(d,v){return d.add(v.key)},G());return f.persistence.runTransaction("Locally write mutations","readwrite",function(d){return f.Tc.Xo(d,p).next(function(v){h=v;for(var w=[],_=0,S=c;_<S.length;_++){var A=S[_],C=Lp(A,h.get(A.key));C!=null&&w.push(new ve(A.key,C,Tc(C.proto.mapValue),ct.exists(!0)))}return f.zo.Ri(d,l,w,c)})}).then(function(d){var v=d.xs(h);return{batchId:d.batchId,ri:v}})}(r.bh,t)];case 2:return i=u.sent(),r.Vl.Ca(i.batchId),function(a,c,h){var f=a.$l[a.currentUser.A()];f||(f=new lt(L)),f=f.zt(c,h),a.$l[a.currentUser.A()]=f}(r,i.batchId,n),[4,ge(r,i.ri)];case 3:return u.sent(),[4,bn(r.yl)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=gn(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}function Sh(e,t){return m(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:n=T(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Nd(n.bh,t)];case 2:return r=i.sent(),t.$e.forEach(function(o,s){var u=n.xl.get(s);u&&(P(o.qe.size+o.Ue.size+o.Qe.size<=1),o.qe.size>0?u.Pl=!0:o.Ue.size>0?P(u.Pl):o.Qe.size>0&&(P(u.Pl),u.Pl=!1))}),[4,ge(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,Ve(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function qu(e,t,n){var r=T(e);if(r.Ml&&n===0||!r.Ml&&n===1){var i=[];r.vl.forEach(function(o,s){var u=s.view.Gh(t);u.snapshot&&i.push(u.snapshot)}),function(o,s){var u=T(o);u.onlineState=s;var a=!1;u.queries.forEach(function(c,h){for(var f=0,l=h.listeners;f<l.length;f++)l[f].Gh(s)&&(a=!0)}),a&&bs(u)}(r.gl,t),i.length&&r.bl.ah(i),r.onlineState=t,r.Ml&&r.Vl.Qa(t)}}function hv(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a;return g(this,function(c){switch(c.label){case 0:return(r=T(e)).Vl.Ba(t,"rejected",n),i=r.xl.get(t),(o=i&&i.key)?(s=(s=new lt(x.H)).zt(o,new rt(o,R.min())),u=G().add(o),a=new os(R.min(),new Map,new tt(L),s,u),[4,Sh(r,a)]):[3,2];case 1:return c.sent(),r.Cl=r.Cl.remove(o),r.xl.delete(t),Ns(r),[3,4];case 2:return[4,hn(r.bh,t,!1).then(function(){return fn(r,t,n)}).catch(Ve)];case 3:c.sent(),c.label=4;case 4:return[2]}})})}function fv(e,t){return m(this,void 0,void 0,function(){var n,r,i;return g(this,function(o){switch(o.label){case 0:n=T(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Td(n.bh,t)];case 2:return i=o.sent(),Ts(n,r,null),Is(n,r),n.Vl.Na(r,"acknowledged"),[4,ge(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ve(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function lv(e,t,n){return m(this,void 0,void 0,function(){var r,i;return g(this,function(o){switch(o.label){case 0:r=T(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(s,u){var a=T(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",function(c){var h;return a.zo.Pi(c,u).next(function(f){return P(f!==null),h=f.keys(),a.zo.Ci(c,f)}).next(function(){return a.zo.$i(c)}).next(function(){return a.Tc.Xo(c,h)})})}(r.bh,t)];case 2:return i=o.sent(),Ts(r,t,n),Is(r,t),r.Vl.Na(t,"rejected",n),[4,ge(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ve(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function pv(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s;return g(this,function(u){switch(u.label){case 0:ye((n=T(e)).yl)||I("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(a){var c=T(a);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(h){return c.zo.Vi(h)})}(n.bh)];case 2:return(r=u.sent())===-1?[2,void t.resolve()]:((i=n.Fl.get(r)||[]).push(t),n.Fl.set(r,i),[3,4]);case 3:return o=u.sent(),s=gn(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(s),[3,4];case 4:return[2]}})})}function Is(e,t){(e.Fl.get(t)||[]).forEach(function(n){n.resolve()}),e.Fl.delete(t)}function Ts(e,t,n){var r=T(e),i=r.$l[r.currentUser.A()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.$l[r.currentUser.A()]=i}}function fn(e,t,n){n===void 0&&(n=null),e.Vl.ka(t);for(var r=0,i=e.Sl.get(t);r<i.length;r++){var o=i[r];e.vl.delete(o),n&&e.bl.Bl(o,n)}e.Sl.delete(t),e.Ml&&e.Nl.Fc(t).forEach(function(s){e.Nl.Fi(s)||Dh(e,s)})}function Dh(e,t){e.Dl.delete(t.path.rt());var n=e.Cl.get(t);n!==null&&(Bn(e.yl,n),e.Cl=e.Cl.remove(t),e.xl.delete(n),Ns(e))}function po(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Th?(e.Nl.nr(o.key,t),dv(e,o)):o instanceof Nh?(I("SyncEngine","Document no longer in limbo: "+o.key),e.Nl.ir(o.key,t),e.Nl.Fi(o.key)||Dh(e,o.key)):D()}}function dv(e,t){var n=t.key,r=n.path.rt();e.Cl.get(n)||e.Dl.has(r)||(I("SyncEngine","New document in limbo: "+n),e.Dl.add(r),Ns(e))}function Ns(e){for(;e.Dl.size>0&&e.Cl.size<e.pl;){var t=e.Dl.values().next().value;e.Dl.delete(t);var n=new x(q.ot(t)),r=e.Ol.next();e.xl.set(r,new ov(n)),e.Cl=e.Cl.zt(n,r),mi(e.yl,new pi(qt(or(n.path)),r,2,Dt.q))}}function ge(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s;return g(this,function(u){switch(u.label){case 0:return r=T(e),i=[],o=[],s=[],r.vl.et()?[3,3]:(r.vl.forEach(function(a,c){s.push(r.Ll(c,t,n).then(function(h){if(h){r.Ml&&r.Vl.Ba(c.targetId,h.fromCache?"not-current":"current"),i.push(h);var f=_d.oc(c.targetId,h);o.push(f)}}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.bl.ah(i),[4,function(a,c){return m(this,void 0,void 0,function(){var h,f,l,p,d,v,w,_,S;return g(this,function(A){switch(A.label){case 0:h=T(a),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,h.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(C){return E.forEach(c,function(M){return E.forEach(M.ic,function(V){return h.persistence.Ti.nr(C,M.targetId,V)}).next(function(){return E.forEach(M.rc,function(V){return h.persistence.Ti.ir(C,M.targetId,V)})})})})];case 2:return A.sent(),[3,4];case 3:if(!Le(f=A.sent()))throw f;return I("LocalStore","Failed to update sequence numbers: "+f),[3,4];case 4:for(l=0,p=c;l<p.length;l++)d=p[l],v=d.targetId,d.fromCache||(w=h.fc.get(v),_=w.Ot,S=w.Lt(_),h.fc=h.fc.zt(v,S));return[2]}})})}(r.bh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function vv(e,t){return m(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return(n=T(e)).currentUser.isEqual(t)?[3,3]:(I("SyncEngine","User change. New user:",t.A()),[4,lh(n.bh,t)]);case 1:return r=i.sent(),n.currentUser=t,function(o,s){o.Fl.forEach(function(u){u.forEach(function(a){a.reject(new b(y.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Fl.clear()}(n),n.Vl.Ua(t,r.mc,r.Ac),[4,ge(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}function yv(e,t){var n=T(e),r=n.xl.get(t);if(r&&r.Pl)return G().add(r.key);var i=G(),o=n.Sl.get(t);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.vl.get(a);i=i.Pe(c.view._l)}return i}function gv(e,t){return m(this,void 0,void 0,function(){var n,r,i;return g(this,function(o){switch(o.label){case 0:return[4,Xr((n=T(e)).bh,t.query,!0)];case 1:return r=o.sent(),i=t.view.Al(r),[2,(n.Ml&&po(n,t.targetId,i.Il),i)]}})})}function mv(e){return m(this,void 0,void 0,function(){var t;return g(this,function(n){return[2,vh((t=T(e)).bh).then(function(r){return ge(t,r)})]})})}function wv(e,t,n,r){return m(this,void 0,void 0,function(){var i,o;return g(this,function(s){switch(s.label){case 0:return[4,function(u,a){var c=T(u),h=T(c.zo);return c.persistence.runTransaction("Lookup mutation documents","readonly",function(f){return h.yi(f,a).next(function(l){return l?c.Tc.Xo(f,l):E.resolve(null)})})}((i=T(e)).bh,t)];case 1:return(o=s.sent())===null?[3,6]:n!=="pending"?[3,3]:[4,bn(i.yl)];case 2:return s.sent(),[3,4];case 3:n==="acknowledged"||n==="rejected"?(Ts(i,t,r||null),Is(i,t),function(u,a){T(T(u).zo).xi(a)}(i.bh,t)):D(),s.label=4;case 4:return[4,ge(i,o)];case 5:return s.sent(),[3,7];case 6:I("SyncEngine","Cannot apply mutation batch with id: "+t),s.label=7;case 7:return[2]}})})}function bv(e,t){return m(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return g(this,function(h){switch(h.label){case 0:return As(n=T(e)),Ss(n),t!==!0||n.kl===!0?[3,3]:(r=n.Vl.va(),[4,zu(n,r.it())]);case 1:return i=h.sent(),n.kl=!0,[4,lo(n.yl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],mi(n.yl,u);return[3,7];case 3:return t!==!1||n.kl===!1?[3,7]:(a=[],c=Promise.resolve(),n.Sl.forEach(function(f,l){n.Vl.Ma(l)?a.push(l):c=c.then(function(){return fn(n,l),hn(n.bh,l,!0)}),Bn(n.yl,l)}),[4,c]);case 4:return h.sent(),[4,zu(n,a)];case 5:return h.sent(),function(f){var l=T(f);l.xl.forEach(function(p,d){Bn(l.yl,d)}),l.Nl.Oc(),l.xl=new Map,l.Cl=new lt(x.H)}(n),n.kl=!1,[4,lo(n.yl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}})})}function zu(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f,l,p,d,v,w;return g(this,function(_){switch(_.label){case 0:r=T(e),i=[],o=[],s=0,u=t,_.label=1;case 1:return s<u.length?(a=u[s],c=void 0,(h=r.Sl.get(a))&&h.length!==0?[4,Qr(r.bh,qt(h[0]))]:[3,7]):[3,13];case 2:c=_.sent(),f=0,l=h,_.label=3;case 3:return f<l.length?(p=l[f],d=r.vl.get(p),[4,gv(r,d)]):[3,6];case 4:(v=_.sent()).snapshot&&o.push(v.snapshot),_.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,dh(r.bh,a)];case 8:return w=_.sent(),[4,Qr(r.bh,w)];case 9:return c=_.sent(),[4,_s(r,Oh(w),a,!1)];case 10:_.sent(),_.label=11;case 11:i.push(c),_.label=12;case 12:return s++,[3,1];case 13:return[2,(r.bl.ah(o),i)]}})})}function Oh(e){return Ac(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Ev(e){var t=T(e);return T(T(t.bh).persistence).Uo()}function _v(e,t,n,r){return m(this,void 0,void 0,function(){var i,o,s;return g(this,function(u){switch(u.label){case 0:return(i=T(e)).kl?(I("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,vh(i.bh)];case 3:return o=u.sent(),s=os.Me(t,n==="current"),[4,ge(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,hn(i.bh,t,!0)];case 6:return u.sent(),fn(i,t,r),[3,8];case 7:D(),u.label=8;case 8:return[2]}})})}function Iv(e,t,n){return m(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h,f,l;return g(this,function(p){switch(p.label){case 0:if(!(r=As(e)).kl)return[3,10];i=0,o=t,p.label=1;case 1:return i<o.length?(s=o[i],r.Sl.has(s)?(I("SyncEngine","Adding an already active target "+s),[3,5]):[4,dh(r.bh,s)]):[3,6];case 2:return u=p.sent(),[4,Qr(r.bh,u)];case 3:return a=p.sent(),[4,_s(r,Oh(u),a.targetId,!1)];case 4:p.sent(),mi(r.yl,a),p.label=5;case 5:return i++,[3,1];case 6:c=function(d){return g(this,function(v){switch(v.label){case 0:return r.Sl.has(d)?[4,hn(r.bh,d,!1).then(function(){Bn(r.yl,d),fn(r,d)}).catch(Ve)]:[3,2];case 1:v.sent(),v.label=2;case 2:return[2]}})},h=0,f=n,p.label=7;case 7:return h<f.length?(l=f[h],[5,c(l)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}})})}function As(e){var t=T(e);return t.yl.Dh.Lh=Sh.bind(null,t),t.yl.Dh.vn=yv.bind(null,t),t.yl.Dh.Mh=hv.bind(null,t),t.bl.ah=nv.bind(null,t.gl),t.bl.Bl=rv.bind(null,t.gl),t}function Ss(e){var t=T(e);return t.yl.Dh.Bh=fv.bind(null,t),t.yl.Dh.qh=lv.bind(null,t),t}var xh=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(t){return m(this,void 0,void 0,function(){return g(this,function(n){switch(n.label){case 0:return this.Qt=gi(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return n.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}})})},e.prototype.zl=function(t){return null},e.prototype.Hl=function(t){return fh(this.persistence,new hh,t.Jl,this.Qt)},e.prototype.jl=function(t){return new Rd(Vd.ia,this.Qt)},e.prototype.Wl=function(t){return new yh},e.prototype.terminate=function(){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}})})},e}(),Ph=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).Yl=n,o.cacheSizeBytes=r,o.forceOwnership=i,o.synchronizeTabs=!1,o}return N(t,e),t.prototype.initialize=function(n){return m(this,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return r.sent(),[4,Dd(this.bh)];case 2:return r.sent(),[4,this.Yl.initialize(this,n)];case 3:return r.sent(),[4,Ss(this.Yl._a)];case 4:return r.sent(),[4,bn(this.Yl.yl)];case 5:return r.sent(),[2]}})})},t.prototype.Hl=function(n){return fh(this.persistence,new hh,n.Jl,this.Qt)},t.prototype.zl=function(n){var r=this.persistence.Ti.lr;return new vd(r,n._s)},t.prototype.jl=function(n){var r=ls(n.yu.t,n.yu.persistenceKey),i=this.cacheSizeBytes!==void 0?Ft.Ys(this.cacheSizeBytes):Ft.ti;return new Ed(this.synchronizeTabs,r,n.clientId,i,n._s,gh(),Ar(),this.Qt,this.Vl,!!this.forceOwnership)},t.prototype.Wl=function(n){return new yh},t}(xh),Tv=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r,!1)||this).Yl=n,i.cacheSizeBytes=r,i.synchronizeTabs=!0,i}return N(t,e),t.prototype.initialize=function(n){return m(this,void 0,void 0,function(){var r,i=this;return g(this,function(o){switch(o.label){case 0:return[4,e.prototype.initialize.call(this,n)];case 1:return o.sent(),r=this.Yl._a,this.Vl instanceof zi?(this.Vl._a={eu:wv.bind(null,r),nu:_v.bind(null,r),su:Iv.bind(null,r),Uo:Ev.bind(null,r),tu:mv.bind(null,r)},[4,this.Vl.start()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.persistence.Ro(function(s){return m(i,void 0,void 0,function(){return g(this,function(u){switch(u.label){case 0:return[4,bv(this.Yl._a,s)];case 1:return u.sent(),this.Gl&&(s&&!this.Gl.Er?this.Gl.start(this.bh):s||this.Gl.stop()),[2]}})})})];case 4:return o.sent(),[2]}})})},t.prototype.Wl=function(n){var r=gh();if(!zi.Kn(r))throw new b(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var i=ls(n.yu.t,n.yu.persistenceKey);return new zi(r,n._s,i,n.clientId,n.Jl)},t}(Ph),vo=function(){function e(){}return e.prototype.initialize=function(t,n){return m(this,void 0,void 0,function(){var r=this;return g(this,function(i){switch(i.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(n),this.yl=this.Zl(n),this.gl=this.t_(n),this._a=this.e_(n,!t.synchronizeTabs),this.Vl.fa=function(o){return qu(r._a,o,1)},this.yl.Dh.n_=vv.bind(null,this._a),[4,lo(this.yl,this._a.Ml)]);case 1:i.sent(),i.label=2;case 2:return[2]}})})},e.prototype.t_=function(t){return new ev},e.prototype.Xl=function(t){var n,r=gi(t.yu.t),i=(n=t.yu,new qd(n));return function(o,s,u){return new Gd(o,s,u)}(t.credentials,i,r)},e.prototype.Zl=function(t){var n,r,i,o,s,u=this;return n=this.bh,r=this.Sh,i=t._s,o=function(a){return qu(u._a,a,0)},s=ju.Kn()?new ju:new Fd,new $d(n,r,i,o,s)},e.prototype.e_=function(t,n){return function(r,i,o,s,u,a,c){var h=new sv(r,i,o,s,u,a);return c&&(h.kl=!0),h}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,n)},e.prototype.terminate=function(){return function(t){return m(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return n=T(t),I("RemoteStore","RemoteStore shutting down."),n.Nh.add(5),[4,wn(n)];case 1:return r.sent(),n.Fh.ko(),n.Oh.set("Unknown"),[2]}})})}(this.yl)},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wi=function(){function e(t){this.observer=t,this.muted=!1}return e.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},e.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},e.prototype.i_=function(){this.muted=!0},e.prototype.s_=function(t,n){var r=this;this.muted||setTimeout(function(){r.muted||t(n)},0)},e}(),$t=function(){function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0;r<t.length;++r)if(t[r].length===0)throw new b(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new Mt(t)}return e.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},e}(),Me=function(e){this._methodName=e},U=function(e){this.d_=e};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(e,t,n){if(!n)throw new b(y.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function Os(e,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new b(y.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function kh(e,t,n,r){if(t===!0&&r===!0)throw new b(y.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function Bu(e){if(!x.wt(e))throw new b(y.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function Gu(e){if(x.wt(e))throw new b(y.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function bi(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if(typeof e=="number"||typeof e=="boolean")return""+e;if(typeof e=="object"){if(e instanceof Array)return"an array";var t=function(n){if(n.constructor){var r=/function\s+([^\s(]+)\s*\(/.exec(n.constructor.toString());if(r&&r.length>1)return r[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return typeof e=="function"?"a function":D()}function z(e,t){if("_delegate"in e&&(e=e.d_),!(e instanceof t)){if(t.name===e.constructor.name)throw new b(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=bi(e);throw new b(y.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function Hu(e,t){if(t<=0)throw new b(y.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $u=function(){function e(t){var n;if(t.host===void 0){if(t.ssl!==void 0)throw new b(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(n=t.ssl)===null||n===void 0||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new b(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,kh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},e}(),Yu=new Map,Gn=function(){function e(t,n){this.w_="(lite)",this.E_=new $u({}),this.T_=!1,t instanceof Fr?(this.I_=t,this.m_=new nu):(this.A_=t,this.I_=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new b(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fr(r.options.projectId)}(t),this.m_=new yp(n))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this.A_)throw new b(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"P_",{get:function(){return this.y_!==void 0},enumerable:!1,configurable:!0}),e.prototype.g_=function(t){if(this.T_)throw new b(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new $u(t),t.credentials!==void 0&&(this.m_=function(n){if(!n)return new nu;switch(n.type){case"gapi":var r=n.client;return P(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new mp(r,n.sessionIndex||"0");case"provider":return n.client;default:throw new b(y.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},e.prototype.V_=function(){return this.E_},e.prototype.p_=function(){return this.T_=!0,this.E_},e.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},e.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},e.prototype.b_=function(){return t=this,(n=Yu.get(t))&&(I("ComponentProvider","Removing Datastore"),Yu.delete(t),n.terminate()),Promise.resolve();var t,n},e}(),Y=function(){function e(t,n,r){this.v_=n,this.S_=r,this.type="document",this.firestore=t}return Object.defineProperty(e.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new se(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.S_)},e}(),xt=function(){function e(t,n,r){this.v_=n,this.C_=r,this.type="query",this.firestore=t}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this.C_)},e}(),se=function(e){function t(n,r,i){var o=this;return(o=e.call(this,n,r,or(i))||this).firestore=n,o.D_=i,o.type="collection",o}return N(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this.D_.X();return n.et()?null:new Y(this.firestore,null,new x(n))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(n){return new t(this.firestore,n,this.D_)},t}(xt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ch(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof U&&(e=e.d_),Ds("collection","path",t),e instanceof Gn)return Gu(n=q.ot.apply(q,at([t],r))),new se(e,null,n);if(!(e instanceof Y||e instanceof se))throw new b(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Gu(n=q.ot.apply(q,at([e.path],r)).child(q.ot(t))),new se(e.firestore,null,n)}function Sr(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e instanceof U&&(e=e.d_),arguments.length===1&&(t=mc.u()),Ds("doc","path",t),e instanceof Gn)return Bu(n=q.ot.apply(q,at([t],r))),new Y(e,null,new x(n));if(!(e instanceof Y||e instanceof se))throw new b(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Bu(n=e.D_.child(q.ot.apply(q,at([t],r)))),new Y(e.firestore,e instanceof se?e.v_:null,new x(n))}function Rh(e,t){return e instanceof U&&(e=e.d_),t instanceof U&&(t=t.d_),(e instanceof Y||e instanceof se)&&(t instanceof Y||t instanceof se)&&e.firestore===t.firestore&&e.path===t.path&&e.v_===t.v_}function Lh(e,t){return e instanceof U&&(e=e.d_),t instanceof U&&(t=t.d_),e instanceof xt&&t instanceof xt&&e.firestore===t.firestore&&sr(e.C_,t.C_)&&e.v_===t.v_}var Ei=function(){function e(t,n){if(!isFinite(t)||t<-90||t>90)throw new b(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new b(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this.x_=t,this.N_=n}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},e.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},e.prototype.U=function(t){return L(this.x_,t.x_)||L(this.N_,t.N_)},e}(),Nv=/^__.*__$/,Av=function(){function e(t,n,r){this.data=t,this.Gt=n,this.fieldTransforms=r}return e.prototype.F_=function(t,n){return this.Gt!==null?new ve(t,this.data,this.Gt,n,this.fieldTransforms):new cr(t,this.data,n,this.fieldTransforms)},e}(),Vh=function(){function e(t,n,r){this.data=t,this.Gt=n,this.fieldTransforms=r}return e.prototype.F_=function(t,n){return new ve(t,this.data,this.Gt,n,this.fieldTransforms)},e}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw D()}}var Fh=function(){function e(t,n,r,i,o,s){this.settings=t,this.t=n,this.Qt=r,this.ignoreUndefinedProperties=i,o===void 0&&this.O_(),this.fieldTransforms=o||[],this.Gt=s||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),e.prototype.M_=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},e.prototype.L_=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.M_({path:r,B_:!1});return i.q_(t),i},e.prototype.U_=function(t){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(t),i=this.M_({path:r,B_:!1});return i.O_(),i},e.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},e.prototype.K_=function(t){return Jr(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},e.prototype.contains=function(t){return this.Gt.find(function(n){return t.nt(n)})!==void 0||this.fieldTransforms.find(function(n){return t.nt(n.field)})!==void 0},e.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},e.prototype.q_=function(t){if(t.length===0)throw this.K_("Document fields must not be empty");if(Mh(this.k_)&&Nv.test(t))throw this.K_('Document fields cannot begin and end with "__"')},e}(),Sv=function(){function e(t,n,r){this.t=t,this.ignoreUndefinedProperties=n,this.Qt=r||gi(t)}return e.prototype.G_=function(t,n,r,i){return i===void 0&&(i=!1),new Fh({k_:t,methodName:n,j_:r,path:Mt.ct(),B_:!1,W_:i},this.t,this.Qt,this.ignoreUndefinedProperties)},e}();function Fe(e){var t=e.p_(),n=gi(e.I_);return new Sv(e.I_,!!t.ignoreUndefinedProperties,n)}function _i(e,t,n,r,i,o){o===void 0&&(o={});var s=e.G_(o.merge||o.mergeFields?2:0,t,n,i);Cs("Data must be an object, but it was:",s,r);var u,a,c=qh(r,s);if(o.merge)u=new Je(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=yo(t,l[f],n);if(!s.contains(p))throw new b(y.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Bh(h,p)||h.push(p)}u=new Je(h),a=s.fieldTransforms.filter(function(d){return u.Tt(d.field)})}else u=null,a=s.fieldTransforms;return new Av(new he(c),u,a)}var xs=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.z_=function(n){if(n.k_!==2)throw n.k_===1?n.K_(this._methodName+"() can only appear at the top level of your update data"):n.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return n.Gt.push(n.path),null},t.prototype.isEqual=function(n){return n instanceof t},t}(Me);function Uh(e,t,n){return new Fh({k_:3,j_:t.settings.j_,methodName:e._methodName,B_:n},t.t,t.Qt,t.ignoreUndefinedProperties)}var Dv=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.z_=function(n){return new ar(n.path,new nn)},t.prototype.isEqual=function(n){return n instanceof t},t}(Me),Ov=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).H_=r,i}return N(t,e),t.prototype.z_=function(n){var r=Uh(this,n,!0),i=this.H_.map(function(s){return Ue(s,r)}),o=new Pe(i);return new ar(n.path,o)},t.prototype.isEqual=function(n){return this===n},t}(Me),xv=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).H_=r,i}return N(t,e),t.prototype.z_=function(n){var r=Uh(this,n,!0),i=this.H_.map(function(s){return Ue(s,r)}),o=new ke(i);return new ar(n.path,o)},t.prototype.isEqual=function(n){return this===n},t}(Me),Pv=function(e){function t(n,r){var i=this;return(i=e.call(this,n)||this).J_=r,i}return N(t,e),t.prototype.z_=function(n){var r=new rn(n.Qt,kc(n.Qt,this.J_));return new ar(n.path,r)},t.prototype.isEqual=function(n){return this===n},t}(Me);function Ps(e,t,n,r){var i=e.G_(1,t,n);Cs("Data must be an object, but it was:",i,r);var o=[],s=new rr;nr(r,function(a,c){var h=Rs(t,a,n);c instanceof U&&(c=c.d_);var f=i.U_(h);if(c instanceof xs)o.push(h);else{var l=Ue(c,f);l!=null&&(o.push(h),s.set(h,l))}});var u=new Je(o);return new Vh(s.Pt(),u,i.fieldTransforms)}function ks(e,t,n,r,i,o){var s=e.G_(1,t,n),u=[yo(t,r,n)],a=[i];if(o.length%2!=0)throw new b(y.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(yo(t,o[c])),a.push(o[c+1]);for(var h=[],f=new rr,l=u.length-1;l>=0;--l)if(!Bh(h,u[l])){var p=u[l],d=a[l];d instanceof U&&(d=d.d_);var v=s.U_(p);if(d instanceof xs)h.push(p);else{var w=Ue(d,v);w!=null&&(h.push(p),f.set(p,w))}}var _=new Je(h);return new Vh(f.Pt(),_,s.fieldTransforms)}function jh(e,t,n,r){return r===void 0&&(r=!1),Ue(n,e.G_(r?4:3,t))}function Ue(e,t){if(e instanceof U&&(e=e.d_),zh(e))return Cs("Unsupported field value:",t,e),qh(e,t);if(e instanceof Me)return function(n,r){if(!Mh(r.k_))throw r.K_(n._methodName+"() can only be used with update() and set()");if(!r.path)throw r.K_(n._methodName+"() is not currently supported inside arrays");var i=n.z_(r);i&&r.fieldTransforms.push(i)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.Gt.push(t.path),e instanceof Array){if(t.settings.B_&&t.k_!==4)throw t.K_("Nested arrays are not supported");return function(n,r){for(var i=[],o=0,s=0,u=n;s<u.length;s++){var a=Ue(u[s],r.Q_(o));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),o++}return{arrayValue:{values:i}}}(e,t)}return function(n,r){if(n instanceof U&&(n=n.d_),n===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return kc(r.Qt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){var i=Et.fromDate(n);return{timestampValue:jn(r.Qt,i)}}if(n instanceof Et)return i=new Et(n.seconds,1e3*Math.floor(n.nanoseconds/1e3)),{timestampValue:jn(r.Qt,i)};if(n instanceof Ei)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof xe)return{bytesValue:Bc(r.Qt,n.I)};if(n instanceof Y){i=r.t;var o=n.firestore.I_;if(!o.isEqual(i))throw r.K_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:us(n.firestore.I_||r.t,n.S_.path)}}throw r.K_("Unsupported field value: "+bi(n))}(e,t)}function qh(e,t){var n={};return Ec(e)?t.path&&t.path.length>0&&t.Gt.push(t.path):nr(e,function(r,i){var o=Ue(i,t.L_(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function zh(e){return!(typeof e!="object"||e===null||e instanceof Array||e instanceof Date||e instanceof Et||e instanceof Ei||e instanceof xe||e instanceof Y||e instanceof Me)}function Cs(e,t,n){if(!zh(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){var r=bi(n);throw r==="an object"?t.K_(e+" a custom object"):t.K_(e+" "+r)}}function yo(e,t,n){if(t instanceof U&&(t=t.d_),t instanceof $t)return t.f_;if(typeof t=="string")return Rs(e,t);throw Jr("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var kv=new RegExp("[~\\*/\\[\\]]");function Rs(e,t,n){if(t.search(kv)>=0)throw Jr("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return new($t.bind.apply($t,at([void 0],t.split("."))))().f_}catch{throw Jr("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function Jr(e,t,n,r,i){var o=r&&!r.et(),s=i!==void 0,u="Function "+t+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new b(y.INVALID_ARGUMENT,(u+=". ")+e+a)}function Bh(e,t){return e.some(function(n){return n.isEqual(t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cv=function(){function e(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}return e.prototype.ef=function(t){return m(this,void 0,void 0,function(){var n,r=this;return g(this,function(i){switch(i.label){case 0:if(this.nf(),this.mutations.length>0)throw new b(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(o,s){return m(this,void 0,void 0,function(){var u,a,c,h,f,l;return g(this,function(p){switch(p.label){case 0:return u=T(o),a=zn(u.Qt)+"/documents",c={documents:s.map(function(d){return qn(u.Qt,d)})},[4,u.Du("BatchGetDocuments",a,c)];case 1:return h=p.sent(),f=new Map,h.forEach(function(d){var v=function(w,_){return"found"in _?function(S,A){P(!!A.found),A.found.name,A.found.updateTime;var C=Gt(S,A.found.name),M=mt(A.found.updateTime),V=new he({mapValue:{fields:A.found.fields}});return new B(C,M,V,{})}(w,_):"missing"in _?function(S,A){P(!!A.missing),P(!!A.readTime);var C=Gt(S,A.missing),M=mt(A.readTime);return new rt(C,M)}(w,_):D()}(u.Qt,d);f.set(v.key.toString(),v)}),l=[],[2,(s.forEach(function(d){var v=f.get(d.toString());P(!!v),l.push(v)}),l)]}})})}(this.Sh,t)];case 1:return[2,((n=i.sent()).forEach(function(o){o instanceof rt||o instanceof B?r.sf(o):D()}),n)]}})})},e.prototype.set=function(t,n){this.write(n.F_(t,this.jt(t))),this.tf.add(t.toString())},e.prototype.update=function(t,n){try{this.write(n.F_(t,this.rf(t)))}catch(r){this.Z_=r}this.tf.add(t.toString())},e.prototype.delete=function(t){this.write(new hr(t,this.jt(t))),this.tf.add(t.toString())},e.prototype.commit=function(){return m(this,void 0,void 0,function(){var t,n=this;return g(this,function(r){switch(r.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(i){t.delete(i.key.toString())}),t.forEach(function(i,o){var s=x._t(o);n.mutations.push(new is(s,n.jt(s)))}),[4,function(i,o){return m(this,void 0,void 0,function(){var s,u,a;return g(this,function(c){switch(c.label){case 0:return s=T(i),u=zn(s.Qt)+"/documents",a={writes:o.map(function(h){return $r(s.Qt,h)})},[4,s.pu("Commit",u,a)];case 1:return c.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return r.sent(),this.X_=!0,[2]}})})},e.prototype.sf=function(t){var n;if(t instanceof B)n=t.version;else{if(!(t instanceof rt))throw D();n=R.min()}var r=this.Y_.get(t.key.toString());if(r){if(!n.isEqual(r))throw new b(y.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),n)},e.prototype.jt=function(t){var n=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&n?ct.updateTime(n):ct.Kt()},e.prototype.rf=function(t){var n=this.Y_.get(t.toString());if(!this.tf.has(t.toString())&&n){if(n.isEqual(R.min()))throw new b(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(n)}return ct.exists(!0)},e.prototype.write=function(t){this.nf(),this.mutations.push(t)},e.prototype.nf=function(){},e}(),Rv=function(){function e(t,n,r,i){this._s=t,this.Sh=n,this.updateFunction=r,this.Es=i,this.cf=5,this.Gu=new ds(this._s,"transaction_retry")}return e.prototype.run=function(){this.af()},e.prototype.af=function(){var t=this;this.Gu.Lu(function(){return m(t,void 0,void 0,function(){var n,r,i=this;return g(this,function(o){return n=new Cv(this.Sh),(r=this.uf(n))&&r.then(function(s){i._s.Ps(function(){return n.commit().then(function(){i.Es.resolve(s)}).catch(function(u){i.hf(u)})})}).catch(function(s){i.hf(s)}),[2]})})})},e.prototype.uf=function(t){try{var n=this.updateFunction(t);return!Re(n)&&n.catch&&n.then?n:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.Es.reject(r),null}},e.prototype.hf=function(t){var n=this;this.cf>0&&this.lf(t)?(this.cf-=1,this._s.Ps(function(){return n.af(),Promise.resolve()})):this.Es.reject(t)},e.prototype.lf=function(t){if(t.name==="FirebaseError"){var n=t.code;return n==="aborted"||n==="failed-precondition"||!Fc(n)}return!1},e}(),Lv=function(){function e(t,n,r){var i=this;this.credentials=t,this._s=n,this.yu=r,this.user=Nt.UNAUTHENTICATED,this.clientId=mc.u(),this._f=function(){},this.C=new Ct,this.credentials.v(function(o){I("FirestoreClient","Received user=",o.uid),i.user=o,i._f(o),i.C.resolve()})}return e.prototype.getConfiguration=function(){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},e.prototype.ff=function(t){var n=this;this._f=t,this.C.promise.then(function(){return n._f(n.user)})},e.prototype.df=function(){if(this._s.wf)throw new b(y.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var t=this;this._s.Ef();var n=new Ct;return this._s.Tf(function(){return m(t,void 0,void 0,function(){var r,i;return g(this,function(o){switch(o.label){case 0:return o.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:o.sent(),o.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:o.sent(),o.label=4;case 4:return this.credentials.S(),n.resolve(),[3,6];case 5:return r=o.sent(),i=gn(r,"Failed to shutdown persistence"),n.reject(i),[3,6];case 6:return[2]}})})}),n.promise},e}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gh(e,t){return m(this,void 0,void 0,function(){var n,r,i=this;return g(this,function(o){switch(o.label){case 0:return e._s.Af(),I("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.Jl,e.ff(function(s){r.isEqual(s)||(r=s,e._s.po(function(){return m(i,void 0,void 0,function(){return g(this,function(u){switch(u.label){case 0:return[4,lh(t.bh,s)];case 1:return u.sent(),[2]}})})}))}),t.persistence.Po(function(){return e.terminate()}),e.mf=t,[2]}})})}function Hh(e,t){return m(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return e._s.Af(),[4,Ls(e)];case 1:return n=i.sent(),I("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.ff(function(o){return e._s.po(function(){return function(s,u){return m(this,void 0,void 0,function(){var a,c;return g(this,function(h){switch(h.label){case 0:return(a=T(s))._s.Af(),I("RemoteStore","RemoteStore received new credentials"),c=ye(a),a.Nh.add(3),[4,wn(a)];case 1:return h.sent(),c&&a.Oh.set("Unknown"),[4,a.Dh.n_(u)];case 2:return h.sent(),a.Nh.delete(3),[4,fr(a)];case 3:return h.sent(),[2]}})})}(t.yl,o)})}),e.If=t,[2]}})})}function Ls(e){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(I("FirestoreClient","Using default OfflineComponentProvider"),[4,Gh(e,new xh)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Ii(e){return m(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(I("FirestoreClient","Using default OnlineComponentProvider"),[4,Hh(e,new vo)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function Ku(e){return Ls(e).then(function(t){return t.persistence})}function $h(e){return Ls(e).then(function(t){return t.bh})}function Qu(e){return Ii(e).then(function(t){return t.yl})}function Yh(e){return Ii(e).then(function(t){return t._a})}function ln(e){return m(this,void 0,void 0,function(){var t,n;return g(this,function(r){switch(r.label){case 0:return[4,Ii(e)];case 1:return t=r.sent(),[2,((n=t.gl).jh=uv.bind(null,t._a),n.Hh=av.bind(null,t._a),n)]}})})}function Xu(e,t,n){var r=this;n===void 0&&(n={});var i=new Ct;return e._s.Ps(function(){return m(r,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return o=function(u,a,c,h,f){var l=new wi({next:function(d){a.Ps(function(){return ws(u,p)});var v=d.docs.has(c);!v&&d.fromCache?f.reject(new b(y.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&d.fromCache&&h&&h.source==="server"?f.reject(new b(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(d)},error:function(d){return f.reject(d)}}),p=new Es(or(c.path),l,{includeMetadataChanges:!0,nl:!0});return ms(u,p)},[4,ln(e)];case 1:return[2,o.apply(void 0,[s.sent(),e._s,t,n,i])]}})})}),i.promise}function Wu(e,t,n){var r=this;n===void 0&&(n={});var i=new Ct;return e._s.Ps(function(){return m(r,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return o=function(u,a,c,h,f){var l=new wi({next:function(d){a.Ps(function(){return ws(u,p)}),d.fromCache&&h.source==="server"?f.reject(new b(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(d)},error:function(d){return f.reject(d)}}),p=new Es(c,l,{includeMetadataChanges:!0,nl:!0});return ms(u,p)},[4,ln(e)];case 1:return[2,o.apply(void 0,[s.sent(),e._s,t,n,i])]}})})}),i.promise}var Vv=function(){function e(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new ds(this,"async_queue_retry"),this.vf=function(){var r=Ar();r&&I("AsyncQueue","Visibility state changed to "+r.visibilityState),t.Gu.qu()};var n=Ar();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.vf)}return Object.defineProperty(e.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),e.prototype.Ps=function(t){this.enqueue(t)},e.prototype.Tf=function(t){this.Sf(),this.Df(t)},e.prototype.Ef=function(){if(!this.yf){this.yf=!0;var t=Ar();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.vf)}},e.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(n){}):this.Df(t)},e.prototype.po=function(t){var n=this;this.Ps(function(){return n.Pf.push(t),n.Cf()})},e.prototype.Cf=function(){return m(this,void 0,void 0,function(){var t,n=this;return g(this,function(r){switch(r.label){case 0:if(this.Pf.length===0)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return r.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!Le(t=r.sent()))throw t;return I("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Pf.length>0&&this.Gu.Lu(function(){return n.Cf()}),r.label=5;case 5:return[2]}})})},e.prototype.Df=function(t){var n=this,r=this.Rf.then(function(){return n.pf=!0,t().catch(function(i){throw n.Vf=i,n.pf=!1,W("INTERNAL UNHANDLED ERROR: ",function(o){var s=o.message||"";return o.stack&&(s=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),s}(i)),i}).then(function(i){return n.pf=!1,i})});return this.Rf=r,r},e.prototype.Tr=function(t,n,r){var i=this;this.Sf(),this.bf.indexOf(t)>-1&&(n=0);var o=nd.Ts(this,t,n,r,function(s){return i.xf(s)});return this.gf.push(o),o},e.prototype.Sf=function(){this.Vf&&D()},e.prototype.Af=function(){},e.prototype.Nf=function(){return m(this,void 0,void 0,function(){var t;return g(this,function(n){switch(n.label){case 0:return[4,t=this.Rf];case 1:n.sent(),n.label=2;case 2:if(t!==this.Rf)return[3,0];n.label=3;case 3:return[2]}})})},e.prototype.$f=function(t){for(var n=0,r=this.gf;n<r.length;n++)if(r[n].fs===t)return!0;return!1},e.prototype.Ff=function(t){var n=this;return this.Nf().then(function(){n.gf.sort(function(s,u){return s.ds-u.ds});for(var r=0,i=n.gf;r<i.length;r++){var o=i[r];if(o.Rs(),t!=="all"&&o.fs===t)break}return n.Nf()})},e.prototype.Of=function(t){this.bf.push(t)},e.prototype.xf=function(t){var n=this.gf.indexOf(t);this.gf.splice(n,1)},e}();function pn(e){return function(t,n){if(typeof t!="object"||t===null)return!1;for(var r=t,i=0,o=["next","error","complete"];i<o.length;i++){var s=o[i];if(s in r&&typeof r[s]=="function")return!0}return!1}(e)}var Mv=-1,Z=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this).Bf=new Vv,i.w_="name"in n?n.name:"[DEFAULT]",i}return N(t,e),t.prototype.b_=function(){return this.qf||Kh(this),this.qf.terminate()},t}(Gn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(e){return e.qf||Kh(e),e.qf.df(),e.qf}function Kh(e){var t=e.p_(),n=function(r,i,o){return new pp(r,i,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling)}(e.I_,e.w_,t);e.qf=new Lv(e.m_,e.Bf,n)}function Ju(e,t,n){var r=this,i=new Ct;return e._s.enqueue(function(){return m(r,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,Gh(e,n)];case 1:return s.sent(),[4,Hh(e,t)];case 2:return s.sent(),i.resolve(),[3,4];case 3:if(!function(u){return u.name==="FirebaseError"?u.code===y.FAILED_PRECONDITION||u.code===y.UNIMPLEMENTED:!(typeof DOMException!="undefined"&&u instanceof DOMException)||u.code===22||u.code===20||u.code===11}(o=s.sent()))throw o;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),i.reject(o),[3,4];case 4:return[2]}})})}).then(function(){return i.promise})}function Zu(e){if(e.R_||e.P_)throw new b(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vs=function(){function e(){}return e.prototype.Uf=function(t,n){switch(n===void 0&&(n="none"),ce(t)){case 0:return null;case 1:return t.booleanValue;case 2:return X(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,n);case 5:return t.stringValue;case 6:return this.Wf(Ze(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,n);case 10:return this.Hf(t.mapValue,n);default:throw D()}},e.prototype.Hf=function(t,n){var r=this,i={};return nr(t.fields||{},function(o,s){i[o]=r.Uf(s,n)}),i},e.prototype.Gf=function(t){return new Ei(X(t.latitude),X(t.longitude))},e.prototype.zf=function(t,n){var r=this;return(t.values||[]).map(function(i){return r.Uf(i,n)})},e.prototype.Kf=function(t,n){switch(n){case"previous":var r=_c(t);return r==null?null:this.Uf(r,n);case"estimate":return this.Qf(Vn(t));default:return null}},e.prototype.Qf=function(t){var n=ae(t);return new Et(n.seconds,n.nanos)},e.prototype.Jf=function(t,n){var r=q.ot(t);P(Wc(r));var i=new Fr(r.get(1),r.get(3)),o=new x(r.Y(5));return i.isEqual(n)||W("Document "+o+" contains a document reference within a different database ("+i.projectId+"/"+i.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),o},e}(),Hn=function(){function e(t,n,r,i,o){this.Yf=t,this.Xf=n,this.S_=r,this.Zf=i,this.v_=o}return Object.defineProperty(e.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Y(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return this.Zf!==null},e.prototype.data=function(){if(this.Zf){if(this.v_){var t=new Fv(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},e.prototype.get=function(t){if(this.Zf){var n=this.Zf.data().field(Zr("DocumentSnapshot.get",t));if(n!==null)return this.Xf.Uf(n)}},e}(),Fv=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(Hn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(e,t){return typeof t=="string"?Rs(e,t):t instanceof U?t.d_.f_:t.f_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(e){if(Br(e)&&e.xt.length===0)throw new b(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var lr=function(){};function Jt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o.td(e)}return e}var Uv=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).ed=n,o.nd=r,o.sd=i,o.type="where",o}return N(t,e),t.prototype.td=function(n){var r=Fe(n.firestore),i=function(o,s,u,a,c,h,f){var l;if(c.ut()){if(h==="array-contains"||h==="array-contains-any")throw new b(y.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+h+"' queries on FieldPath.documentId().");if(h==="in"||h==="not-in"){ia(f,h);for(var p=[],d=0,v=f;d<v.length;d++){var w=v[d];p.push(ra(a,o,w))}l={arrayValue:{values:p}}}else l=ra(a,o,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ia(f,h),l=jh(u,"where",f,h==="in"||h==="not-in");var _=Ot.create(c,h,l);return function(S,A){if(A.Ct()){var C=es(S);if(C!==null&&!C.isEqual(A.field))throw new b(y.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+C.toString()+"' and '"+A.field.toString()+"'");var M=ts(S);M!==null&&Wh(S,A.field,M)}var V=function(J,Di){for(var _n=0,Ms=J.filters;_n<Ms.length;_n++){var Fs=Ms[_n];if(Di.indexOf(Fs.op)>=0)return Fs.op}return null}(S,function(J){switch(J){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(A.op));if(V!==null)throw V===A.op?new b(y.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+A.op.toString()+"' filter."):new b(y.INVALID_ARGUMENT,"Invalid query. You cannot use '"+A.op.toString()+"' filters with '"+V.toString()+"' filters.")}(o,_),_}(n.C_,0,r,n.firestore.I_,this.ed,this.nd,this.sd);return new xt(n.firestore,n.v_,function(o,s){var u=o.filters.concat([s]);return new Qt(o.path,o.collectionGroup,o.xt.slice(),u,o.limit,o.limitType,o.startAt,o.endAt)}(n.C_,i))},t}(lr),jv=function(e){function t(n,r){var i=this;return(i=e.call(this)||this).ed=n,i.rd=r,i.type="orderBy",i}return N(t,e),t.prototype.td=function(n){var r=function(i,o,s){if(i.startAt!==null)throw new b(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new b(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var u=new Ke(o,s);return function(a,c){if(ts(a)===null){var h=es(a);h!==null&&Wh(a,h,c.field)}}(i,u),u}(n.C_,this.ed,this.rd);return new xt(n.firestore,n.v_,function(i,o){var s=i.xt.concat([o]);return new Qt(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(n.C_,r))},t}(lr),ta=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.od=r,o.ad=i,o}return N(t,e),t.prototype.td=function(n){return new xt(n.firestore,n.v_,Sc(n.C_,this.od,this.ad))},t}(lr),ea=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.ud=r,o.hd=i,o}return N(t,e),t.prototype.td=function(n){var r=Xh(n,this.type,this.ud,this.hd);return new xt(n.firestore,n.v_,function(i,o){return new Qt(i.path,i.collectionGroup,i.xt.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(n.C_,r))},t}(lr),na=function(e){function t(n,r,i){var o=this;return(o=e.call(this)||this).type=n,o.ud=r,o.hd=i,o}return N(t,e),t.prototype.td=function(n){var r=Xh(n,this.type,this.ud,this.hd);return new xt(n.firestore,n.v_,function(i,o){return new Qt(i.path,i.collectionGroup,i.xt.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(n.C_,r))},t}(lr);function Xh(e,t,n,r){if(n[0]instanceof U&&(n[0]=n[0].d_),n[0]instanceof Hn)return function(o,s,u,a,c){if(!a)throw new b(y.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+u+"().");for(var h=[],f=0,l=en(o);f<l.length;f++){var p=l[f];if(p.field.ut())h.push(jr(s,a.key));else{var d=a.field(p.field);if(Ko(d))throw new b(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){var v=p.field.rt();throw new b(y.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+v+"' (used as the orderBy) does not exist.")}h.push(d)}}return new Fn(h,c)}(e.C_,e.firestore.I_,t,n[0].Zf,r);var i=Fe(e.firestore);return function(o,s,u,a,c,h){var f=o.xt;if(c.length>f.length)throw new b(y.INVALID_ARGUMENT,"Too many arguments provided to "+a+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var l=[],p=0;p<c.length;p++){var d=c[p];if(f[p].field.ut()){if(typeof d!="string")throw new b(y.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+a+"(), but got a "+typeof d);if(!ns(o)&&d.indexOf("/")!==-1)throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+a+"() must be a plain document ID, but '"+d+"' contains a slash.");var v=o.path.child(q.ot(d));if(!x.wt(v))throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+a+"() must result in a valid document path, but '"+v+"' is not because it contains an odd number of segments.");var w=new x(v);l.push(jr(s,w))}else{var _=jh(u,a,d);l.push(_)}}return new Fn(l,h)}(e.C_,e.firestore.I_,i,t,n,r)}function ra(e,t,n){if(n instanceof U&&(n=n.d_),typeof n=="string"){if(n==="")throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ns(t)&&n.indexOf("/")!==-1)throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=t.path.child(q.ot(n));if(!x.wt(r))throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return jr(e,new x(r))}if(n instanceof Y)return jr(e,n.S_);throw new b(y.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+bi(n)+".")}function ia(e,t){if(!Array.isArray(e)||e.length===0)throw new b(y.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new b(y.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function Wh(e,t,n){if(!n.isEqual(t))throw new b(y.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var qv=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return N(t,e),t.prototype.Wf=function(n){return new xe(n)},t.prototype.jf=function(n){var r=this.Jf(n,this.firestore.I_);return new Y(this.firestore,null,r)},t}(Vs),_e=function(){function e(t,n){this.hasPendingWrites=t,this.fromCache=n}return e.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},e}(),Yt=function(e){function t(n,r,i,o,s,u){var a=this;return(a=e.call(this,n,r,i,o,u)||this).Yf=n,a.ld=n,a.metadata=s,a}return N(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(n){if(n===void 0&&(n={}),this.Zf){if(this.v_){var r=new On(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(r,n)}return this.Xf.Uf(this.Zf.bt(),n.serverTimestamps)}},t.prototype.get=function(n,r){if(r===void 0&&(r={}),this.Zf){var i=this.Zf.data().field(Zr("DocumentSnapshot.get",n));if(i!==null)return this.Xf.Uf(i,r.serverTimestamps)}},t}(Hn),On=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.data=function(n){return n===void 0&&(n={}),e.prototype.data.call(this,n)},t}(Yt),ne=function(){function e(t,n,r,i){this.Yf=t,this.Xf=n,this._d=i,this.metadata=new _e(i.hasPendingWrites,i.fromCache),this.query=r}return Object.defineProperty(e.prototype,"docs",{get:function(){var t=[];return this.forEach(function(n){return t.push(n)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.size===0},enumerable:!1,configurable:!0}),e.prototype.forEach=function(t,n){var r=this;this._d.docs.forEach(function(i){t.call(n,new On(r.Yf,r.Xf,i.key,i,new _e(r._d.De.has(i.key),r._d.fromCache),r.query.v_))})},e.prototype.docChanges=function(t){t===void 0&&(t={});var n=!!t.includeMetadataChanges;if(n&&this._d.xe)throw new b(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===n||(this.fd=function(r,i){if(r._d.Se.et()){var o=0;return r._d.docChanges.map(function(u){var a=new On(r.Yf,r.Xf,u.doc.key,u.doc,new _e(r._d.De.has(u.doc.key),r._d.fromCache),r.query.v_);return u.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}var s=r._d.Se;return r._d.docChanges.filter(function(u){return i||u.type!==3}).map(function(u){var a=new On(r.Yf,r.Xf,u.doc.key,u.doc,new _e(r._d.De.has(u.doc.key),r._d.fromCache),r.query.v_),c=-1,h=-1;return u.type!==0&&(c=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),u.type!==1&&(h=(s=s.add(u.doc)).indexOf(u.doc.key)),{type:zv(u.type),doc:a,oldIndex:c,newIndex:h}})}(this,n),this.dd=n),this.fd},e}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zv(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D()}}function Jh(e,t){return e instanceof Yt&&t instanceof Yt?e.Yf===t.Yf&&e.S_.isEqual(t.S_)&&(e.Zf===null?t.Zf===null:e.Zf.isEqual(t.Zf))&&e.v_===t.v_:e instanceof ne&&t instanceof ne&&e.Yf===t.Yf&&Lh(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._d.isEqual(t._d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return N(t,e),t.prototype.Wf=function(n){return new xe(n)},t.prototype.jf=function(n){var r=this.Jf(n,this.firestore.I_);return new Y(this.firestore,null,r)},t}(Vs);function oa(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];e=z(e,Y);var o=z(e.firestore,Z),s=Fe(o);return t instanceof U&&(t=t.d_),$n(o,[(typeof t=="string"||t instanceof $t?ks(s,"updateDoc",e.S_,t,n,r):Ps(s,"updateDoc",e.S_,t)).F_(e.S_,ct.exists(!0))])}function Zh(e){for(var t,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];e instanceof U&&(e=e.d_);var s={includeMetadataChanges:!1},u=0;typeof i[u]!="object"||pn(i[u])||(s=i[u],u++);var a,c,h,f={includeMetadataChanges:s.includeMetadataChanges};if(pn(i[u])){var l=i[u];i[u]=(t=l.next)===null||t===void 0?void 0:t.bind(l),i[u+1]=(n=l.error)===null||n===void 0?void 0:n.bind(l),i[u+2]=(r=l.complete)===null||r===void 0?void 0:r.bind(l)}if(e instanceof Y)c=z(e.firestore,Z),h=or(e.S_.path),a={next:function(v){i[u]&&i[u](go(c,e,v))},error:i[u+1],complete:i[u+2]};else{var p=z(e,xt);c=z(p.firestore,Z),h=p.C_;var d=new Ne(c);a={next:function(v){i[u]&&i[u](new ne(c,d,p,v))},error:i[u+1],complete:i[u+2]},Qh(e.C_)}return function(v,w,_,S){var A=this,C=new wi(S),M=new Es(w,C,_);return v._s.Ps(function(){return m(A,void 0,void 0,function(){var V;return g(this,function(J){switch(J.label){case 0:return V=ms,[4,ln(v)];case 1:return[2,V.apply(void 0,[J.sent(),M])]}})})}),function(){C.i_(),v._s.Ps(function(){return m(A,void 0,void 0,function(){var V;return g(this,function(J){switch(J.label){case 0:return V=ws,[4,ln(v)];case 1:return[2,V.apply(void 0,[J.sent(),M])]}})})})}}(ut(c),h,f,a)}function $n(e,t){return function(n,r){var i=this,o=new Ct;return n._s.Ps(function(){return m(i,void 0,void 0,function(){var s;return g(this,function(u){switch(u.label){case 0:return s=cv,[4,Yh(n)];case 1:return[2,s.apply(void 0,[u.sent(),r,o])]}})})}),o.promise}(ut(e),t)}function go(e,t,n){var r=n.docs.get(t.S_),i=new Ne(e);return new Yt(e,i,t.S_,r,new _e(n.hasPendingWrites,n.fromCache),t.v_)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bv=function(){function e(t,n){this.Yf=t,this.wd=n,this.Ed=[],this.Td=!1,this.Id=Fe(t)}return e.prototype.set=function(t,n,r){this.md();var i=re(t,this.Yf),o=Ti(i.v_,n,r),s=_i(this.Id,"WriteBatch.set",i.S_,o,i.v_!==null,r);return this.Ed.push(s.F_(i.S_,ct.Kt())),this},e.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];this.md();var s,u=re(t,this.Yf);return n instanceof U&&(n=n.d_),s=typeof n=="string"||n instanceof $t?ks(this.Id,"WriteBatch.update",u.S_,n,r,i):Ps(this.Id,"WriteBatch.update",u.S_,n),this.Ed.push(s.F_(u.S_,ct.exists(!0))),this},e.prototype.delete=function(t){this.md();var n=re(t,this.Yf);return this.Ed=this.Ed.concat(new hr(n.S_,ct.Kt())),this},e.prototype.commit=function(){return this.md(),this.Td=!0,this.Ed.length>0?this.wd(this.Ed):Promise.resolve()},e.prototype.md=function(){if(this.Td)throw new b(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();function re(e,t){if(e instanceof U&&(e=e.d_),e.firestore!==t)throw new b(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gv=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this).Yf=n,i}return N(t,e),t.prototype.get=function(n){var r=this,i=re(n,this.Yf),o=new Ne(this.Yf);return e.prototype.get.call(this,n).then(function(s){return new Yt(r.Yf,o,i.S_,s.Zf,new _e(!1,!1),i.v_)})},t}(function(){function e(t,n){this.Yf=t,this.Ad=n,this.Id=Fe(t)}return e.prototype.get=function(t){var n=this,r=re(t,this.Yf),i=new qv(this.Yf);return this.Ad.ef([r.S_]).then(function(o){if(!o||o.length!==1)return D();var s=o[0];if(s instanceof rt)return new Hn(n.Yf,i,r.S_,null,r.v_);if(s instanceof B)return new Hn(n.Yf,i,s.key,s,r.v_);throw D()})},e.prototype.set=function(t,n,r){var i=re(t,this.Yf),o=Ti(i.v_,n,r),s=_i(this.Id,"Transaction.set",i.S_,o,i.v_!==null,r);return this.Ad.set(i.S_,s),this},e.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s,u=re(t,this.Yf);return n instanceof U&&(n=n.d_),s=typeof n=="string"||n instanceof $t?ks(this.Id,"Transaction.update",u.S_,n,r,i):Ps(this.Id,"Transaction.update",u.S_,n),this.Ad.update(u.S_,s),this},e.prototype.delete=function(t){var n=re(t,this.Yf);return this.Ad.delete(n.S_),this},e}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(){if(typeof Uint8Array=="undefined")throw new b(y.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ua(){if(typeof atob=="undefined")throw new b(y.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var tf=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.fromBase64String=function(n){return ua(),new t(xe.fromBase64String(n))},t.fromUint8Array=function(n){return sa(),new t(xe.fromUint8Array(n))},t.prototype.toBase64=function(){return ua(),this.d_.toBase64()},t.prototype.toUint8Array=function(){return sa(),this.d_.toUint8Array()},t.prototype.isEqual=function(n){return this.d_.isEqual(n.d_)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(U),Hv=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(t,n){return function(r,i){Zu(r=z(r,Z));var o=ut(r),s=r.p_(),u=new vo;return Ju(o,u,new Ph(u,s.cacheSizeBytes,i==null?void 0:i.forceOwnership))}(t.d_,{forceOwnership:n})},e.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(n){Zu(n=z(n,Z));var r=ut(n),i=n.p_(),o=new vo;return Ju(r,o,new Tv(o,i.cacheSizeBytes))}(t.d_)},e.prototype.clearIndexedDbPersistence=function(t){return function(n){var r=this;if(n.R_&&!n.P_)throw new b(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var i=new Ct;return n.Bf.Tf(function(){return m(r,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(u){return m(this,void 0,void 0,function(){var a;return g(this,function(c){switch(c.label){case 0:return on.Kn()?(a=u+"main",[4,on.delete(a)]):[2,Promise.resolve()];case 1:return c.sent(),[2]}})})}(ls(n.I_,n.w_))];case 1:return s.sent(),i.resolve(),[3,3];case 2:return o=s.sent(),i.reject(o),[3,3];case 3:return[2]}})})}),i.promise}(t.d_)},e}(),ef=function(e){function t(n,r,i){var o=this;return(o=e.call(this,r)||this).Rd=i,o.INTERNAL={delete:function(){return o.terminate()}},n instanceof Fr||(o.Pd=n),o}return N(t,e),Object.defineProperty(t.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),t.prototype.settings=function(n){n.merge&&delete(n=Object.assign(Object.assign({},this.d_.V_()),n)).merge,this.d_.g_(n)},t.prototype.useEmulator=function(n,r){(function(i,o,s){var u=(i=z(i,Gn)).V_();u.host!=="firestore.googleapis.com"&&u.host!==o&&io("Host has been set in both settings() and useEmulator(), emulator host will be used"),i.g_(Object.assign(Object.assign({},u),{host:o+":"+s,ssl:!1}))})(this.d_,n,r)},t.prototype.enableNetwork=function(){return function(n){var r=this;return n._s.enqueue(function(){return m(r,void 0,void 0,function(){var i,o;return g(this,function(s){switch(s.label){case 0:return[4,Ku(n)];case 1:return i=s.sent(),[4,Qu(n)];case 2:return o=s.sent(),[2,(i.yo(!0),function(u){var a=T(u);return a.Nh.delete(0),fr(a)}(o))]}})})})}(ut(z(this.d_,Z)))},t.prototype.disableNetwork=function(){return function(n){var r=this;return n._s.enqueue(function(){return m(r,void 0,void 0,function(){var i,o;return g(this,function(s){switch(s.label){case 0:return[4,Ku(n)];case 1:return i=s.sent(),[4,Qu(n)];case 2:return o=s.sent(),[2,(i.yo(!1),function(u){return m(this,void 0,void 0,function(){var a;return g(this,function(c){switch(c.label){case 0:return(a=T(u)).Nh.add(0),[4,wn(a)];case 1:return c.sent(),a.Oh.set("Offline"),[2]}})})}(o))]}})})})}(ut(z(this.d_,Z)))},t.prototype.enablePersistence=function(n){var r=!1,i=!1;return n&&kh("synchronizeTabs",r=!!n.synchronizeTabs,"experimentalForceOwningTab",i=!!n.experimentalForceOwningTab),r?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,i)},t.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},t.prototype.waitForPendingWrites=function(){return function(n){var r=this,i=new Ct;return n._s.Ps(function(){return m(r,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return o=pv,[4,Yh(n)];case 1:return[2,o.apply(void 0,[s.sent(),i])]}})})}),i.promise}(ut(z(this.d_,Z)))},t.prototype.onSnapshotsInSync=function(n){return function(r,i){return function(o,s){var u=this,a=new wi(s);return o._s.Ps(function(){return m(u,void 0,void 0,function(){var c;return g(this,function(h){switch(h.label){case 0:return c=function(f,l){T(f).Wh.add(l),l.next()},[4,ln(o)];case 1:return[2,c.apply(void 0,[h.sent(),a])]}})})}),function(){a.i_(),o._s.Ps(function(){return m(u,void 0,void 0,function(){var c;return g(this,function(h){switch(h.label){case 0:return c=function(f,l){T(f).Wh.delete(l)},[4,ln(o)];case 1:return[2,c.apply(void 0,[h.sent(),a])]}})})})}}(ut(r=z(r,Z)),pn(i)?i:{next:i})}(this.d_,n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Pd)throw new b(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),t.prototype.collection=function(n){try{return new ti(this,Ch(this.d_,n))}catch(r){throw dt(r,"collection()","Firestore.collection()")}},t.prototype.doc=function(n){try{return new Ae(this,Sr(this.d_,n))}catch(r){throw dt(r,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(n){try{return new Si(this,function(r,i){if(r=z(r,Gn),Ds("collectionGroup","collection id",i),i.indexOf("/")>=0)throw new b(y.INVALID_ARGUMENT,"Invalid collection ID '"+i+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new xt(r,null,function(o){return new Qt(q.ct(),o)}(i))}(this.d_,n))}catch(r){throw dt(r,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(n){var r=this;return function(i,o){return function(s,u){var a=this,c=new Ct;return s._s.Ps(function(){return m(a,void 0,void 0,function(){var h;return g(this,function(f){switch(f.label){case 0:return[4,function(l){return Ii(l).then(function(p){return p.Sh})}(s)];case 1:return h=f.sent(),new Rv(s._s,h,u,c).run(),[2]}})})}),c.promise}(ut(i),function(s){return o(new Gv(i,s))})}(this.d_,function(i){return n(new nf(r,i))})},t.prototype.batch=function(){var n=this;return ut(this.d_),new rf(new Bv(this.d_,function(r){return $n(n.d_,r)}))},t.prototype.loadBundle=function(n){throw new b(y.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(n){throw new b(y.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(U),Ni=function(e){function t(n){var r=this;return(r=e.call(this)||this).firestore=n,r}return N(t,e),t.prototype.Wf=function(n){return new tf(new xe(n))},t.prototype.jf=function(n){var r=this.Jf(n,this.firestore.I_);return Ae.yd(r,this.firestore,null)},t}(Vs);function $v(e){var t;t=e,Lt.setLogLevel(t)}var nf=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).Yf=n,i.Xf=new Ni(n),i}return N(t,e),t.prototype.get=function(n){var r=this,i=Ie(n);return this.d_.get(i).then(function(o){return new Yn(r.Yf,new Yt(r.Yf.d_,r.Xf,o.S_,o.Zf,o.metadata,i.v_))})},t.prototype.set=function(n,r,i){var o=Ie(n);return i?(Os("Transaction.set",i),this.d_.set(o,r,i)):this.d_.set(o,r),this},t.prototype.update=function(n,r,i){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var a=Ie(n);return arguments.length===2?this.d_.update(a,r):(o=this.d_).update.apply(o,at([a,r,i],s)),this},t.prototype.delete=function(n){var r=Ie(n);return this.d_.delete(r),this},t}(U),rf=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.set=function(n,r,i){var o=Ie(n);return i?(Os("WriteBatch.set",i),this.d_.set(o,r,i)):this.d_.set(o,r),this},t.prototype.update=function(n,r,i){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var a=Ie(n);return arguments.length===2?this.d_.update(a,r):(o=this.d_).update.apply(o,at([a,r,i],s)),this},t.prototype.delete=function(n){var r=Ie(n);return this.d_.delete(r),this},t.prototype.commit=function(){return this.d_.commit()},t}(U),Ai=function(e){function t(n,r,i){var o=this;return(o=e.call(this,i)||this).Yf=n,o.Xf=r,o}return N(t,e),t.prototype.fromFirestore=function(n,r){var i=new On(this.Yf.d_,this.Xf,n.S_,n.Zf,n.metadata,null);return this.d_.fromFirestore(new Kn(this.Yf,i),r!=null?r:{})},t.prototype.toFirestore=function(n,r){return r?this.d_.toFirestore(n,r):this.d_.toFirestore(n)},t.gd=function(n,r){var i=t.Vd,o=i.get(n);o||(o=new WeakMap,i.set(n,o));var s=o.get(r);return s||(s=new t(n,new Ni(n),r),o.set(r,s)),s},t}(U);Ai.Vd=new WeakMap;var Ae=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).firestore=n,i.Xf=new Ni(n),i}return N(t,e),t.pd=function(n,r,i){if(n.length%2!=0)throw new b(y.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+n.rt()+" has "+n.length);return new t(r,new Y(r.d_,i,new x(n)))},t.yd=function(n,r,i){return new t(r,new Y(r.d_,i,n))},Object.defineProperty(t.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new ti(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(n){try{return new ti(this.firestore,Ch(this.d_,n))}catch(r){throw dt(r,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(n){return n instanceof U&&(n=n.d_),n instanceof Y&&Rh(this.d_,n)},t.prototype.set=function(n,r){r=Os("DocumentReference.set",r);try{return function(i,o,s){i=z(i,Y);var u=z(i.firestore,Z),a=Ti(i.v_,o,s);return $n(u,[_i(Fe(u),"setDoc",i.S_,a,i.v_!==null,s).F_(i.S_,ct.Kt())])}(this.d_,n,r)}catch(i){throw dt(i,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(n,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];try{return arguments.length===1?oa(this.d_,n):oa.apply(void 0,at([this.d_,n,r],i))}catch(s){throw dt(s,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return $n(z((n=this.d_).firestore,Z),[new hr(n.S_,ct.Kt())]);var n},t.prototype.onSnapshot=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=of(r),s=sf(r,function(u){return new Yn(n.firestore,new Yt(n.firestore.d_,n.Xf,u.S_,u.Zf,u.metadata,n.d_.v_))});return Zh(this.d_,o,s)},t.prototype.get=function(n){var r=this;return((n==null?void 0:n.source)==="cache"?function(i){i=z(i,Y);var o=z(i.firestore,Z),s=ut(o),u=new Ne(o);return function(a,c){var h=this,f=new Ct;return a._s.Ps(function(){return m(h,void 0,void 0,function(){var l;return g(this,function(p){switch(p.label){case 0:return l=function(d,v,w){return m(this,void 0,void 0,function(){var _,S;return g(this,function(A){switch(A.label){case 0:return A.trys.push([0,2,,3]),[4,function(C,M){var V=T(C);return V.persistence.runTransaction("read document","readonly",function(J){return V.Tc.Ho(J,M)})}(d,v)];case 1:return(S=A.sent())instanceof B?w.resolve(S):S instanceof rt?w.resolve(null):w.reject(new b(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return _=A.sent(),S=gn(_,"Failed to get document '"+v+" from cache"),w.reject(S),[3,3];case 3:return[2]}})})},[4,$h(a)];case 1:return[2,l.apply(void 0,[p.sent(),c,f])]}})})}),f.promise}(s,i.S_).then(function(a){return new Yt(o,u,i.S_,a,new _e(a instanceof B&&a.Vt,!0),i.v_)})}(this.d_):(n==null?void 0:n.source)==="server"?function(i){i=z(i,Y);var o=z(i.firestore,Z);return Xu(ut(o),i.S_,{source:"server"}).then(function(s){return go(o,i,s)})}(this.d_):function(i){i=z(i,Y);var o=z(i.firestore,Z);return Xu(ut(o),i.S_).then(function(s){return go(o,i,s)})}(this.d_)).then(function(i){return new Yn(r.firestore,new Yt(r.firestore.d_,r.Xf,i.S_,i.Zf,i.metadata,r.d_.v_))})},t.prototype.withConverter=function(n){return new t(this.firestore,this.d_.withConverter(Ai.gd(this.firestore,n)))},t}(U);function dt(e,t,n){return e.message=e.message.replace(t,n),e}function of(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(typeof r=="object"&&!pn(r))return r}return{}}function sf(e,t){var n,r,i;return{next:function(o){i.next&&i.next(t(o))},error:(n=(i=pn(e[0])?e[0]:pn(e[1])?e[1]:typeof e[0]=="function"?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Yn=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).Yf=n,i}return N(t,e),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ae(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(n){return this.d_.data(n)},t.prototype.get=function(n,r){return this.d_.get(n,r)},t.prototype.isEqual=function(n){return Jh(this.d_,n.d_)},t}(U),Kn=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.prototype.data=function(n){return this.d_.data(n)},t}(Yn),Si=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).firestore=n,i.Xf=new Ni(n),i}return N(t,e),t.prototype.where=function(n,r,i){try{return new t(this.firestore,Jt(this.d_,function(o,s,u){var a=s,c=Zr("where",o);return new Uv(c,a,u)}(n,r,i)))}catch(o){throw dt(o,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(n,r){try{return new t(this.firestore,Jt(this.d_,function(i,o){o===void 0&&(o="asc");var s=o,u=Zr("orderBy",i);return new jv(u,s)}(n,r)))}catch(i){throw dt(i,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(n){try{return new t(this.firestore,Jt(this.d_,function(r){return Hu("limit",r),new ta("limit",r,"F")}(n)))}catch(r){throw dt(r,"limit()","Query.limit()")}},t.prototype.limitToLast=function(n){try{return new t(this.firestore,Jt(this.d_,function(r){return Hu("limitToLast",r),new ta("limitToLast",r,"L")}(n)))}catch(r){throw dt(r,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return new t(this.firestore,Jt(this.d_,function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new ea("startAt",i,!0)}.apply(void 0,n)))}catch(i){throw dt(i,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return new t(this.firestore,Jt(this.d_,function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new ea("startAfter",i,!1)}.apply(void 0,n)))}catch(i){throw dt(i,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return new t(this.firestore,Jt(this.d_,function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new na("endBefore",i,!0)}.apply(void 0,n)))}catch(i){throw dt(i,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{return new t(this.firestore,Jt(this.d_,function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return new na("endAt",i,!1)}.apply(void 0,n)))}catch(i){throw dt(i,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(n){return Lh(this.d_,n.d_)},t.prototype.get=function(n){var r=this;return((n==null?void 0:n.source)==="cache"?function(i){i=z(i,xt);var o=z(i.firestore,Z),s=ut(o),u=new Ne(o);return function(a,c){var h=this,f=new Ct;return a._s.Ps(function(){return m(h,void 0,void 0,function(){var l;return g(this,function(p){switch(p.label){case 0:return l=function(d,v,w){return m(this,void 0,void 0,function(){var _,S,A,C,M;return g(this,function(V){switch(V.label){case 0:return V.trys.push([0,2,,3]),[4,Xr(d,v,!0)];case 1:return M=V.sent(),_=new Ah(v,M.Rc),S=_.fl(M.documents),A=_.wi(S,!1),w.resolve(A.snapshot),[3,3];case 2:return C=V.sent(),M=gn(C,"Failed to execute query '"+v+" against cache"),w.reject(M),[3,3];case 3:return[2]}})})},[4,$h(a)];case 1:return[2,l.apply(void 0,[p.sent(),c,f])]}})})}),f.promise}(s,i.C_).then(function(a){return new ne(o,u,i,a)})}(this.d_):(n==null?void 0:n.source)==="server"?function(i){i=z(i,xt);var o=z(i.firestore,Z),s=ut(o),u=new Ne(o);return Wu(s,i.C_,{source:"server"}).then(function(a){return new ne(o,u,i,a)})}(this.d_):function(i){i=z(i,xt);var o=z(i.firestore,Z),s=ut(o),u=new Ne(o);return Qh(i.C_),Wu(s,i.C_).then(function(a){return new ne(o,u,i,a)})}(this.d_)).then(function(i){return new mo(r.firestore,new ne(r.firestore.d_,r.Xf,r.d_,i._d))})},t.prototype.onSnapshot=function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=of(r),s=sf(r,function(u){return new mo(n.firestore,new ne(n.firestore.d_,n.Xf,n.d_,u._d))});return Zh(this.d_,o,s)},t.prototype.withConverter=function(n){return new t(this.firestore,this.d_.withConverter(Ai.gd(this.firestore,n)))},t}(U),Yv=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).Yf=n,i}return N(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Kn(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),t}(U),mo=function(e){function t(n,r){var i=this;return(i=e.call(this,r)||this).Yf=n,i}return N(t,e),Object.defineProperty(t.prototype,"query",{get:function(){return new Si(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var n=this;return this.d_.docs.map(function(r){return new Kn(n.Yf,r)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(n){var r=this;return this.d_.docChanges(n).map(function(i){return new Yv(r.Yf,i)})},t.prototype.forEach=function(n,r){var i=this;this.d_.forEach(function(o){n.call(r,new Kn(i.Yf,o))})},t.prototype.isEqual=function(n){return Jh(this.d_,n.d_)},t}(U),ti=function(e){function t(n,r){var i=this;return(i=e.call(this,n,r)||this).firestore=n,i.d_=r,i}return N(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var n=this.d_.parent;return n?new Ae(this.firestore,n):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(n){try{return new Ae(this.firestore,n===void 0?Sr(this.d_):Sr(this.d_,n))}catch(r){throw dt(r,"doc()","CollectionReference.doc()")}},t.prototype.add=function(n){var r=this;return function(i,o){var s=z(i.firestore,Z),u=Sr(i),a=Ti(i.v_,o);return $n(s,[_i(Fe(i.firestore),"addDoc",u.S_,a,i.v_!==null,{}).F_(u.S_,ct.exists(!1))]).then(function(){return u})}(this.d_,n).then(function(i){return new Ae(r.firestore,i)})},t.prototype.isEqual=function(n){return Rh(this.d_,n.d_)},t.prototype.withConverter=function(n){return new t(this.firestore,this.d_.withConverter(Ai.gd(this.firestore,n)))},t}(Si);function Ie(e){return e instanceof U&&(e=e.d_),z(e,Y)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kv=function(e){function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.call(this,new($t.bind.apply($t,at([void 0],n))))||this}return N(t,e),t.documentId=function(){return new t(Mt.ht().rt())},t.prototype.isEqual=function(n){return n instanceof U&&(n=n.d_),n instanceof $t&&this.d_.f_.isEqual(n.f_)},t}(U),Qv=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return N(t,e),t.serverTimestamp=function(){var n=new Dv("serverTimestamp");return n._methodName="FieldValue.serverTimestamp",new t(n)},t.delete=function(){var n=new xs("deleteField");return n._methodName="FieldValue.delete",new t(n)},t.arrayUnion=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new Ov("arrayUnion",o)}.apply(void 0,n);return i._methodName="FieldValue.arrayUnion",new t(i)},t.arrayRemove=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new xv("arrayRemove",o)}.apply(void 0,n);return i._methodName="FieldValue.arrayRemove",new t(i)},t.increment=function(n){var r=function(i){return new Pv("increment",i)}(n);return r._methodName="FieldValue.increment",new t(r)},t.prototype.isEqual=function(n){return this.d_.isEqual(n.d_)},t}(U),Xv={Firestore:ef,GeoPoint:Ei,Timestamp:Et,Blob:tf,Transaction:nf,WriteBatch:rf,DocumentReference:Ae,DocumentSnapshot:Yn,Query:Si,QueryDocumentSnapshot:Kn,QuerySnapshot:mo,CollectionReference:ti,FieldPath:Kv,FieldValue:Qv,setLogLevel:$v,CACHE_SIZE_UNLIMITED:Mv};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wv(e){(function(t,n){t.INTERNAL.registerComponent(new ei("firestore",function(r){var i=r.getProvider("app").getImmediate();return n(i,r.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Xv)))})(e,function(t,n){return new ef(t,new Z(t,n),new Hv)}),e.registerVersion("@firebase/firestore","2.1.7")}Wv(Xe);const Jv={apiKey:"AIzaSyDHPOwg8vFw7BCxI7Tfgw3XRGhCd1hEWCA",authDomain:"test-27d08.firebaseapp.com",projectId:"test-27d08",storageBucket:"test-27d08.appspot.com",messagingSenderId:"447987380659",appId:"1:447987380659:web:3252843d56a3b8911c9bc6"};Xe.apps.length||Xe.initializeApp(Jv);const uf=Xe.firestore(),Zv={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},St=new RTCPeerConnection(Zv);let Er=null,Bi=null;const aa=document.getElementById("webcamButton"),ty=document.getElementById("webcamVideo"),af=document.getElementById("callButton"),cf=document.getElementById("callInput"),hf=document.getElementById("answerButton"),ey=document.getElementById("remoteVideo"),ny=document.getElementById("hangupButton");aa.onclick=async()=>{Er=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0}),Bi=new MediaStream,Er.getTracks().forEach(e=>{St.addTrack(e,Er)}),St.ontrack=e=>{e.streams[0].getTracks().forEach(t=>{Bi.addTrack(t)})},ty.srcObject=Er,ey.srcObject=Bi,af.disabled=!1,hf.disabled=!1,aa.disabled=!0};af.onclick=async()=>{const e=uf.collection("calls").doc(),t=e.collection("offerCandidates"),n=e.collection("answerCandidates");cf.value=e.id,St.onicecandidate=o=>{o.candidate&&t.add(o.candidate.toJSON())};const r=await St.createOffer();await St.setLocalDescription(r);const i={sdp:r.sdp,type:r.type};await e.set({offer:i}),e.onSnapshot(o=>{const s=o.data();if(!St.currentRemoteDescription&&(s==null?void 0:s.answer)){const u=new RTCSessionDescription(s.answer);St.setRemoteDescription(u)}}),n.onSnapshot(o=>{o.docChanges().forEach(s=>{if(s.type==="added"){const u=new RTCIceCandidate(s.doc.data());St.addIceCandidate(u)}})}),ny.disabled=!1};hf.onclick=async()=>{const e=cf.value,t=uf.collection("calls").doc(e),n=t.collection("answerCandidates"),r=t.collection("offerCandidates");St.onicecandidate=a=>{a.candidate&&n.add(a.candidate.toJSON())};const o=(await t.get()).data().offer;await St.setRemoteDescription(new RTCSessionDescription(o));const s=await St.createAnswer();await St.setLocalDescription(s);const u={type:s.type,sdp:s.sdp};await t.update({answer:u}),r.onSnapshot(a=>{a.docChanges().forEach(c=>{if(console.log(c),c.type==="added"){let h=c.doc.data();St.addIceCandidate(new RTCIceCandidate(h))}})})};
